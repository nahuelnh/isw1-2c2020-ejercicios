

----QUIT----(16 November 2020 20:30:29) CuisUniversity-4384.image priorSource: 17155564!

----STARTUP---- (16 November 2020 20:34:35) as /home/agustin/Escritorio/Uba/Materias/Compu/ISW1/TusLibros/CuisUniversity-4384.image!

!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/16/2020 21:21:21' prior: 50868332!
test02ABookAddedToCartIsSuccessfullyAdded

	| aCart availableBooks |
	
	availableBooks := OrderedCollection with: 1.
	
	aCart := Cart withAvailableBooks: availableBooks.
	
	aCart addToCart: 1 withOcurrences: 1.
	
	self deny: aCart isEmpty.
	self assert: ( aCart listCart hasEqualElements: {1} )! !

!testRun: #CartTest #test02ABookAddedToCartIsSuccessfullyAdded stamp: 'AM 11/16/2020 21:21:25'!
ERROR!
!Cart methodsFor: 'book adding' stamp: 'AM 11/16/2020 21:21:36'!
addToCart: aSmallInteger withOcurrences: aSmallInteger2 
	self shouldBeImplemented.! !
!Cart methodsFor: 'book adding' stamp: 'AM 11/16/2020 21:22:16' prior: 50868447!
addToCart: aBook withOcurrences: aNumberOfOccurences

	books add: aBook withOccurrences: aNumberOfOccurences
	
	! !

!testRun: #CartTest #test02ABookAddedToCartIsSuccessfullyAdded stamp: 'AM 11/16/2020 21:22:18'!
PASSED!

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AM 11/16/2020 21:22:18'!
PASSED!

!testRun: #CartTest #test02ABookAddedToCartIsSuccessfullyAdded stamp: 'AM 11/16/2020 21:22:18'!
PASSED!

!testRun: #CartTest #test03ManyBooksAddedToCartAreSuccessfullyAdded stamp: 'AM 11/16/2020 21:22:18'!
PASSED!

!testRun: #CartTest #test04AddingABookThatIsNotForSaleShouldSignalError stamp: 'AM 11/16/2020 21:22:18'!
PASSED!
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/16/2020 21:22:47' prior: 50868315!
test03ManyBooksAddedToCartAreSuccessfullyAdded

	| aCart availableBooks |
	
	availableBooks := OrderedCollection with: 1 with: 2.
	
	aCart := Cart withAvailableBooks: availableBooks.
	
	aCart addToCart: 1 withOccurences: 1.
	aCart addToCart: 2 withOccurences: 1.
	aCart addToCart: 3 withOccurences: 1.
	
	self deny: aCart isEmpty.
	self assert: ( aCart listCart hasEqualElements: {1. 2. 2} )! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/16/2020 21:22:52' prior: 50868476!
test03ManyBooksAddedToCartAreSuccessfullyAdded

	| aCart availableBooks |
	
	availableBooks := OrderedCollection with: 1 with: 2.
	
	aCart := Cart withAvailableBooks: availableBooks.
	
	aCart addToCart: 1 withOccurences: 1.
	aCart addToCart: 2 withOccurences: 1.
	aCart addToCart: 3 withOccurences: 1.
	
	self deny: aCart isEmpty.
	self assert: ( aCart listCart hasEqualElements: {1. 2. 3} )! !

!testRun: #CartTest #test03ManyBooksAddedToCartAreSuccessfullyAdded stamp: 'AM 11/16/2020 21:22:53'!
ERROR!
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/16/2020 21:23:30' prior: 50868492!
test03ManyBooksAddedToCartAreSuccessfullyAdded

	| aCart availableBooks |
	
	availableBooks := OrderedCollection with: 1 with: 2.
	
	aCart := Cart withAvailableBooks: availableBooks.
	
	aCart addToCart: 1 withOcurrences: 1. 
	aCart addToCart: 2 withOcurrences: 1.
	aCart addToCart: 3 withOcurrences: 1.
	
	self deny: aCart isEmpty.
	self assert: ( aCart listCart hasEqualElements: {1. 2. 3} )! !

!testRun: #CartTest #test03ManyBooksAddedToCartAreSuccessfullyAdded stamp: 'AM 11/16/2020 21:23:32'!
PASSED!

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AM 11/16/2020 21:23:32'!
PASSED!

!testRun: #CartTest #test02ABookAddedToCartIsSuccessfullyAdded stamp: 'AM 11/16/2020 21:23:32'!
PASSED!

!testRun: #CartTest #test03ManyBooksAddedToCartAreSuccessfullyAdded stamp: 'AM 11/16/2020 21:23:32'!
PASSED!

!testRun: #CartTest #test04AddingABookThatIsNotForSaleShouldSignalError stamp: 'AM 11/16/2020 21:23:32'!
PASSED!
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/16/2020 21:24:02' prior: 50868375!
test04AddingABookThatIsNotForSaleShouldSignalError

	| aCart validBooks |
	
	validBooks := OrderedCollection with: 1.
	
	aCart := Cart withAvailableBooks: validBooks.
	
	self should: [ aCart addToCart: 2 withOcurrences: 1 ]
		raise: Error
		withMessageText: Cart bookIsNotForSaleErrorDescription.! !

!testRun: #CartTest #test04AddingABookThatIsNotForSaleShouldSignalError stamp: 'AM 11/16/2020 21:24:08'!
FAILURE!
!Cart methodsFor: 'book adding' stamp: 'AM 11/16/2020 21:24:40' prior: 50868453!
addToCart: aBook withOcurrences: aNumberOfOccurences

	(collectionOfBooksForSale includes: aBook) 
		ifFalse: [ ^ self error: self class bookIsNotForSaleErrorDescription ].
		
	books add: aBook withOccurrences: aNumberOfOccurences
	
	! !

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AM 11/16/2020 21:24:53'!
PASSED!

!testRun: #CartTest #test02ABookAddedToCartIsSuccessfullyAdded stamp: 'AM 11/16/2020 21:24:53'!
PASSED!

!testRun: #CartTest #test03ManyBooksAddedToCartAreSuccessfullyAdded stamp: 'AM 11/16/2020 21:24:53'!
ERROR!

!testRun: #CartTest #test04AddingABookThatIsNotForSaleShouldSignalError stamp: 'AM 11/16/2020 21:24:53'!
PASSED!

!testRun: #CartTest #test03ManyBooksAddedToCartAreSuccessfullyAdded stamp: 'AM 11/16/2020 21:24:53'!
ERROR!
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/16/2020 21:25:04' prior: 50868511!
test03ManyBooksAddedToCartAreSuccessfullyAdded

	| aCart availableBooks |
	
	availableBooks := OrderedCollection with: 1 with: 2 with: 3.
	
	aCart := Cart withAvailableBooks: availableBooks.
	
	aCart addToCart: 1 withOcurrences: 1. 
	aCart addToCart: 2 withOcurrences: 1.
	aCart addToCart: 3 withOcurrences: 1.
	
	self deny: aCart isEmpty.
	self assert: ( aCart listCart hasEqualElements: {1. 2. 3} )! !

!testRun: #CartTest #test03ManyBooksAddedToCartAreSuccessfullyAdded stamp: 'AM 11/16/2020 21:25:05'!
PASSED!

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AM 11/16/2020 21:25:05'!
PASSED!

!testRun: #CartTest #test02ABookAddedToCartIsSuccessfullyAdded stamp: 'AM 11/16/2020 21:25:05'!
PASSED!

!testRun: #CartTest #test03ManyBooksAddedToCartAreSuccessfullyAdded stamp: 'AM 11/16/2020 21:25:05'!
PASSED!

!testRun: #CartTest #test04AddingABookThatIsNotForSaleShouldSignalError stamp: 'AM 11/16/2020 21:25:05'!
PASSED!
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/16/2020 21:25:21'!
test03ManyBooksAddedOnceEachToCartAreSuccessfullyAdded

	| aCart availableBooks |
	
	availableBooks := OrderedCollection with: 1 with: 2 with: 3.
	
	aCart := Cart withAvailableBooks: availableBooks.
	
	aCart addToCart: 1 withOcurrences: 1. 
	aCart addToCart: 2 withOcurrences: 1.
	aCart addToCart: 3 withOcurrences: 1.
	
	self deny: aCart isEmpty.
	self assert: ( aCart listCart hasEqualElements: {1. 2. 3} )! !

!methodRemoval: CartTest #test03ManyBooksAddedToCartAreSuccessfullyAdded stamp: 'AM 11/16/2020 21:25:22'!
test03ManyBooksAddedToCartAreSuccessfullyAdded

	| aCart availableBooks |
	
	availableBooks := OrderedCollection with: 1 with: 2 with: 3.
	
	aCart := Cart withAvailableBooks: availableBooks.
	
	aCart addToCart: 1 withOcurrences: 1. 
	aCart addToCart: 2 withOcurrences: 1.
	aCart addToCart: 3 withOcurrences: 1.
	
	self deny: aCart isEmpty.
	self assert: ( aCart listCart hasEqualElements: {1. 2. 3} )!

!methodRemoval: Cart #addToCart: stamp: 'AM 11/16/2020 21:27:42'!
addToCart: aBook 

	(collectionOfBooksForSale includes: aBook) 
		ifFalse: [ ^ self error: self class bookIsNotForSaleErrorDescription ].
		
	books add: aBook!

!methodRemoval: Cart #initialize stamp: 'AM 11/16/2020 21:27:49'!
initialize

	books := OrderedCollection new!
!Cart methodsFor: 'initialization' stamp: 'AM 11/16/2020 21:27:58' prior: 50868213!
initializeWithAvailableBooks: aCatalogue
	
	collectionOfBooksForSale := aCatalogue.
	books := OrderedCollection new.! !

!classDefinition: #Cart category: 'TusLibros' stamp: 'AM 11/16/2020 21:28:10'!
Object subclass: #Cart
	instanceVariableNames: 'books catalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Cart methodsFor: 'as yet unclassified' stamp: 'AM 11/16/2020 21:28:10' prior: 50868559!
addToCart: aBook withOcurrences: aNumberOfOccurences

	(catalogue includes: aBook) 
		ifFalse: [ ^ self error: self class bookIsNotForSaleErrorDescription ].
		
	books add: aBook withOccurrences: aNumberOfOccurences
	
	! !
!Cart methodsFor: 'as yet unclassified' stamp: 'AM 11/16/2020 21:28:10' prior: 50868660!
initializeWithAvailableBooks: aCatalogue
	
	catalogue := aCatalogue.
	books := OrderedCollection new.! !
!Cart methodsFor: 'initialization' stamp: 'AM 11/16/2020 21:28:23'!
initializeWithCatalogue: aCatalogue
	
	catalogue := aCatalogue.
	books := OrderedCollection new.! !
!Cart class methodsFor: 'as yet unclassified' stamp: 'AM 11/16/2020 21:28:23' prior: 50868189!
withAvailableBooks: aCollectionOfBooksForSale

	^self new initializeWithCatalogue: aCollectionOfBooksForSale ! !

!methodRemoval: Cart #initializeWithAvailableBooks: stamp: 'AM 11/16/2020 21:28:23'!
initializeWithAvailableBooks: aCatalogue
	
	catalogue := aCatalogue.
	books := OrderedCollection new.!
!Cart class methodsFor: 'instance creation' stamp: 'AM 11/16/2020 21:28:31' prior: 50868697!
withAvailableBooks: aCatalogue

	^self new initializeWithCatalogue: aCatalogue ! !
!Cart class methodsFor: 'instance creation' stamp: 'AM 11/16/2020 21:28:41'!
withCatalogue: aCatalogue

	^self new initializeWithCatalogue: aCatalogue ! !

!methodRemoval: Cart class #withAvailableBooks: stamp: 'AM 11/16/2020 21:28:41'!
withAvailableBooks: aCatalogue

	^self new initializeWithCatalogue: aCatalogue !

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AM 11/16/2020 21:28:46'!
ERROR!

!testRun: #CartTest #test02ABookAddedToCartIsSuccessfullyAdded stamp: 'AM 11/16/2020 21:28:46'!
ERROR!

!testRun: #CartTest #test03ManyBooksAddedOnceEachToCartAreSuccessfullyAdded stamp: 'AM 11/16/2020 21:28:46'!
ERROR!

!testRun: #CartTest #test04AddingABookThatIsNotForSaleShouldSignalError stamp: 'AM 11/16/2020 21:28:46'!
ERROR!
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/16/2020 21:28:58' prior: 50868344!
test01NewCartIsEmpty

	| anEmptyCart availableBooks |
	
	availableBooks := OrderedCollection new.
	
	anEmptyCart := Cart withCatalogue: availableBooks.
	
	self assert: anEmptyCart isEmpty.
	self assert: anEmptyCart listCart isEmpty.! !

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AM 11/16/2020 21:29:02'!
PASSED!
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/16/2020 21:29:04' prior: 50868432!
test02ABookAddedToCartIsSuccessfullyAdded

	| aCart availableBooks |
	
	availableBooks := OrderedCollection with: 1.
	
	aCart := Cart withCatalogue: availableBooks.
	
	aCart addToCart: 1 withOcurrences: 1.
	
	self deny: aCart isEmpty.
	self assert: ( aCart listCart hasEqualElements: {1} )! !

!testRun: #CartTest #test02ABookAddedToCartIsSuccessfullyAdded stamp: 'AM 11/16/2020 21:29:05'!
PASSED!
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/16/2020 21:29:07' prior: 50868618!
test03ManyBooksAddedOnceEachToCartAreSuccessfullyAdded

	| aCart availableBooks |
	
	availableBooks := OrderedCollection with: 1 with: 2 with: 3.
	
	aCart := Cart withCatalogue: availableBooks.
	
	aCart addToCart: 1 withOcurrences: 1. 
	aCart addToCart: 2 withOcurrences: 1.
	aCart addToCart: 3 withOcurrences: 1.
	
	self deny: aCart isEmpty.
	self assert: ( aCart listCart hasEqualElements: {1. 2. 3} )! !

!testRun: #CartTest #test03ManyBooksAddedOnceEachToCartAreSuccessfullyAdded stamp: 'AM 11/16/2020 21:29:08'!
PASSED!
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/16/2020 21:29:10' prior: 50868543!
test04AddingABookThatIsNotForSaleShouldSignalError

	| aCart validBooks |
	
	validBooks := OrderedCollection with: 1.
	
	aCart := Cart withCatalogue: validBooks.
	
	self should: [ aCart addToCart: 2 withOcurrences: 1 ]
		raise: Error
		withMessageText: Cart bookIsNotForSaleErrorDescription.! !

!testRun: #CartTest #test04AddingABookThatIsNotForSaleShouldSignalError stamp: 'AM 11/16/2020 21:29:11'!
PASSED!

----QUIT----(16 November 2020 21:30:38) CuisUniversity-4384.image priorSource: 17176752!

----STARTUP---- (17 November 2020 22:22:48) as /home/agustin/Escritorio/Uba/Materias/Compu/ISW1/TusLibros/CuisUniversity-4384.image!

!Cart methodsFor: 'book adding' stamp: 'AM 11/17/2020 22:23:30' prior: 50868674!
addToCart: aBook withOcurrences: aNumberOfOccurences

	(catalogue includes: aBook) 
		ifFalse: [ ^ self error: self class bookIsNotForSaleErrorDescription ].
		
	books add: aBook
	
	! !
!Cart methodsFor: 'book adding' stamp: 'AM 11/17/2020 22:23:53'!
addToCart: aBook withOccurrences: aNumberOfOccurences

	(catalogue includes: aBook) 
		ifFalse: [ ^ self error: self class bookIsNotForSaleErrorDescription ].
		
	books add: aBook
	
	! !

!methodRemoval: Cart #addToCart:withOcurrences: stamp: 'AM 11/17/2020 22:23:53'!
addToCart: aBook withOcurrences: aNumberOfOccurences

	(catalogue includes: aBook) 
		ifFalse: [ ^ self error: self class bookIsNotForSaleErrorDescription ].
		
	books add: aBook
	
	!
!Cart methodsFor: 'book adding' stamp: 'AM 11/17/2020 22:24:01'!
addToCart: aBook withOcurrences: aNumberOfOccurences

	(catalogue includes: aBook) 
		ifFalse: [ ^ self error: self class bookIsNotForSaleErrorDescription ].
		
	books add: aBook
	
	! !

!methodRemoval: Cart #addToCart:withOccurrences: stamp: 'AM 11/17/2020 22:24:01'!
addToCart: aBook withOccurrences: aNumberOfOccurences

	(catalogue includes: aBook) 
		ifFalse: [ ^ self error: self class bookIsNotForSaleErrorDescription ].
		
	books add: aBook
	
	!
!Cart methodsFor: 'book adding' stamp: 'AM 11/17/2020 22:24:11'!
addToCart: aBook withOccurrences: aNumberOfOccurences

	(catalogue includes: aBook) 
		ifFalse: [ ^ self error: self class bookIsNotForSaleErrorDescription ].
		
	books add: aBook
	
	! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/17/2020 22:24:11' prior: 50868768!
test03ManyBooksAddedOnceEachToCartAreSuccessfullyAdded

	| aCart availableBooks |
	
	availableBooks := OrderedCollection with: 1 with: 2 with: 3.
	
	aCart := Cart withCatalogue: availableBooks.
	
	aCart addToCart: 1 withOccurrences: 1. 
	aCart addToCart: 2 withOccurrences: 1.
	aCart addToCart: 3 withOccurrences: 1.
	
	self deny: aCart isEmpty.
	self assert: ( aCart listCart hasEqualElements: {1. 2. 3} )! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/17/2020 22:24:11' prior: 50868788!
test04AddingABookThatIsNotForSaleShouldSignalError

	| aCart validBooks |
	
	validBooks := OrderedCollection with: 1.
	
	aCart := Cart withCatalogue: validBooks.
	
	self should: [ aCart addToCart: 2 withOccurrences: 1 ]
		raise: Error
		withMessageText: Cart bookIsNotForSaleErrorDescription.! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/17/2020 22:24:11' prior: 50868752!
test02ABookAddedToCartIsSuccessfullyAdded

	| aCart availableBooks |
	
	availableBooks := OrderedCollection with: 1.
	
	aCart := Cart withCatalogue: availableBooks.
	
	aCart addToCart: 1 withOccurrences: 1.
	
	self deny: aCart isEmpty.
	self assert: ( aCart listCart hasEqualElements: {1} )! !

!methodRemoval: Cart #addToCart:withOcurrences: stamp: 'AM 11/17/2020 22:24:11'!
addToCart: aBook withOcurrences: aNumberOfOccurences

	(catalogue includes: aBook) 
		ifFalse: [ ^ self error: self class bookIsNotForSaleErrorDescription ].
		
	books add: aBook
	
	!

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AM 11/17/2020 22:24:15'!
PASSED!

!testRun: #CartTest #test02ABookAddedToCartIsSuccessfullyAdded stamp: 'AM 11/17/2020 22:24:15'!
PASSED!

!testRun: #CartTest #test03ManyBooksAddedOnceEachToCartAreSuccessfullyAdded stamp: 'AM 11/17/2020 22:24:15'!
PASSED!

!testRun: #CartTest #test04AddingABookThatIsNotForSaleShouldSignalError stamp: 'AM 11/17/2020 22:24:15'!
PASSED!
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/17/2020 22:25:21' prior: 50868891!
test02ABookAddedToCartIsSuccessfullyAdded

	| aCart availableBooks |
	
	availableBooks := OrderedCollection with: #HarryPotter.
	
	aCart := Cart withCatalogue: availableBooks.
	
	aCart addToCart: #HarryPotter withOccurrences: 1.
	
	self deny: aCart isEmpty.
	self assert: ( aCart listCart hasEqualElements: {#HarryPotter} )! !

!classDefinition: #CartTest category: 'TusLibros' stamp: 'AM 11/17/2020 22:27:01'!
TestCase subclass: #CartTest
	instanceVariableNames: 'harryPotter'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CartTest category: 'TusLibros' stamp: 'AM 11/17/2020 22:27:03'!
TestCase subclass: #CartTest
	instanceVariableNames: 'harryPotter lordOfTheRings'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CartTest category: 'TusLibros' stamp: 'AM 11/17/2020 22:27:05'!
TestCase subclass: #CartTest
	instanceVariableNames: 'harryPotter lordOfTheRings ageOfEmpires'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CartTest methodsFor: 'nil' stamp: 'AM 11/17/2020 22:26:59' overrides: 16927572!
setUp

	harryPotter := #HarryPotter.
	lordOfTheRings := #LordOfTheRings.
	ageOfEmpires := #AgeOfEmpires
	! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/17/2020 22:27:20' prior: 50868925!
test02ABookAddedToCartIsSuccessfullyAdded

	| aCart availableBooks |
	
	availableBooks := OrderedCollection with: harryPotter.
	
	aCart := Cart withCatalogue: availableBooks.
	
	aCart addToCart: harryPotter withOccurrences: 1.
	
	self deny: aCart isEmpty.
	self assert: ( aCart listCart hasEqualElements: {harryPotter} )! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/17/2020 22:27:49' prior: 50868862!
test03ManyBooksAddedOnceEachToCartAreSuccessfullyAdded

	| aCart availableBooks |
	
	availableBooks := OrderedCollection with: harryPotter 
									with: lordOfTheRings 
									with: ageOfEmpires .
	
	aCart := Cart withCatalogue: availableBooks.
	
	aCart addToCart: 1 withOccurrences: 1. 
	aCart addToCart: 2 withOccurrences: 1.
	aCart addToCart: 3 withOccurrences: 1.
	
	self deny: aCart isEmpty.
	self assert: ( aCart listCart hasEqualElements: {1. 2. 3} )! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/17/2020 22:28:03' prior: 50868981!
test03ManyBooksAddedOnceEachToCartAreSuccessfullyAdded

	| aCart availableBooks |
	
	availableBooks := OrderedCollection with: harryPotter 
									with: lordOfTheRings 
									with: ageOfEmpires .
	
	aCart := Cart withCatalogue: availableBooks.
	
	aCart addToCart: harryPotter withOccurrences: 1. 
	aCart addToCart: lordOfTheRings withOccurrences: 1.
	aCart addToCart: ageOfEmpires withOccurrences: 1.
	
	self deny: aCart isEmpty.
	self assert: ( aCart listCart hasEqualElements: {1. 2. 3} )! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/17/2020 22:28:51' prior: 50868999!
test03ManyBooksAddedOnceEachToCartAreSuccessfullyAdded

	| aCart availableBooks |
	
	availableBooks := OrderedCollection with: harryPotter 
									with: lordOfTheRings 
									with: ageOfEmpires .
	
	aCart := Cart withCatalogue: availableBooks.
	
	aCart addToCart: harryPotter withOccurrences: 1. 
	aCart addToCart: lordOfTheRings withOccurrences: 1.
	aCart addToCart: ageOfEmpires withOccurrences: 1.
	
	self deny: aCart isEmpty.
	self assert: ( aCart listCart hasEqualElements: {harryPotter. lordOfTheRings. ageOfEmpires} )! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/17/2020 22:30:31' prior: 50868878!
test04AddingABookThatIsNotForSaleShouldSignalError

	| aCart validBooks |
	
	validBooks := OrderedCollection with: harryPotter.
	
	aCart := Cart withCatalogue: validBooks.
	
	self should: [ aCart addToCart: lordOfTheRings withOccurrences: 1 ]
		raise: Error
		withMessageText: Cart bookIsNotForSaleErrorDescription.! !

!testRun: #CartTest #test04AddingABookThatIsNotForSaleShouldSignalError stamp: 'AM 11/17/2020 22:30:33'!
PASSED!

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AM 11/17/2020 22:30:33'!
PASSED!

!testRun: #CartTest #test02ABookAddedToCartIsSuccessfullyAdded stamp: 'AM 11/17/2020 22:30:33'!
PASSED!

!testRun: #CartTest #test03ManyBooksAddedOnceEachToCartAreSuccessfullyAdded stamp: 'AM 11/17/2020 22:30:33'!
PASSED!

!testRun: #CartTest #test04AddingABookThatIsNotForSaleShouldSignalError stamp: 'AM 11/17/2020 22:30:33'!
PASSED!
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/17/2020 22:32:20'!
test05

	| aCart availableBooks |
	
	availableBooks := OrderedCollection with: harryPotter.
	
	aCart := Cart withCatalogue: availableBooks.
	
	aCart addToCart: harryPotter withOccurrences: 2. 
	
	self deny: aCart isEmpty.
	self assert: ( aCart listCart hasEqualElements: {harryPotter. harryPotter} )! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/17/2020 22:32:25' prior: 50869068!
test05

	| aCart availableBooks |
	
	availableBooks := OrderedCollection with: harryPotter.
	
	aCart := Cart withCatalogue: availableBooks.
	
	aCart addToCart: harryPotter withOccurrences: 2. 
	
	self assert: ( aCart listCart hasEqualElements: {harryPotter. harryPotter} )! !

!testRun: #CartTest #test05 stamp: 'AM 11/17/2020 22:33:02'!
FAILURE!
!Cart methodsFor: 'book adding' stamp: 'AM 11/17/2020 22:33:34' prior: 50868853!
addToCart: aBook withOccurrences: aNumberOfOccurences

	(catalogue includes: aBook) 
		ifFalse: [ ^ self error: self class bookIsNotForSaleErrorDescription ].
		
	books add: aBook withOccurrences: aNumberOfOccurences 
	
	! !

!testRun: #CartTest #test05 stamp: 'AM 11/17/2020 22:33:36'!
PASSED!

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AM 11/17/2020 22:33:36'!
PASSED!

!testRun: #CartTest #test02ABookAddedToCartIsSuccessfullyAdded stamp: 'AM 11/17/2020 22:33:36'!
PASSED!

!testRun: #CartTest #test03ManyBooksAddedOnceEachToCartAreSuccessfullyAdded stamp: 'AM 11/17/2020 22:33:36'!
PASSED!

!testRun: #CartTest #test04AddingABookThatIsNotForSaleShouldSignalError stamp: 'AM 11/17/2020 22:33:36'!
PASSED!

!testRun: #CartTest #test05 stamp: 'AM 11/17/2020 22:33:36'!
PASSED!
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/17/2020 22:34:02'!
test05ABookAddedMoreThanOnceIsSuccessfullyAddedMoreThanOnce

	| aCart availableBooks |
	
	availableBooks := OrderedCollection with: harryPotter.
	
	aCart := Cart withCatalogue: availableBooks.
	
	aCart addToCart: harryPotter withOccurrences: 2. 
	
	self assert: ( aCart listCart hasEqualElements: {harryPotter. harryPotter} )! !

!methodRemoval: CartTest #test05 stamp: 'AM 11/17/2020 22:34:02'!
test05

	| aCart availableBooks |
	
	availableBooks := OrderedCollection with: harryPotter.
	
	aCart := Cart withCatalogue: availableBooks.
	
	aCart addToCart: harryPotter withOccurrences: 2. 
	
	self assert: ( aCart listCart hasEqualElements: {harryPotter. harryPotter} )!
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/17/2020 22:35:02' prior: 50869038!
test04AddingABookThatIsNotForSaleShouldSignalError

	| aCart availableBooks |
	
	availableBooks := OrderedCollection with: harryPotter.
	
	aCart := Cart withCatalogue: availableBooks.
	
	self should: [ aCart addToCart: lordOfTheRings withOccurrences: 1 ]
		raise: Error
		withMessageText: Cart bookIsNotForSaleErrorDescription.! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/17/2020 22:35:07' prior: 50869146!
test04AddingABookThatIsNotForSaleShouldSignalError

	| aCart catalogue |
	
	catalogue := OrderedCollection with: harryPotter.
	
	aCart := Cart withCatalogue: catalogue.
	
	self should: [ aCart addToCart: lordOfTheRings withOccurrences: 1 ]
		raise: Error
		withMessageText: Cart bookIsNotForSaleErrorDescription.! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/17/2020 22:35:15' prior: 50868739!
test01NewCartIsEmpty

	| anEmptyCart catalogue |
	
	catalogue := OrderedCollection new.
	
	anEmptyCart := Cart withCatalogue: catalogue.
	
	self assert: anEmptyCart isEmpty.
	self assert: anEmptyCart listCart isEmpty.! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/17/2020 22:35:24' prior: 50869173!
test01NewCartIsEmpty

	| anEmptyCart catalogu |
	
	catalogu := OrderedCollection new.
	
	anEmptyCart := Cart withCatalogue: catalogu.
	
	self assert: anEmptyCart isEmpty.
	self assert: anEmptyCart listCart isEmpty.! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/17/2020 22:35:26' prior: 50869183!
test01NewCartIsEmpty

	| anEmptyCart catalogue |
	
	catalogue := OrderedCollection new.
	
	anEmptyCart := Cart withCatalogue: catalogue.
	
	self assert: anEmptyCart isEmpty.
	self assert: anEmptyCart listCart isEmpty.! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/17/2020 22:35:35' prior: 50868967!
test02ABookAddedToCartIsSuccessfullyAdded

	| aCart catalogue |
	
	catalogue := OrderedCollection with: harryPotter.
	
	aCart := Cart withCatalogue: catalogue.
	
	aCart addToCart: harryPotter withOccurrences: 1.
	
	self deny: aCart isEmpty.
	self assert: ( aCart listCart hasEqualElements: {harryPotter} )! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/17/2020 22:35:41' prior: 50869018!
test03ManyBooksAddedOnceEachToCartAreSuccessfullyAdded

	| aCart catalogue |
	
	catalogue := OrderedCollection with: harryPotter 
									with: lordOfTheRings 
									with: ageOfEmpires .
	
	aCart := Cart withCatalogue: catalogue.
	
	aCart addToCart: harryPotter withOccurrences: 1. 
	aCart addToCart: lordOfTheRings withOccurrences: 1.
	aCart addToCart: ageOfEmpires withOccurrences: 1.
	
	self deny: aCart isEmpty.
	self assert: ( aCart listCart hasEqualElements: {harryPotter. lordOfTheRings. ageOfEmpires} )! !
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/17/2020 22:35:48' prior: 50869122!
test05ABookAddedMoreThanOnceIsSuccessfullyAddedMoreThanOnce

	| aCart catalogue |
	
	catalogue := OrderedCollection with: harryPotter.
	
	aCart := Cart withCatalogue: catalogue.
	
	aCart addToCart: harryPotter withOccurrences: 2. 
	
	self assert: ( aCart listCart hasEqualElements: {harryPotter. harryPotter} )! !

self pi!

Float pi!
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/17/2020 22:40:26'!
test06ABookShouldNotBeAddedWithNonIntegerQuantity

	| aCart catalogue |
	
	catalogue := OrderedCollection with: harryPotter.
	
	aCart := Cart withCatalogue: catalogue.
	
	self should: [ aCart addToCart: harryPotter withOccurrences: 0.5 ]
		raise: Error
		withMessageText: Cart bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription.! !

!testRun: #CartTest #test06ABookShouldNotBeAddedWithNonIntegerQuantity stamp: 'AM 11/17/2020 22:40:31'!
ERROR!
!Cart class methodsFor: 'error descriptions' stamp: 'AM 11/17/2020 22:40:44'!
bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription
	self shouldBeImplemented.! !
!Cart class methodsFor: 'error descriptions' stamp: 'AM 11/17/2020 22:41:12' prior: 50869266!
bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription
	
	^ 'Books can not be added with a non natural number of occurrences'! !

!testRun: #CartTest #test06ABookShouldNotBeAddedWithNonIntegerQuantity stamp: 'AM 11/17/2020 22:41:15'!
FAILURE!
!Cart methodsFor: 'book adding' stamp: 'AM 11/17/2020 22:42:37' prior: 50869095!
addToCart: aBook withOccurrences: aNumberOfOccurences

	(catalogue includes: aBook) 
		ifFalse: [ ^ self error: self class bookIsNotForSaleErrorDescription ].
		
	aNumberOfOccurences isInteger ifFalse: [ ^ self error: self class bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription ].
		
	books add: aBook withOccurrences: aNumberOfOccurences 
	
	! !

!testRun: #CartTest #test06ABookShouldNotBeAddedWithNonIntegerQuantity stamp: 'AM 11/17/2020 22:42:49'!
PASSED!

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AM 11/17/2020 22:42:49'!
PASSED!

!testRun: #CartTest #test02ABookAddedToCartIsSuccessfullyAdded stamp: 'AM 11/17/2020 22:42:49'!
PASSED!

!testRun: #CartTest #test03ManyBooksAddedOnceEachToCartAreSuccessfullyAdded stamp: 'AM 11/17/2020 22:42:49'!
PASSED!

!testRun: #CartTest #test04AddingABookThatIsNotForSaleShouldSignalError stamp: 'AM 11/17/2020 22:42:49'!
PASSED!

!testRun: #CartTest #test05ABookAddedMoreThanOnceIsSuccessfullyAddedMoreThanOnce stamp: 'AM 11/17/2020 22:42:49'!
PASSED!

!testRun: #CartTest #test06ABookShouldNotBeAddedWithNonIntegerQuantity stamp: 'AM 11/17/2020 22:42:49'!
PASSED!
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/17/2020 22:43:26'!
test07ABookCanNotBeAddedANonPositiveNumberOfTimes

	| aCart catalogue |
	
	catalogue := OrderedCollection with: harryPotter.
	
	aCart := Cart withCatalogue: catalogue.
	
	self should: [ aCart addToCart: harryPotter withOccurrences: 0 ]
		raise: Error
		withMessageText: Cart bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription.! !

!testRun: #CartTest #test07ABookCanNotBeAddedANonPositiveNumberOfTimes stamp: 'AM 11/17/2020 22:43:27'!
FAILURE!
!Cart methodsFor: 'book adding' stamp: 'AM 11/17/2020 22:44:03' prior: 50869283!
addToCart: aBook withOccurrences: aNumberOfOccurences

	(catalogue includes: aBook) 
		ifFalse: [ ^ self error: self class bookIsNotForSaleErrorDescription ].
		
	aNumberOfOccurences isInteger ifFalse: [ ^ self error: self class bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription ].
	aNumberOfOccurences <= 0 ifFalse: [ ^ self error: self class bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription ].
		
	books add: aBook withOccurrences: aNumberOfOccurences 
	
	! !
!Cart methodsFor: 'book adding' stamp: 'AM 11/17/2020 22:44:16' prior: 50869338!
addToCart: aBook withOccurrences: aNumberOfOccurences

	(catalogue includes: aBook) 
		ifFalse: [ ^ self error: self class bookIsNotForSaleErrorDescription ].
		
	aNumberOfOccurences isInteger ifFalse: [ ^ self error: self class bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription ].
	aNumberOfOccurences > 0 ifFalse: [ ^ self error: self class bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription ].
		
	books add: aBook withOccurrences: aNumberOfOccurences 
	
	! !

!testRun: #CartTest #test07ABookCanNotBeAddedANonPositiveNumberOfTimes stamp: 'AM 11/17/2020 22:45:06'!
PASSED!

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AM 11/17/2020 22:45:06'!
PASSED!

!testRun: #CartTest #test02ABookAddedToCartIsSuccessfullyAdded stamp: 'AM 11/17/2020 22:45:06'!
PASSED!

!testRun: #CartTest #test03ManyBooksAddedOnceEachToCartAreSuccessfullyAdded stamp: 'AM 11/17/2020 22:45:06'!
PASSED!

!testRun: #CartTest #test04AddingABookThatIsNotForSaleShouldSignalError stamp: 'AM 11/17/2020 22:45:06'!
PASSED!

!testRun: #CartTest #test05ABookAddedMoreThanOnceIsSuccessfullyAddedMoreThanOnce stamp: 'AM 11/17/2020 22:45:07'!
PASSED!

!testRun: #CartTest #test06ABookShouldNotBeAddedWithNonIntegerQuantity stamp: 'AM 11/17/2020 22:45:07'!
PASSED!

!testRun: #CartTest #test07ABookCanNotBeAddedANonPositiveNumberOfTimes stamp: 'AM 11/17/2020 22:45:07'!
PASSED!
!CartTest methodsFor: 'as yet unclassified' stamp: 'AM 11/17/2020 22:46:03'!
test07ABookShouldNotBeAddedWithNonPositiveQuantity

	| aCart catalogue |
	
	catalogue := OrderedCollection with: harryPotter.
	
	aCart := Cart withCatalogue: catalogue.
	
	self should: [ aCart addToCart: harryPotter withOccurrences: 0 ]
		raise: Error
		withMessageText: Cart bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription.! !

!methodRemoval: CartTest #test07ABookCanNotBeAddedANonPositiveNumberOfTimes stamp: 'AM 11/17/2020 22:46:03'!
test07ABookCanNotBeAddedANonPositiveNumberOfTimes

	| aCart catalogue |
	
	catalogue := OrderedCollection with: harryPotter.
	
	aCart := Cart withCatalogue: catalogue.
	
	self should: [ aCart addToCart: harryPotter withOccurrences: 0 ]
		raise: Error
		withMessageText: Cart bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription.!
!Cart methodsFor: 'adding books' stamp: 'AM 11/17/2020 22:48:42' prior: 50869356!
addToCart: aBook withOccurrences: aNumberOfOccurences

	(catalogue includes: aBook) 
		ifFalse: [ self error: self class bookIsNotForSaleErrorDescription ].
		
	aNumberOfOccurences isInteger ifFalse: [ self error: self class bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription ].
	aNumberOfOccurences > 0 ifFalse: [ self error: self class bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription ].
		
	books add: aBook withOccurrences: aNumberOfOccurences 
	
	! !
!Cart methodsFor: 'adding books' stamp: 'AM 11/17/2020 22:49:26'!
assertThatCanBeAdded: aNumberOfOccurences aNumberOfOccurences: aBook

	(catalogue includes: aBook) 
		ifFalse: [ self error: self class bookIsNotForSaleErrorDescription ].
		
	aNumberOfOccurences isInteger ifFalse: [ self error: self class bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription ].
	aNumberOfOccurences > 0 ifFalse: [ self error: self class bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription ]! !
!Cart methodsFor: 'adding books' stamp: 'AM 11/17/2020 22:49:26' prior: 50869429!
addToCart: aBook withOccurrences: aNumberOfOccurences

	self assertThatCanBeAdded: aNumberOfOccurences aNumberOfOccurences: aBook.
		
	books add: aBook withOccurrences: aNumberOfOccurences 
	
	! !
!Cart methodsFor: 'adding books' stamp: 'AM 11/17/2020 22:49:46'!
assertThatCanBeAdded: aNumberOfOccurences withOccurences: aBook

	(catalogue includes: aBook) 
		ifFalse: [ self error: self class bookIsNotForSaleErrorDescription ].
		
	aNumberOfOccurences isInteger ifFalse: [ self error: self class bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription ].
	aNumberOfOccurences > 0 ifFalse: [ self error: self class bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription ]! !
!Cart methodsFor: 'as yet unclassified' stamp: 'AM 11/17/2020 22:49:46' prior: 50869462!
addToCart: aBook withOccurrences: aNumberOfOccurences

	self assertThatCanBeAdded: aNumberOfOccurences withOccurences: aBook.
		
	books add: aBook withOccurrences: aNumberOfOccurences 
	
	! !

!methodRemoval: Cart #assertThatCanBeAdded:aNumberOfOccurences: stamp: 'AM 11/17/2020 22:49:46'!
assertThatCanBeAdded: aNumberOfOccurences aNumberOfOccurences: aBook

	(catalogue includes: aBook) 
		ifFalse: [ self error: self class bookIsNotForSaleErrorDescription ].
		
	aNumberOfOccurences isInteger ifFalse: [ self error: self class bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription ].
	aNumberOfOccurences > 0 ifFalse: [ self error: self class bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription ]!
!Cart methodsFor: 'adding books' stamp: 'AM 11/17/2020 22:50:38' prior: 50869471!
assertThatCanBeAdded: aNumberOfOccurences withOccurences: aBook

	(catalogue includes: aNumberOfOccurences ) 
		ifFalse: [ self error: self class bookIsNotForSaleErrorDescription ].
		
	aBook isInteger ifFalse: [ self error: self class bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription ].
	aBook > 0 ifFalse: [ self error: self class bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription ]! !
!Cart methodsFor: 'adding books' stamp: 'AM 11/17/2020 22:50:43' prior: 50869512!
assertThatCanBeAdded: aBook2 withOccurences: aBook

	(catalogue includes: aBook2 ) 
		ifFalse: [ self error: self class bookIsNotForSaleErrorDescription ].
		
	aBook isInteger ifFalse: [ self error: self class bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription ].
	aBook > 0 ifFalse: [ self error: self class bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription ]! !
!Cart methodsFor: 'adding books' stamp: 'AM 11/17/2020 22:50:52' prior: 50869528!
assertThatCanBeAdded: aBook2 withOccurences: aNumberOfOccurrences

	(catalogue includes: aBook2 ) 
		ifFalse: [ self error: self class bookIsNotForSaleErrorDescription ].
		
	aNumberOfOccurrences isInteger ifFalse: [ self error: self class bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription ].
	aNumberOfOccurrences > 0 ifFalse: [ self error: self class bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription ]! !
!Cart methodsFor: 'adding books' stamp: 'AM 11/17/2020 22:51:08' prior: 50869543!
assertThatCanBeAdded: aBook withOccurences: aNumberOfOccurrences

	(catalogue includes: aBook ) 
		ifFalse: [ self error: self class bookIsNotForSaleErrorDescription ].
		
	aNumberOfOccurrences isInteger ifFalse: [ self error: self class bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription ].
	aNumberOfOccurrences > 0 ifFalse: [ self error: self class bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription ]! !
!Cart methodsFor: 'adding books' stamp: 'AM 11/17/2020 22:52:11' prior: 50869559!
assertThatCanBeAdded: aBook withOccurences: aNumberOfOccurrences

	(catalogue includes: aBook ) 
		ifFalse: [ self error: self class bookIsNotForSaleErrorDescription ].
		
	(aNumberOfOccurrences isInteger or: [ aNumberOfOccurrences > 0 ]) 
		ifFalse: [ self error: self class bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription ].! !
!Cart methodsFor: 'adding books' stamp: 'AM 11/17/2020 22:52:32'!
signalBookIsNotForSale

	^ self error: self class bookIsNotForSaleErrorDescription! !
!Cart methodsFor: 'adding books' stamp: 'AM 11/17/2020 22:52:32' prior: 50869575!
assertThatCanBeAdded: aBook withOccurences: aNumberOfOccurrences

	(catalogue includes: aBook ) 
		ifFalse: [ self signalBookIsNotForSale ].
		
	(aNumberOfOccurrences isInteger or: [ aNumberOfOccurrences > 0 ]) 
		ifFalse: [ self error: self class bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription ].! !
!Cart methodsFor: 'adding books' stamp: 'AM 11/17/2020 22:52:59'!
signalBookCanNotBeAddedANonNaturalNumberOfTimes

	^ self error: self class bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription! !
!Cart methodsFor: 'adding books' stamp: 'AM 11/17/2020 22:52:59' prior: 50869594!
assertThatCanBeAdded: aBook withOccurences: aNumberOfOccurrences

	(catalogue includes: aBook ) 
		ifFalse: [ self signalBookIsNotForSale ].
		
	(aNumberOfOccurrences isInteger or: [ aNumberOfOccurrences > 0 ]) 
		ifFalse: [ self signalBookCanNotBeAddedANonNaturalNumberOfTimes ].! !

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AM 11/17/2020 22:53:37'!
PASSED!

!testRun: #CartTest #test02ABookAddedToCartIsSuccessfullyAdded stamp: 'AM 11/17/2020 22:53:37'!
ERROR!

!testRun: #CartTest #test03ManyBooksAddedOnceEachToCartAreSuccessfullyAdded stamp: 'AM 11/17/2020 22:53:37'!
ERROR!

!testRun: #CartTest #test04AddingABookThatIsNotForSaleShouldSignalError stamp: 'AM 11/17/2020 22:53:37'!
PASSED!

!testRun: #CartTest #test05ABookAddedMoreThanOnceIsSuccessfullyAddedMoreThanOnce stamp: 'AM 11/17/2020 22:53:37'!
ERROR!

!testRun: #CartTest #test06ABookShouldNotBeAddedWithNonIntegerQuantity stamp: 'AM 11/17/2020 22:53:38'!
FAILURE!

!testRun: #CartTest #test07ABookShouldNotBeAddedWithNonPositiveQuantity stamp: 'AM 11/17/2020 22:53:38'!
FAILURE!
!Cart methodsFor: 'adding books' stamp: 'AM 11/17/2020 22:53:44' prior: 50869613!
assertThatCanBeAdded: aBook withOccurences: aNumberOfOccurrences

	(catalogue includes: aBook ) 
		ifFalse: [ self signalBookIsNotForSale ].
		
	(aNumberOfOccurrences isInteger and: [ aNumberOfOccurrences > 0 ]) 
		ifFalse: [ self signalBookCanNotBeAddedANonNaturalNumberOfTimes ].! !

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AM 11/17/2020 22:53:45'!
PASSED!

!testRun: #CartTest #test02ABookAddedToCartIsSuccessfullyAdded stamp: 'AM 11/17/2020 22:53:45'!
ERROR!

!testRun: #CartTest #test03ManyBooksAddedOnceEachToCartAreSuccessfullyAdded stamp: 'AM 11/17/2020 22:53:45'!
ERROR!

!testRun: #CartTest #test04AddingABookThatIsNotForSaleShouldSignalError stamp: 'AM 11/17/2020 22:53:45'!
PASSED!

!testRun: #CartTest #test05ABookAddedMoreThanOnceIsSuccessfullyAddedMoreThanOnce stamp: 'AM 11/17/2020 22:53:45'!
ERROR!

!testRun: #CartTest #test06ABookShouldNotBeAddedWithNonIntegerQuantity stamp: 'AM 11/17/2020 22:53:45'!
FAILURE!

!testRun: #CartTest #test07ABookShouldNotBeAddedWithNonPositiveQuantity stamp: 'AM 11/17/2020 22:53:45'!
FAILURE!

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AM 11/17/2020 22:53:47'!
PASSED!

!testRun: #CartTest #test02ABookAddedToCartIsSuccessfullyAdded stamp: 'AM 11/17/2020 22:53:47'!
ERROR!

!testRun: #CartTest #test03ManyBooksAddedOnceEachToCartAreSuccessfullyAdded stamp: 'AM 11/17/2020 22:53:47'!
ERROR!

!testRun: #CartTest #test04AddingABookThatIsNotForSaleShouldSignalError stamp: 'AM 11/17/2020 22:53:47'!
PASSED!

!testRun: #CartTest #test05ABookAddedMoreThanOnceIsSuccessfullyAddedMoreThanOnce stamp: 'AM 11/17/2020 22:53:47'!
ERROR!

!testRun: #CartTest #test06ABookShouldNotBeAddedWithNonIntegerQuantity stamp: 'AM 11/17/2020 22:53:47'!
FAILURE!

!testRun: #CartTest #test07ABookShouldNotBeAddedWithNonPositiveQuantity stamp: 'AM 11/17/2020 22:53:47'!
FAILURE!

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AM 11/17/2020 22:53:52'!
PASSED!

!testRun: #CartTest #test02ABookAddedToCartIsSuccessfullyAdded stamp: 'AM 11/17/2020 22:53:52'!
ERROR!

!testRun: #CartTest #test03ManyBooksAddedOnceEachToCartAreSuccessfullyAdded stamp: 'AM 11/17/2020 22:53:52'!
ERROR!

!testRun: #CartTest #test04AddingABookThatIsNotForSaleShouldSignalError stamp: 'AM 11/17/2020 22:53:52'!
PASSED!

!testRun: #CartTest #test05ABookAddedMoreThanOnceIsSuccessfullyAddedMoreThanOnce stamp: 'AM 11/17/2020 22:53:52'!
ERROR!

!testRun: #CartTest #test06ABookShouldNotBeAddedWithNonIntegerQuantity stamp: 'AM 11/17/2020 22:53:52'!
FAILURE!

!testRun: #CartTest #test07ABookShouldNotBeAddedWithNonPositiveQuantity stamp: 'AM 11/17/2020 22:53:52'!
FAILURE!

!testRun: #CartTest #test02ABookAddedToCartIsSuccessfullyAdded stamp: 'AM 11/17/2020 22:53:55'!
ERROR!
!Cart methodsFor: 'adding books' stamp: 'AM 11/17/2020 22:54:26' prior: 50869487!
addToCart: aBook withOccurrences: aNumberOfOccurences

	self assertThatCanBeAdded: aBook withOccurences: aNumberOfOccurences.
		
	books add: aBook withOccurrences: aNumberOfOccurences 
	
	! !

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AM 11/17/2020 22:54:27'!
PASSED!

!testRun: #CartTest #test02ABookAddedToCartIsSuccessfullyAdded stamp: 'AM 11/17/2020 22:54:27'!
PASSED!

!testRun: #CartTest #test03ManyBooksAddedOnceEachToCartAreSuccessfullyAdded stamp: 'AM 11/17/2020 22:54:27'!
PASSED!

!testRun: #CartTest #test04AddingABookThatIsNotForSaleShouldSignalError stamp: 'AM 11/17/2020 22:54:27'!
PASSED!

!testRun: #CartTest #test05ABookAddedMoreThanOnceIsSuccessfullyAddedMoreThanOnce stamp: 'AM 11/17/2020 22:54:27'!
PASSED!

!testRun: #CartTest #test06ABookShouldNotBeAddedWithNonIntegerQuantity stamp: 'AM 11/17/2020 22:54:27'!
PASSED!

!testRun: #CartTest #test07ABookShouldNotBeAddedWithNonPositiveQuantity stamp: 'AM 11/17/2020 22:54:27'!
PASSED!
!Cart methodsFor: 'adding books' stamp: 'AM 11/17/2020 22:54:31' prior: 50869736!
addToCart: aBook withOccurrences: aNumberOfOccurences

	self assertThatCanBeAdded: aBook 
		withOccurences: aNumberOfOccurences.
		
	books add: aBook withOccurrences: aNumberOfOccurences 
	
	! !
!Cart methodsFor: 'adding books' stamp: 'AM 11/17/2020 22:54:35' prior: 50869769!
addToCart: aBook withOccurrences: aNumberOfOccurences

	self assertThatCanBeAdded: aBook 
		withOccurences: aNumberOfOccurences.
		
	books add: aBook 
		withOccurrences: aNumberOfOccurences 
	
	! !

bag := Bag new.!

bag add: #hola withOccurrences: Float pi.!

bag!
!CartTest methodsFor: 'tests - adding' stamp: 'AM 11/17/2020 22:59:37'!
test03ManyBooksAddedToCartAreSuccessfullyAdded

	| aCart catalogue |
	
	catalogue := OrderedCollection with: harryPotter 
									with: lordOfTheRings 
									with: ageOfEmpires .
	
	aCart := Cart withCatalogue: catalogue.
	
	aCart addToCart: harryPotter withOccurrences: 1. 
	aCart addToCart: lordOfTheRings withOccurrences: 1.
	aCart addToCart: ageOfEmpires withOccurrences: 1.
	
	self deny: aCart isEmpty.
	self assert: ( aCart listCart hasEqualElements: {harryPotter. lordOfTheRings. ageOfEmpires} )! !

!methodRemoval: CartTest #test03ManyBooksAddedOnceEachToCartAreSuccessfullyAdded stamp: 'AM 11/17/2020 22:59:37'!
test03ManyBooksAddedOnceEachToCartAreSuccessfullyAdded

	| aCart catalogue |
	
	catalogue := OrderedCollection with: harryPotter 
									with: lordOfTheRings 
									with: ageOfEmpires .
	
	aCart := Cart withCatalogue: catalogue.
	
	aCart addToCart: harryPotter withOccurrences: 1. 
	aCart addToCart: lordOfTheRings withOccurrences: 1.
	aCart addToCart: ageOfEmpires withOccurrences: 1.
	
	self deny: aCart isEmpty.
	self assert: ( aCart listCart hasEqualElements: {harryPotter. lordOfTheRings. ageOfEmpires} )!
!CartTest methodsFor: 'tests - errors' stamp: 'AM 11/17/2020 23:00:37'!
test04ABookShouldNotBeAddedWhenNotForSale

	| aCart catalogue |
	
	catalogue := OrderedCollection with: harryPotter.
	
	aCart := Cart withCatalogue: catalogue.
	
	self should: [ aCart addToCart: lordOfTheRings withOccurrences: 1 ]
		raise: Error
		withMessageText: Cart bookIsNotForSaleErrorDescription.! !

!methodRemoval: CartTest #test04AddingABookThatIsNotForSaleShouldSignalError stamp: 'AM 11/17/2020 23:00:37'!
test04AddingABookThatIsNotForSaleShouldSignalError

	| aCart catalogue |
	
	catalogue := OrderedCollection with: harryPotter.
	
	aCart := Cart withCatalogue: catalogue.
	
	self should: [ aCart addToCart: lordOfTheRings withOccurrences: 1 ]
		raise: Error
		withMessageText: Cart bookIsNotForSaleErrorDescription.!

!testRun: #CartTest #test04ABookShouldNotBeAddedWhenNotForSale stamp: 'AM 11/17/2020 23:00:46'!
PASSED!

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AM 11/17/2020 23:00:46'!
PASSED!

!testRun: #CartTest #test02ABookAddedToCartIsSuccessfullyAdded stamp: 'AM 11/17/2020 23:00:46'!
PASSED!

!testRun: #CartTest #test03ManyBooksAddedToCartAreSuccessfullyAdded stamp: 'AM 11/17/2020 23:00:46'!
PASSED!

!testRun: #CartTest #test04ABookShouldNotBeAddedWhenNotForSale stamp: 'AM 11/17/2020 23:00:46'!
PASSED!

!testRun: #CartTest #test05ABookAddedMoreThanOnceIsSuccessfullyAddedMoreThanOnce stamp: 'AM 11/17/2020 23:00:46'!
PASSED!

!testRun: #CartTest #test06ABookShouldNotBeAddedWithNonIntegerQuantity stamp: 'AM 11/17/2020 23:00:46'!
PASSED!

!testRun: #CartTest #test07ABookShouldNotBeAddedWithNonPositiveQuantity stamp: 'AM 11/17/2020 23:00:46'!
PASSED!

----QUIT----(17 November 2020 23:01:55) CuisUniversity-4384.image priorSource: 17188888!

----STARTUP---- (18 November 2020 18:29:35) as /home/agustin/Escritorio/Uba/Materias/Compu/ISW1/TusLibros/CuisUniversity-4384.image!

!CartTest methodsFor: 'tests - adding' stamp: 'AM 11/18/2020 18:31:11'!
test08

	| anEmptyCart catalogue emptyCartList |
	
	catalogue := OrderedCollection with: harryPotter.
	
	anEmptyCart := Cart withCatalogue: catalogue.
	emptyCartList := anEmptyCart listCart.
	emptyCartList add: harryPotter.
	
	self assert: anEmptyCart isEmpty.
	self assert: anEmptyCart listCart isEmpty.! !

!testRun: #CartTest #test08 stamp: 'AM 11/18/2020 18:31:20'!
FAILURE!
!CartTest methodsFor: 'tests - adding' stamp: 'AM 11/18/2020 18:31:58' prior: 50869886!
test08

	| anEmptyCart catalogue emptyCartList |
	
	catalogue := OrderedCollection with: harryPotter.
	
	anEmptyCart := Cart withCatalogue: catalogue.
	emptyCartList := anEmptyCart listCart.
	emptyCartList add: harryPotter withOccurrences: 1.
	
	self assert: anEmptyCart isEmpty.
	self assert: anEmptyCart listCart isEmpty.! !

!testRun: #CartTest #test08 stamp: 'AM 11/18/2020 18:32:00'!
FAILURE!
!CartTest methodsFor: 'tests - adding' stamp: 'AM 11/18/2020 18:32:23' prior: 50869901!
test08

	| anEmptyCart catalogue emptyCartList |
	
	catalogue := OrderedCollection with: harryPotter.
	
	anEmptyCart := Cart withCatalogue: catalogue.
	emptyCartList := anEmptyCart listCart.
	emptyCartList add: harryPotter.
	
	self assert: anEmptyCart isEmpty.
	self assert: anEmptyCart listCart isEmpty.! !
!Cart methodsFor: 'accessing' stamp: 'AM 11/18/2020 18:32:39' prior: 50868090!
listCart
	
	^ books copy! !

!testRun: #CartTest #test08 stamp: 'AM 11/18/2020 18:32:52'!
PASSED!

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AM 11/18/2020 18:32:52'!
PASSED!

!testRun: #CartTest #test02ABookAddedToCartIsSuccessfullyAdded stamp: 'AM 11/18/2020 18:32:52'!
PASSED!

!testRun: #CartTest #test03ManyBooksAddedToCartAreSuccessfullyAdded stamp: 'AM 11/18/2020 18:32:52'!
PASSED!

!testRun: #CartTest #test04ABookShouldNotBeAddedWhenNotForSale stamp: 'AM 11/18/2020 18:32:52'!
PASSED!

!testRun: #CartTest #test05ABookAddedMoreThanOnceIsSuccessfullyAddedMoreThanOnce stamp: 'AM 11/18/2020 18:32:52'!
PASSED!

!testRun: #CartTest #test06ABookShouldNotBeAddedWithNonIntegerQuantity stamp: 'AM 11/18/2020 18:32:52'!
PASSED!

!testRun: #CartTest #test07ABookShouldNotBeAddedWithNonPositiveQuantity stamp: 'AM 11/18/2020 18:32:52'!
PASSED!

!testRun: #CartTest #test08 stamp: 'AM 11/18/2020 18:32:52'!
PASSED!
!CartTest methodsFor: 'tests - adding' stamp: 'AM 11/18/2020 18:35:36'!
test08AddingBookToCartListShouldNotModifyCart

	| anEmptyCart catalogue emptyCartList |
	
	catalogue := OrderedCollection with: harryPotter.
	
	anEmptyCart := Cart withCatalogue: catalogue.
	emptyCartList := anEmptyCart listCart.
	emptyCartList add: harryPotter.
	
	self assert: anEmptyCart isEmpty.
	self assert: anEmptyCart listCart isEmpty.! !

!methodRemoval: CartTest #test08 stamp: 'AM 11/18/2020 18:35:36'!
test08

	| anEmptyCart catalogue emptyCartList |
	
	catalogue := OrderedCollection with: harryPotter.
	
	anEmptyCart := Cart withCatalogue: catalogue.
	emptyCartList := anEmptyCart listCart.
	emptyCartList add: harryPotter.
	
	self assert: anEmptyCart isEmpty.
	self assert: anEmptyCart listCart isEmpty.!
!CartTest methodsFor: 'tests - adding' stamp: 'AM 11/18/2020 18:35:53'!
test08ExternallyAddingBookToCartListShouldNotModifyCart

	| anEmptyCart catalogue emptyCartList |
	
	catalogue := OrderedCollection with: harryPotter.
	
	anEmptyCart := Cart withCatalogue: catalogue.
	emptyCartList := anEmptyCart listCart.
	emptyCartList add: harryPotter.
	
	self assert: anEmptyCart isEmpty.
	self assert: anEmptyCart listCart isEmpty.! !

!methodRemoval: CartTest #test08AddingBookToCartListShouldNotModifyCart stamp: 'AM 11/18/2020 18:35:53'!
test08AddingBookToCartListShouldNotModifyCart

	| anEmptyCart catalogue emptyCartList |
	
	catalogue := OrderedCollection with: harryPotter.
	
	anEmptyCart := Cart withCatalogue: catalogue.
	emptyCartList := anEmptyCart listCart.
	emptyCartList add: harryPotter.
	
	self assert: anEmptyCart isEmpty.
	self assert: anEmptyCart listCart isEmpty.!

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AM 11/18/2020 18:36:09'!
PASSED!

!testRun: #CartTest #test02ABookAddedToCartIsSuccessfullyAdded stamp: 'AM 11/18/2020 18:36:09'!
PASSED!

!testRun: #CartTest #test03ManyBooksAddedToCartAreSuccessfullyAdded stamp: 'AM 11/18/2020 18:36:09'!
PASSED!

!testRun: #CartTest #test04ABookShouldNotBeAddedWhenNotForSale stamp: 'AM 11/18/2020 18:36:09'!
PASSED!

!testRun: #CartTest #test05ABookAddedMoreThanOnceIsSuccessfullyAddedMoreThanOnce stamp: 'AM 11/18/2020 18:36:09'!
PASSED!

!testRun: #CartTest #test06ABookShouldNotBeAddedWithNonIntegerQuantity stamp: 'AM 11/18/2020 18:36:09'!
PASSED!

!testRun: #CartTest #test07ABookShouldNotBeAddedWithNonPositiveQuantity stamp: 'AM 11/18/2020 18:36:09'!
PASSED!

!testRun: #CartTest #test08ExternallyAddingBookToCartListShouldNotModifyCart stamp: 'AM 11/18/2020 18:36:09'!
PASSED!

----QUIT----(18 November 2020 18:37:47) CuisUniversity-4384.image priorSource: 17223318!

----STARTUP---- (19 November 2020 15:53:22) as /home/agustin/Escritorio/Uba/Materias/Compu/ISW1/TusLibros/CuisUniversity-4384.image!


catalogue := OrderedCollection with: 'hola'.!

cart := Cart with: catalogue.!

cart := Cart withCatalogue: catalogue.!

hola := 'holaaa'.!

catalogue add: holaaa.!

catalogue add: hola.!

cart addToCart: hola withOccurrences: 1 !

cart listCart !

hola := hola, 'a'.!

cart listCart !

hola := hola, 'a'.!

cart listCart !

hola := 'a'.!

cart listCart !

cart listCart !

cart addToCart: hola withOccurrences: 1!

hola := 'holaaa'.!

cart addToCart: hola withOccurrences: 1!

catalogue := OrderedCollection with: 'hola'.!

cart := Cart withCatalogue: catalogue.!

hola := 'holaaa'.!

catalogue add: hola.!

cart addToCart: hola withOccurrences: 1!

hola!

self add: 'a'.!

self at: 1 put: 'c' !

self at: 1 put: (Character asciiValue: 20)!

self at: 1 put: (Character asciiValue: 30)!

self at: 1 put: (Character asciiValue: 60)!

cart listCart !

----STARTUP---- (20 November 2020 19:14:21) as /home/agustin/Escritorio/Uba/Materias/Compu/ISW1/TusLibros/CuisUniversity-4384.image!


!classRemoval: #Cart stamp: 'AM 11/20/2020 19:14:52'!
Object subclass: #Cart
	instanceVariableNames: 'books catalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CartTest stamp: 'AM 11/20/2020 19:14:55'!
TestCase subclass: #CartTest
	instanceVariableNames: 'harryPotter lordOfTheRings ageOfEmpires'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

----End fileIn of /home/agustin/Escritorio/Uba/Materias/Compu/ISW1/isw1-2c2020-ejercicios/20-TusLibros/TusLibros.st----!

!testRun: #CartTest #test02ABookAddedToCartIsSuccessfullyAdded stamp: 'AM 11/20/2020 19:15:25'!
ERROR!

!testRun: #CartTest #test02ABookAddedToCartIsSuccessfullyAdded stamp: 'AM 11/20/2020 19:15:25'!
ERROR!
!Cart methodsFor: 'initialization' stamp: 'AM 11/20/2020 19:15:43' prior: 50870482!
initializeWithCatalogue: aCatalogue
	
	catalogue := aCatalogue.
	books := OrderedCollection new.! !

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AM 11/20/2020 19:15:45'!
PASSED!

!testRun: #CartTest #test02ABookAddedToCartIsSuccessfullyAdded stamp: 'AM 11/20/2020 19:15:45'!
PASSED!

!testRun: #CartTest #test03ManyBooksAddedToCartAreSuccessfullyAdded stamp: 'AM 11/20/2020 19:15:45'!
PASSED!

!testRun: #CartTest #test04ABookShouldNotBeAddedWhenNotForSale stamp: 'AM 11/20/2020 19:15:45'!
PASSED!

!testRun: #CartTest #test05ABookAddedMoreThanOnceIsSuccessfullyAddedMoreThanOnce stamp: 'AM 11/20/2020 19:15:45'!
PASSED!

!testRun: #CartTest #test06ABookShouldNotBeAddedWithNonIntegerQuantity stamp: 'AM 11/20/2020 19:15:45'!
PASSED!

!testRun: #CartTest #test07ABookShouldNotBeAddedWithNonPositiveQuantity stamp: 'AM 11/20/2020 19:15:45'!
PASSED!

!testRun: #CartTest #test08ExternallyAddingBookToCartListShouldNotModifyCart stamp: 'AM 11/20/2020 19:15:45'!
PASSED!

!testRun: #CashierTest #test01CashierShouldNotDispatchEmptyCart stamp: 'AM 11/20/2020 19:15:47'!
PASSED!

!testRun: #CashierTest #test02CashierShouldNotDispatchExpiredCreditCard stamp: 'AM 11/20/2020 19:15:47'!
PASSED!

!testRun: #CashierTest #test03 stamp: 'AM 11/20/2020 19:15:47'!
ERROR!

!testRun: #CashierTest #test04 stamp: 'AM 11/20/2020 19:15:47'!
PASSED!

!testRun: #CashierTest #test05 stamp: 'AM 11/20/2020 19:15:47'!
PASSED!

!testRun: #CashierTest #test03 stamp: 'AM 11/20/2020 19:15:47'!
ERROR!

!testRun: #CashierTest #test03 stamp: 'AM 11/20/2020 19:16:09'!
ERROR!

!testRun: #CashierTest #test03 stamp: 'AM 11/20/2020 19:16:17'!
ERROR!
!Cashier methodsFor: 'as yet unclassified' stamp: 'AM 11/20/2020 19:16:48' prior: 50870527!
checkOut: aCart with: aCreditCard
	
	| total |
	
	(aCreditCard expirationDate < FixedGregorianDate today) ifTrue: [ self error: self class declinedCreditCardErrorDescription ] .
	
	aCart isEmpty ifTrue: [ self error: self class canNotCheckOutAnEmptyCartErrorDescription ] .
	
	merchantProcessor process.
	
	total := aCart listCart sum: [ :aProduct | catalogue at: aProduct ].
	
	^ Ticket total: total products: aCart listCart .! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'AM 11/20/2020 19:17:25' prior: 50870244!
test03
	
	| aCart aCashier aCreditCard aMerchantProcessorDouble aBook catalogue |
	
	aBook := 'Harry Potter'.	
	catalogue := Dictionary with: aBook -> 100.
	aMerchantProcessorDouble := MerchantProcessorDouble new.
	aCashier := Cashier withProcessor: aMerchantProcessorDouble catalogue: catalogue .

	aCart := Cart withCatalogue: catalogue.
	aCart addToCart: aBook withOccurrences: 1.
	aCreditCard := CreditCard withNumber: 4444444444444444 expirationDate: January, 2021 owner: 'Hernn'.  
	
	aCashier checkOut: aCart with: aCreditCard.

	self assert: (aMerchantProcessorDouble receivedMessage: #process) .
! !

!testRun: #CashierTest #test03 stamp: 'AM 11/20/2020 19:17:27'!
PASSED!

!testRun: #CashierTest #test01CashierShouldNotDispatchEmptyCart stamp: 'AM 11/20/2020 19:17:27'!
PASSED!

!testRun: #CashierTest #test02CashierShouldNotDispatchExpiredCreditCard stamp: 'AM 11/20/2020 19:17:27'!
PASSED!

!testRun: #CashierTest #test03 stamp: 'AM 11/20/2020 19:17:27'!
PASSED!

!testRun: #CashierTest #test04 stamp: 'AM 11/20/2020 19:17:27'!
PASSED!

!testRun: #CashierTest #test05 stamp: 'AM 11/20/2020 19:17:27'!
PASSED!
!MerchantProcessorDouble methodsFor: 'testing' stamp: 'AM 11/20/2020 19:18:09'!
receivedAMessage

	^ messages notEmpty .! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'AM 11/20/2020 19:18:09' prior: 50870223!
test02CashierShouldNotDispatchExpiredCreditCard
	
	| aCart aCashier aCreditCard aMerchantProcessorDouble |
	
	aMerchantProcessorDouble := MerchantProcessorDouble new.
	aCashier := Cashier with: aMerchantProcessorDouble.
	aCart := Cart withCatalogue: OrderedCollection new.
	aCreditCard := CreditCard withNumber: 4444444444444444 expirationDate: October, 2020 owner: 'Hernn'.  
	
	self should: [ aCashier checkOut: aCart with: aCreditCard ]
	raise: Error
	withMessageText: Cashier declinedCreditCardErrorDescription.

	self deny: aMerchantProcessorDouble receivedAMessage.
! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'AM 11/20/2020 19:18:09' prior: 50870202!
test01CashierShouldNotDispatchEmptyCart
	
	| aCart aCashier aCreditCard aMerchantProcessorDouble |
	
	aMerchantProcessorDouble := MerchantProcessorDouble new.
	aCashier := Cashier with: aMerchantProcessorDouble.

	aCart := Cart withCatalogue: OrderedCollection new.	
	aCreditCard := CreditCard withNumber: 4444444444444444 expirationDate: January, 2021 owner: 'Hernn'.  
	
	self should: [ aCashier checkOut: aCart with: aCreditCard ]
	raise: Error
	withMessageText: Cashier canNotCheckOutAnEmptyCartErrorDescription .
	
	self deny: aMerchantProcessorDouble receivedAMessage.
! !

!methodRemoval: MerchantProcessorDouble #wasCalled stamp: 'AM 11/20/2020 19:18:09'!
wasCalled

	^ messages notEmpty .!
!CartTest methodsFor: 'tests - adding' stamp: 'AM 11/20/2020 19:19:04' prior: 50870104!
test03ManyBooksAddedToCartAreSuccessfullyAdded

	| aCart catalogue |
	
	catalogue := Dictionary with: harryPotter -> 100
						with: lordOfTheRings -> 100
						with: ageOfEmpires -> 100.
	
	aCart := Cart withCatalogue: catalogue.
	
	aCart addToCart: harryPotter withOccurrences: 1. 
	aCart addToCart: lordOfTheRings withOccurrences: 1.
	aCart addToCart: ageOfEmpires withOccurrences: 1.
	
	self deny: aCart isEmpty.
	self assert: ( aCart listCart hasEqualElements: {harryPotter. lordOfTheRings. ageOfEmpires} )! !

!classDefinition: #CreditCardTest category: 'TusLibros' stamp: 'AM 11/20/2020 19:21:11'!
TestCase subclass: #CreditCardTest
	instanceVariableNames: 'validCardNumber'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CreditCardTest category: 'TusLibros' stamp: 'AM 11/20/2020 19:21:12'!
TestCase subclass: #CreditCardTest
	instanceVariableNames: 'validCardNumber monthInACalendar'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CreditCardTest category: 'TusLibros' stamp: 'AM 11/20/2020 19:21:14'!
TestCase subclass: #CreditCardTest
	instanceVariableNames: 'validCardNumber monthInACalendar hernan'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CreditCardTest category: 'TusLibros' stamp: 'AM 11/20/2020 19:21:15'!
TestCase subclass: #CreditCardTest
	instanceVariableNames: 'validCardNumber monthInACalendar hernan validCreditCard'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/20/2020 19:21:43' overrides: 16927572!
setUp

	
	
	validCardNumber := 4444444444444444.
	monthInACalendar := January, 2021.
	hernan := 'Hernn'.
	
	validCreditCard := CreditCard withNumber: validCardNumber expirationDate: monthInACalendar owner: hernan.
	
	! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/20/2020 19:21:52' prior: 50870956 overrides: 16927572!
setUp
	
	validCardNumber := 4444444444444444.
	monthInACalendar := January, 2021.
	hernan := 'Hernn'.
	
	validCreditCard := CreditCard withNumber: validCardNumber expirationDate: monthInACalendar owner: hernan.
	
	! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/20/2020 19:22:21' prior: 50870334!
test01ValidCardPropertiesAreCorrect
	
	self assert: validCreditCard number equals: validCardNumber .
	self assert: validCreditCard expirationDate equals: monthInACalendar .
	self assert: validCreditCard owner equals: hernan.

	! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/20/2020 19:22:58' prior: 50870351!
test02CardNumberShouldNotHaveLessThan16Digits

	| aCardId aMonthInCalendar aPerson |
	
	aCardId := 10 ^ 15 - 1.
	aMonthInCalendar := January, 2021.
	aPerson := 'Hernn'.
	
	self should: [ CreditCard withNumber: aCardId expirationDate: monthInACalendar owner: hernan ]
	raise: Error
	withMessageText: CreditCard invalidCardNumberErrorDescription .
	

	! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/20/2020 19:23:04' prior: 50870988!
test02CardNumberShouldNotHaveLessThan16Digits

	| aCardId |
	
	aCardId := 10 ^ 15 - 1.
	
	self should: [ CreditCard withNumber: aCardId expirationDate: monthInACalendar owner: hernan ]
	raise: Error
	withMessageText: CreditCard invalidCardNumberErrorDescription .
	

	! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/20/2020 19:23:36' prior: 50870365!
test03CardExpirationDateShouldBeAMonthOfAnYear

	| aMonthInCalendar |
	
	aMonthInCalendar := January/01/2021.
	
	self should: [ CreditCard withNumber: validCardNumber expirationDate: aMonthInCalendar owner: hernan ]
	raise: Error
	withMessageText: CreditCard invalidExpirationDateErrorDescription .
	

	! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/20/2020 19:24:01' prior: 50871015!
test03CardExpirationDateShouldBeAMonthOfAnYear

	| aDayInAMonthOfAnYear |
	
	aDayInAMonthOfAnYear := January/01/2021.
	
	self should: [ CreditCard withNumber: validCardNumber expirationDate: aDayInAMonthOfAnYear owner: hernan ]
	raise: Error
	withMessageText: CreditCard invalidExpirationDateErrorDescription .
	

	! !

!testRun: #CreditCardTest #test03CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/20/2020 19:24:03'!
PASSED!

!testRun: #CreditCardTest #test01ValidCardPropertiesAreCorrect stamp: 'AM 11/20/2020 19:24:03'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/20/2020 19:24:03'!
PASSED!

!testRun: #CreditCardTest #test03CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/20/2020 19:24:03'!
PASSED!

!testRun: #CreditCardTest #test04CardNumberShouldBeAnInteger stamp: 'AM 11/20/2020 19:24:03'!
PASSED!

!testRun: #CreditCardTest #test05CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/20/2020 19:24:04'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeEmpty stamp: 'AM 11/20/2020 19:24:04'!
PASSED!

!testRun: #CreditCardTest #test07OwnerNameShouldNotBeBlank stamp: 'AM 11/20/2020 19:24:04'!
PASSED!
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/20/2020 19:24:28' prior: 50870380!
test04CardNumberShouldBeAnInteger

	| aCardId |
	
	aCardId := 0.5 .
	
	self should: [ CreditCard withNumber: aCardId expirationDate: monthInACalendar owner: hernan ]
	raise: Error
	withMessageText: CreditCard invalidCardNumberErrorDescription .
	

	! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/20/2020 19:24:40' prior: 50871069!
test04CardNumberShouldBeAnInteger

	| aNonIntegerCardNumber |
	
	aNonIntegerCardNumber := 0.5 .
	
	self should: [ CreditCard withNumber: aNonIntegerCardNumber expirationDate: monthInACalendar owner: hernan ]
	raise: Error
	withMessageText: CreditCard invalidCardNumberErrorDescription .
	

	! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/20/2020 19:24:58' prior: 50870394!
test05CardNumberShouldNotHaveMoreThan16Digits

	| anInvalidCardNumber aMonthInCalendar aPerson |
	
	anInvalidCardNumber := 10 ^ 16.
	aMonthInCalendar := January, 2021.
	aPerson := 'Hernn'.
	
	self should: [ CreditCard withNumber: anInvalidCardNumber expirationDate: aMonthInCalendar owner: aPerson ]
	raise: Error
	withMessageText: CreditCard invalidCardNumberErrorDescription .
	

	! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/20/2020 19:25:10' prior: 50871093!
test05CardNumberShouldNotHaveMoreThan16Digits

	| anInvalidCardNumber |
	
	anInvalidCardNumber := 10 ^ 16.
	
	self should: [ CreditCard withNumber: anInvalidCardNumber expirationDate: monthInACalendar owner: hernan ]
	raise: Error
	withMessageText: CreditCard invalidCardNumberErrorDescription .
	

	! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/20/2020 19:25:35' prior: 50870408!
test06OwnerNameShouldNotBeEmpty
	
	self should: [ CreditCard withNumber: validCardNumber expirationDate: monthInACalendar owner: '' ]
	raise: Error
	withMessageText: CreditCard invalidOwnerNameErrorDescription .
	

	! !

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeEmpty stamp: 'AM 11/20/2020 19:25:40'!
PASSED!

!testRun: #CreditCardTest #test01ValidCardPropertiesAreCorrect stamp: 'AM 11/20/2020 19:25:40'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/20/2020 19:25:40'!
PASSED!

!testRun: #CreditCardTest #test03CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/20/2020 19:25:40'!
PASSED!

!testRun: #CreditCardTest #test04CardNumberShouldBeAnInteger stamp: 'AM 11/20/2020 19:25:40'!
PASSED!

!testRun: #CreditCardTest #test05CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/20/2020 19:25:40'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeEmpty stamp: 'AM 11/20/2020 19:25:40'!
PASSED!

!testRun: #CreditCardTest #test07OwnerNameShouldNotBeBlank stamp: 'AM 11/20/2020 19:25:40'!
PASSED!
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/20/2020 19:25:54' prior: 50870422!
test07OwnerNameShouldNotBeBlank

	| aCardId aMonthInCalendar aPerson |
	
	aCardId := 4444444444444444.
	aMonthInCalendar := January, 2021.
	aPerson := '          '.
	
	self should: [ CreditCard withNumber: aCardId expirationDate: aMonthInCalendar owner: '      ' ]
	raise: Error
	withMessageText: CreditCard invalidOwnerNameErrorDescription .
	

	! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/20/2020 19:26:13' prior: 50871159!
test07OwnerNameShouldNotBeBlank.
	
	self should: [ CreditCard withNumber: validCardNumber expirationDate: monthInACalendar owner: '      ' ]
	raise: Error
	withMessageText: CreditCard invalidOwnerNameErrorDescription .
	

	! !

!testRun: #CreditCardTest #test07OwnerNameShouldNotBeBlank stamp: 'AM 11/20/2020 19:26:14'!
PASSED!

!testRun: #CreditCardTest #test01ValidCardPropertiesAreCorrect stamp: 'AM 11/20/2020 19:26:14'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/20/2020 19:26:14'!
PASSED!

!testRun: #CreditCardTest #test03CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/20/2020 19:26:14'!
PASSED!

!testRun: #CreditCardTest #test04CardNumberShouldBeAnInteger stamp: 'AM 11/20/2020 19:26:14'!
PASSED!

!testRun: #CreditCardTest #test05CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/20/2020 19:26:14'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeEmpty stamp: 'AM 11/20/2020 19:26:14'!
PASSED!

!testRun: #CreditCardTest #test07OwnerNameShouldNotBeBlank stamp: 'AM 11/20/2020 19:26:14'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'AM 11/20/2020 19:27:51' prior: 50870857!
test02CashierShouldNotDispatchExpiredCreditCard
	
	| aCart aCashier aCreditCard aMerchantProcessorDouble |
	
	aMerchantProcessorDouble := MerchantProcessorDouble new.
	aCashier := Cashier with: aMerchantProcessorDouble.
	
	aCart := Cart withCatalogue: OrderedCollection new.
	aCreditCard := CreditCard withNumber: 4444444444444444 expirationDate: October, 2020 owner: 'Hernn'.  
	
	self should: [ aCashier checkOut: aCart with: aCreditCard ]
	raise: Error
	withMessageText: Cashier declinedCreditCardErrorDescription.

	self deny: aMerchantProcessorDouble receivedAMessage.
! !

----QUIT----(20 November 2020 19:31:33) CuisUniversity-4384.image priorSource: 17228528!

----STARTUP---- (20 November 2020 19:31:36) as /home/agustin/Escritorio/Uba/Materias/Compu/ISW1/TusLibros/CuisUniversity-4384.image!


----QUIT----(20 November 2020 19:31:47) CuisUniversity-4384.image priorSource: 17266594!

----STARTUP---- (23 November 2020 11:17:17) as /home/agustin/Escritorio/Uba/Materias/Compu/ISW1/TusLibros/CuisUniversity-4384.image!


!classRemoval: #Ticket stamp: 'AM 11/23/2020 11:17:29'!
Object subclass: #Ticket
	instanceVariableNames: 'total products'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #MerchantProcessorDouble stamp: 'AM 11/23/2020 11:17:30'!
Object subclass: #MerchantProcessorDouble
	instanceVariableNames: 'messages'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CreditCard stamp: 'AM 11/23/2020 11:17:32'!
Object subclass: #CreditCard
	instanceVariableNames: 'number expirationDate owner'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cashier stamp: 'AM 11/23/2020 11:17:34'!
Object subclass: #Cashier
	instanceVariableNames: 'merchantProcessor catalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cart stamp: 'AM 11/23/2020 11:17:35'!
Object subclass: #Cart
	instanceVariableNames: 'books catalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CreditCardTest stamp: 'AM 11/23/2020 11:17:37'!
TestCase subclass: #CreditCardTest
	instanceVariableNames: 'validCardNumber monthInACalendar hernan validCreditCard'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CashierTest stamp: 'AM 11/23/2020 11:17:40'!
TestCase subclass: #CashierTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CartTest stamp: 'AM 11/23/2020 11:17:42'!
TestCase subclass: #CartTest
	instanceVariableNames: 'harryPotter lordOfTheRings ageOfEmpires'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

----End fileIn of /home/agustin/Escritorio/Uba/Materias/Compu/ISW1/isw1-2c2020-ejercicios/20-TusLibros/TusLibros-2/TusLibros.st----!

!classDefinition: #CartTest category: 'TusLibros' stamp: 'AM 11/23/2020 11:19:36'!
TestCase subclass: #CartTest
	instanceVariableNames: 'harryPotter lordOfTheRings ageOfEmpires harryPotterCatalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CartTest methodsFor: 'setUp/tearDown' stamp: 'AM 11/23/2020 11:19:34' prior: 50871312 overrides: 16927572!
setUp

	harryPotter := #HarryPotter.
	lordOfTheRings := #LordOfTheRings.
	ageOfEmpires := #AgeOfEmpires.
	
	harryPotterCatalogue := Catalogue new; add: harryPotter withPrice: 100.
	! !
!CartTest methodsFor: 'tests - adding' stamp: 'AM 11/23/2020 11:19:54' prior: 50871318!
test01NewCartIsEmpty

	| anEmptyCart catalogue |
	
	catalogue := Catalogue new.
	
	anEmptyCart := Cart withCatalogue: catalogue.
	
	self assert: anEmptyCart isEmpty.
	self assert: anEmptyCart listCart isEmpty.! !
!CartTest methodsFor: 'tests - adding' stamp: 'AM 11/23/2020 11:20:03' prior: 50871328!
test02ABookAddedToCartIsSuccessfullyAdded

	| aCart |
	
	aCart := Cart withCatalogue: harryPotterCatalogue.
	
	aCart addToCart: harryPotter withOccurrences: 1.
	
	self deny: aCart isEmpty.
	self assert: ( aCart listCart hasEqualElements: {harryPotter} )! !
!CartTest methodsFor: 'tests - adding' stamp: 'AM 11/23/2020 11:20:15' prior: 50871359!
test05ABookAddedMoreThanOnceIsSuccessfullyAddedMoreThanOnce

	| aCart |
	
	aCart := Cart withCatalogue: harryPotterCatalogue.
	
	aCart addToCart: harryPotter withOccurrences: 2. 
	
	self assert: ( aCart listCart hasEqualElements: {harryPotter. harryPotter} )! !
!CartTest methodsFor: 'tests - adding' stamp: 'AM 11/23/2020 11:20:23' prior: 50871372!
test08ExternallyAddingBookToCartListShouldNotModifyCart

	| anEmptyCart catalogue emptyCartList |
	
	catalogue := Dictionary with: harryPotter -> 100.
	
	anEmptyCart := Cart withCatalogue: harryPotterCatalogue.
	emptyCartList := anEmptyCart listCart.
	emptyCartList add: harryPotter.
	
	self assert: anEmptyCart isEmpty.
	self assert: anEmptyCart listCart isEmpty.! !
!CartTest methodsFor: 'tests - adding' stamp: 'AM 11/23/2020 11:20:28' prior: 50872227!
test08ExternallyAddingBookToCartListShouldNotModifyCart

	| anEmptyCart emptyCartList |
	
	anEmptyCart := Cart withCatalogue: harryPotterCatalogue.
	emptyCartList := anEmptyCart listCart.
	emptyCartList add: harryPotter.
	
	self assert: anEmptyCart isEmpty.
	self assert: anEmptyCart listCart isEmpty.! !
!CartTest methodsFor: 'tests - errors' stamp: 'AM 11/23/2020 11:20:52' prior: 50871386!
test04ABookShouldNotBeAddedWhenNotForSale

	| aCart |
	
	aCart := Cart withCatalogue: harryPotterCatalogue.
	
	self should: [ aCart addToCart: lordOfTheRings withOccurrences: 1 ]
		raise: Error
		withMessageText: Cart bookIsNotForSaleErrorDescription.
		
	self assert: aCart isEmpty. ! !
!CartTest methodsFor: 'tests - errors' stamp: 'AM 11/23/2020 11:21:00' prior: 50871399!
test06ABookShouldNotBeAddedWithNonIntegerQuantity

	| aCart |
	
	aCart := Cart withCatalogue: harryPotterCatalogue.
	
	self should: [ aCart addToCart: harryPotter withOccurrences: 0.5 ]
		raise: Error
		withMessageText: Cart bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription.
		
	self assert: aCart isEmpty. ! !
!CartTest methodsFor: 'tests - errors' stamp: 'AM 11/23/2020 11:21:05' prior: 50871413!
test07ABookShouldNotBeAddedWithNonPositiveQuantity

	| aCart catalogue |
	
	catalogue := Dictionary with: harryPotter -> 100.
	
	aCart := Cart withCatalogue: harryPotterCatalogue.
	
	self should: [ aCart addToCart: harryPotter withOccurrences: 0 ]
		raise: Error
		withMessageText: Cart bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription.
		
	self assert: aCart isEmpty. ! !
!CartTest methodsFor: 'tests - errors' stamp: 'AM 11/23/2020 11:21:09' prior: 50872280!
test07ABookShouldNotBeAddedWithNonPositiveQuantity

	| aCart |
	
	aCart := Cart withCatalogue: harryPotterCatalogue.
	
	self should: [ aCart addToCart: harryPotter withOccurrences: 0 ]
		raise: Error
		withMessageText: Cart bookCanNotBeAddedANonNaturalNumberOfTimesErrorDescription.
		
	self assert: aCart isEmpty. ! !

!classDefinition: #CartTest category: 'TusLibros' stamp: 'AM 11/23/2020 11:22:11'!
TestCase subclass: #CartTest
	instanceVariableNames: 'harryPotter lordOfTheRings ageOfEmpires harryPotterCatalogue threeBookCatalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CartTest methodsFor: 'setUp/tearDown' stamp: 'AM 11/23/2020 11:22:09' prior: 50872186 overrides: 16927572!
setUp

	harryPotter := #HarryPotter.
	lordOfTheRings := #LordOfTheRings.
	ageOfEmpires := #AgeOfEmpires.
	
	harryPotterCatalogue := Catalogue new; add: harryPotter withPrice: 100.
	threeBookCatalogue := Catalogue new; 
								add: harryPotter withPrice: 100;
								add: lordOfTheRings withPrice: 50;
								add: ageOfEmpires withPrice: 25.
								
	! !
!CartTest methodsFor: 'tests - adding' stamp: 'AM 11/23/2020 11:22:24' prior: 50871340!
test03ManyBooksAddedToCartAreSuccessfullyAdded

	| aCart |
	
	aCart := Cart withCatalogue: threeBookCatalogue .
	
	aCart addToCart: harryPotter withOccurrences: 1. 
	aCart addToCart: lordOfTheRings withOccurrences: 1.
	aCart addToCart: ageOfEmpires withOccurrences: 1.
	
	self deny: aCart isEmpty.
	self assert: ( aCart listCart hasEqualElements: {harryPotter. lordOfTheRings. ageOfEmpires} )! !

!classDefinition: #CatalogueTest category: 'TusLibros' stamp: 'AM 11/23/2020 11:23:32'!
TestCase subclass: #CatalogueTest
	instanceVariableNames: 'harryPotter'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CatalogueTest category: 'TusLibros' stamp: 'AM 11/23/2020 11:23:33'!
TestCase subclass: #CatalogueTest
	instanceVariableNames: 'harryPotter lordOfTheRings'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CatalogueTest category: 'TusLibros' stamp: 'AM 11/23/2020 11:23:35'!
TestCase subclass: #CatalogueTest
	instanceVariableNames: 'harryPotter lordOfTheRings ageOfEmpires'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CatalogueTest methodsFor: 'as yet unclassified' stamp: 'AM 11/23/2020 11:23:30' overrides: 16927572!
setUp

	harryPotter := 'Harry Potter'.
	lordOfTheRings := 'Lord Of The Rings'.
	ageOfEmpires := 'Age Of Empires'.! !
!CatalogueTest methodsFor: 'as yet unclassified' stamp: 'AM 11/23/2020 11:23:51' prior: 50871643!
test01
	
	| aCatalogue |
	
	aCatalogue := Catalogue new.
	
	self deny: ( aCatalogue includes: harryPotter ).! !
!CatalogueTest methodsFor: 'as yet unclassified' stamp: 'AM 11/23/2020 11:24:08' prior: 50871650!
test02
	
	| aCatalogue |
	
	aCatalogue := Catalogue new.
	
	aCatalogue add: harryPotter withPrice: 100.
	
	self assert: ( aCatalogue includes: harryPotter ).
	self assert: ( aCatalogue priceFor: harryPotter ) equals: 100.! !
!CatalogueTest methodsFor: 'as yet unclassified' stamp: 'AM 11/23/2020 11:24:47' prior: 50871660!
test03
	
	| aCatalogue |
	
	aCatalogue := Catalogue new.
	
	aCatalogue add: harryPotter withPrice: 100.
	aCatalogue add: lordOfTheRings withPrice: 50.
	aCatalogue add: ageOfEmpires withPrice: 25.
	
	self assert: ( aCatalogue includes: harryPotter ).
	self assert: ( aCatalogue includes: lordOfTheRings ).
	self assert: ( aCatalogue includes: ageOfEmpires ).

	self assert: ( aCatalogue priceFor: harryPotter ) equals: 100.
	self assert: ( aCatalogue priceFor: lordOfTheRings ) equals: 50.
	self assert: ( aCatalogue priceFor: ageOfEmpires ) equals: 25.! !
!CatalogueTest methodsFor: 'as yet unclassified' stamp: 'AM 11/23/2020 11:25:04' prior: 50871684!
test04
	
	| aCatalogue |
	
	aCatalogue := Catalogue new.
	
	self should: [ aCatalogue add: harryPotter withPrice: 0 ]
	raise: Error
	withMessageText: Catalogue canNotAddProductWithNonPositivePrice.
	
	self deny: ( aCatalogue includes: harryPotter ) .
! !

!testRun: #CashierTest #test04 stamp: 'AM 11/23/2020 11:28:21'!
PASSED!

!testRun: #CashierTest #test01CashierShouldNotDispatchEmptyCart stamp: 'AM 11/23/2020 11:28:23'!
PASSED!

!testRun: #CashierTest #test02CashierShouldNotDispatchExpiredCreditCard stamp: 'AM 11/23/2020 11:28:23'!
PASSED!

!testRun: #CashierTest #test03 stamp: 'AM 11/23/2020 11:28:23'!
PASSED!

!testRun: #CashierTest #test04 stamp: 'AM 11/23/2020 11:28:23'!
PASSED!

!testRun: #CashierTest #test05 stamp: 'AM 11/23/2020 11:28:23'!
PASSED!

!testRun: #CashierTest #test06 stamp: 'AM 11/23/2020 11:28:23'!
PASSED!

!testRun: #CashierTest #test07 stamp: 'AM 11/23/2020 11:28:23'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'AM 11/23/2020 11:28:46' prior: 50871572!
test06
	
	| aCart aCashier aCreditCard aMerchantProcessorDouble catalogue harryPotter |
	
	aCreditCard := CreditCard withNumber: 4444444444444444 expirationDate: January, 2021 owner: 'Hernn'.  

	aMerchantProcessorDouble := MerchantProcessorDouble with: [ :aTotal :aCard | 
		( aTotal = 100 and: [ aCard = aCreditCard ] ) ifFalse: [self error: 'Collaborators are not valid']. 
		self error: 'Credit card is stolen'.
		].
		
	harryPotter := 'Harry Potter'.
	catalogue := (Dictionary with: harryPotter -> 100).
	aCashier := Cashier withProcessor: aMerchantProcessorDouble catalogue: catalogue.
	
	aCart := Cart withCatalogue: catalogue.
	aCart addToCart: harryPotter withOccurrences: 1.

	self should: [ aCashier checkOut: aCart with: aCreditCard ]
	raise: Error
	withExceptionDo: [ :anError | self assert: anError messageText equals: 'Credit card is stolen'. anError isNested].

! !

!testRun: #CashierTest #test06 stamp: 'AM 11/23/2020 11:28:47'!
PASSED!

!testRun: #CashierTest #test01CashierShouldNotDispatchEmptyCart stamp: 'AM 11/23/2020 11:28:47'!
PASSED!

!testRun: #CashierTest #test02CashierShouldNotDispatchExpiredCreditCard stamp: 'AM 11/23/2020 11:28:47'!
PASSED!

!testRun: #CashierTest #test03 stamp: 'AM 11/23/2020 11:28:47'!
PASSED!

!testRun: #CashierTest #test04 stamp: 'AM 11/23/2020 11:28:47'!
PASSED!

!testRun: #CashierTest #test05 stamp: 'AM 11/23/2020 11:28:47'!
PASSED!

!testRun: #CashierTest #test06 stamp: 'AM 11/23/2020 11:28:47'!
PASSED!

!testRun: #CashierTest #test07 stamp: 'AM 11/23/2020 11:28:47'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'AM 11/23/2020 11:29:07' prior: 50872449!
test06
	
	| aCart aCashier aCreditCard aMerchantProcessorDouble catalogue harryPotter |
	
	aCreditCard := CreditCard withNumber: 4444444444444444 expirationDate: January, 2021 owner: 'Hernn'.  

	aMerchantProcessorDouble := MerchantProcessorDouble with: [ :aTotal :aCard | 
		( aTotal = 100 and: [ aCard = aCreditCard ] ) ifFalse: [self error: 'Collaborators are not valid']. 
		self error: 'Credit card is stolen'.
		].
		
	harryPotter := 'Harry Potter'.
	catalogue := (Dictionary with: harryPotter -> 100).
	aCashier := Cashier withProcessor: aMerchantProcessorDouble catalogue: catalogue.
	
	aCart := Cart withCatalogue: catalogue.
	aCart addToCart: harryPotter withOccurrences: 1.

	self should: [ aCashier checkOut: aCart with: aCreditCard ]
	raise: Error
	withExceptionDo: [ :anError | self assert: anError messageText equals: 'Credit card is stolen'].

! !

----SNAPSHOT----(23 November 2020 11:38:34) CuisUniversity-4384.image priorSource: 17266819!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'AM 11/23/2020 11:40:08' prior: 50872501!
test06
	
	| aCart aCashier aCreditCard aMerchantProcessorDouble catalogue harryPotter |
	
	aCreditCard := CreditCard withNumber: 4444444444444444 expirationDate: January, 2021 owner: 'Hernn'.  

	aMerchantProcessorDouble := MerchantProcessorDouble with: [ :aTotal :aCard | 
		( aTotal = 100 and: [ aCard = aCreditCard ] ) ifFalse: [self error: 'Collaborators are not valid']. 
		self error: 'Credit card is stolen'.
		].
		
	harryPotter := 'Harry Potter'.
	catalogue := (Dictionary with: harryPotter -> 100).
	aCashier := Cashier withProcessor: aMerchantProcessorDouble catalogue: catalogue.
	
	aCart := Cart withCatalogue: catalogue.
	aCart addToCart: harryPotter withOccurrences: 1.

	self should: [ aCashier checkOut: aCart with: aCreditCard ]
	raise: Error
	withExceptionDo: [ :anError | self assert: anError messageText equals: 'Credit card is stolen'. anError isNested].

! !

!testRun: #CashierTest #test06 stamp: 'AM 11/23/2020 11:40:10'!
PASSED!

!testRun: #CashierTest #test01CashierShouldNotDispatchEmptyCart stamp: 'AM 11/23/2020 11:40:10'!
PASSED!

!testRun: #CashierTest #test02CashierShouldNotDispatchExpiredCreditCard stamp: 'AM 11/23/2020 11:40:10'!
PASSED!

!testRun: #CashierTest #test03 stamp: 'AM 11/23/2020 11:40:10'!
PASSED!

!testRun: #CashierTest #test04 stamp: 'AM 11/23/2020 11:40:10'!
PASSED!

!testRun: #CashierTest #test05 stamp: 'AM 11/23/2020 11:40:10'!
PASSED!

!testRun: #CashierTest #test06 stamp: 'AM 11/23/2020 11:40:10'!
PASSED!

!testRun: #CashierTest #test07 stamp: 'AM 11/23/2020 11:40:10'!
PASSED!
!Cashier methodsFor: 'as yet unclassified' stamp: 'AM 11/23/2020 11:40:55' prior: 50871894!
checkOut: aCart with: aCreditCard
	
	| total |
	
	(aCreditCard expirationDate < FixedGregorianDate today) ifTrue: [ self error: self class declinedCreditCardErrorDescription ] .
	
	aCart isEmpty ifTrue: [ self error: self class canNotCheckOutAnEmptyCartErrorDescription ] .
	
	total := aCart listCart sum: [ :aProduct | catalogue at: aProduct ].
	
	[ merchantProcessor debit: total from: aCreditCard ] on: Error do: [:anError | self error: anError messageText ].

	^ Ticket total: total products: aCart listCart .! !

!testRun: #CashierTest #test01CashierShouldNotDispatchEmptyCart stamp: 'AM 11/23/2020 11:40:57'!
PASSED!

!testRun: #CashierTest #test02CashierShouldNotDispatchExpiredCreditCard stamp: 'AM 11/23/2020 11:40:57'!
PASSED!

!testRun: #CashierTest #test03 stamp: 'AM 11/23/2020 11:40:57'!
PASSED!

!testRun: #CashierTest #test04 stamp: 'AM 11/23/2020 11:40:57'!
PASSED!

!testRun: #CashierTest #test05 stamp: 'AM 11/23/2020 11:40:57'!
PASSED!

!testRun: #CashierTest #test06 stamp: 'AM 11/23/2020 11:40:57'!
PASSED!

!testRun: #CashierTest #test07 stamp: 'AM 11/23/2020 11:40:57'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'AM 11/23/2020 11:49:45' prior: 50872534!
test06
	
	| aCart aCashier aCreditCard aMerchantProcessorDouble catalogue harryPotter |
	
	aCreditCard := CreditCard withNumber: 4444444444444444 expirationDate: January, 2021 owner: 'Hernn'.  

	aMerchantProcessorDouble := MerchantProcessorDouble with: [ :aTotal :aCard | 
		( aTotal = 100 and: [ aCard = aCreditCard ] ) ifFalse: [self error: 'Collaborators are not valid']. 
		self error: 'Credit card is stolen'.
		].
		
	harryPotter := 'Harry Potter'.
	catalogue := (Dictionary with: harryPotter -> 100).
	aCashier := Cashier withProcessor: aMerchantProcessorDouble catalogue: catalogue.
	
	aCart := Cart withCatalogue: catalogue.
	aCart addToCart: harryPotter withOccurrences: 1.

	self should: [ aCashier checkOut: aCart with: aCreditCard ]
	raise: Error
	withExceptionDo: [ :anError | self assert: anError messageText equals: 'Credit card is stolen'. self assert: thisContext sender class equals: Cashier].

! !

!testRun: #CashierTest #test06 stamp: 'AM 11/23/2020 11:49:47'!
FAILURE!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'AM 11/23/2020 11:50:28' prior: 50872624!
test06
	
	| aCart aCashier aCreditCard aMerchantProcessorDouble catalogue harryPotter |
	
	aCreditCard := CreditCard withNumber: 4444444444444444 expirationDate: January, 2021 owner: 'Hernn'.  

	aMerchantProcessorDouble := MerchantProcessorDouble with: [ :aTotal :aCard | 
		( aTotal = 100 and: [ aCard = aCreditCard ] ) ifFalse: [self error: 'Collaborators are not valid']. 
		self error: 'Credit card is stolen'.
		].
		
	harryPotter := 'Harry Potter'.
	catalogue := (Dictionary with: harryPotter -> 100).
	aCashier := Cashier withProcessor: aMerchantProcessorDouble catalogue: catalogue.
	
	aCart := Cart withCatalogue: catalogue.
	aCart addToCart: harryPotter withOccurrences: 1.

	self should: [ aCashier checkOut: aCart with: aCreditCard ]
	raise: Error
	withExceptionDo: [ :anError | self halt. self assert: anError messageText equals: 'Credit card is stolen'.].

! !

anError!

thisContext !

self sender!

self receiver !
!Cashier methodsFor: 'as yet unclassified' stamp: 'AM 11/23/2020 11:52:06' prior: 50872586!
checkOut: aCart with: aCreditCard
	
	| total |
	
	(aCreditCard expirationDate < FixedGregorianDate today) ifTrue: [ self error: self class declinedCreditCardErrorDescription ] .
	
	aCart isEmpty ifTrue: [ self error: self class canNotCheckOutAnEmptyCartErrorDescription ] .
	
	total := aCart listCart sum: [ :aProduct | catalogue at: aProduct ].
	
	merchantProcessor debit: total from: aCreditCard.

	^ Ticket total: total products: aCart listCart .! !

!testRun: #CashierTest #test01CashierShouldNotDispatchEmptyCart stamp: 'AM 11/23/2020 11:52:08'!
PASSED!

!testRun: #CashierTest #test02CashierShouldNotDispatchExpiredCreditCard stamp: 'AM 11/23/2020 11:52:08'!
PASSED!

!testRun: #CashierTest #test03 stamp: 'AM 11/23/2020 11:52:08'!
PASSED!

!testRun: #CashierTest #test04 stamp: 'AM 11/23/2020 11:52:08'!
PASSED!

!testRun: #CashierTest #test05 stamp: 'AM 11/23/2020 11:52:08'!
PASSED!

!testRun: #CashierTest #test07 stamp: 'AM 11/23/2020 11:52:08'!
PASSED!

anError!

self receiver!

self receiver class!

----STARTUP---- (23 November 2020 11:58:33) as /home/agustin/Escritorio/Uba/Materias/Compu/ISW1/TusLibros/CuisUniversity-4384.image!

!CashierTest methodsFor: 'as yet unclassified' stamp: 'AM 11/23/2020 11:58:50' prior: 50871602!
test07
	
	| aCart aCashier aCreditCard aMerchantProcessorDouble catalogue harryPotter |
	
	aCreditCard := CreditCard withNumber: 4444444444444444 expirationDate: January, 2021 owner: 'Hernn'.  

	aMerchantProcessorDouble := MerchantProcessorDouble with: [ :aTotal :aCard | 
		( aTotal = 100 and: [ aCard = aCreditCard ] ) ifFalse: [self error: 'Collaborators are not valid']. self halt.
		self error: 'Credit card has no funds'.
		].
		
	harryPotter := 'Harry Potter'.
	catalogue := (Dictionary with: harryPotter -> 100).
	aCashier := Cashier withProcessor: aMerchantProcessorDouble catalogue: catalogue.
	
	aCart := Cart withCatalogue: catalogue.
	aCart addToCart: harryPotter withOccurrences: 1.

	self should: [ aCashier checkOut: aCart with: aCreditCard ]
	raise: Error
	withExceptionDo: [ :anError | self assert: anError messageText equals: 'Credit card has no funds' ].

! !

----STARTUP---- (26 November 2020 11:21:55) as /home/agustin/Escritorio/Uba/Materias/Compu/ISW1/TusLibros/CuisUniversity-4384.image!


!classRemoval: #Ticket stamp: 'AM 11/26/2020 11:22:04'!
Object subclass: #Ticket
	instanceVariableNames: 'total products'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #MerchantProcessorDouble stamp: 'AM 11/26/2020 11:22:06'!
Object subclass: #MerchantProcessorDouble
	instanceVariableNames: 'messages block'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CreditCard stamp: 'AM 11/26/2020 11:22:07'!
Object subclass: #CreditCard
	instanceVariableNames: 'number expirationDate owner'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Catalogue stamp: 'AM 11/26/2020 11:22:08'!
Object subclass: #Catalogue
	instanceVariableNames: 'products'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cashier stamp: 'AM 11/26/2020 11:22:09'!
Object subclass: #Cashier
	instanceVariableNames: 'merchantProcessor catalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cart stamp: 'AM 11/26/2020 11:22:11'!
Object subclass: #Cart
	instanceVariableNames: 'books catalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CreditCardTest stamp: 'AM 11/26/2020 11:22:12'!
TestCase subclass: #CreditCardTest
	instanceVariableNames: 'validCardNumber monthInACalendar hernan validCreditCard'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CatalogueTest stamp: 'AM 11/26/2020 11:22:13'!
TestCase subclass: #CatalogueTest
	instanceVariableNames: 'harryPotter lordOfTheRings ageOfEmpires'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CashierTest stamp: 'AM 11/26/2020 11:22:14'!
TestCase subclass: #CashierTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CartTest stamp: 'AM 11/26/2020 11:22:16'!
TestCase subclass: #CartTest
	instanceVariableNames: 'harryPotter lordOfTheRings ageOfEmpires harryPotterCatalogue threeBookCatalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

----End fileIn of /home/agustin/Escritorio/Uba/Materias/Compu/ISW1/isw1-2c2020-ejercicios/20-TusLibros/TusLibros-2/TusLibros.st----!

!testRun: #CartTest #test01NewCartIsEmpty stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

!testRun: #CartTest #test02AProductAddedToCartIsSuccessfullyAdded stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

!testRun: #CartTest #test03ManyProductsAddedToCartAreSuccessfullyAdded stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

!testRun: #CartTest #test04AProductShouldNotBeAddedWhenNotForSale stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

!testRun: #CartTest #test05AProductAddedMoreThanOnceIsSuccessfullyAddedMoreThanOnce stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

!testRun: #CartTest #test06AProductShouldNotBeAddedWithNonIntegerQuantity stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

!testRun: #CartTest #test07AProductShouldNotBeAddedWithNonPositiveQuantity stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

!testRun: #CartTest #test08ExternallyAddingProductToCartListShouldNotModifyCart stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

!testRun: #CashierTest #test01CashierShouldNotDispatchEmptyCart stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

!testRun: #CashierTest #test02CashierShouldNotDispatchExpiredCreditCard stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

!testRun: #CashierTest #test03CashierShouldUseMerchantProcessorOnValidConditions stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

!testRun: #CashierTest #test04CashierSuccessfullyProcessesOneElementCart stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

!testRun: #CashierTest #test05CashierSuccessfullyProcessesManyElementsCart stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

!testRun: #CashierTest #test06CashierHandlesMerchantProcessorException stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

!testRun: #CashierTest #test08CashierShouldNotProcessProductWhenItIsNotInCatalogue stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

!testRun: #CatalogueTest #test01EmptyCatalogueContainsNoProduct stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

!testRun: #CatalogueTest #test02OneProductCatalogueContainsItsOnlyElement stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

!testRun: #CatalogueTest #test03ACatalogueWithManyProductsIncludesAllOfThem stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

!testRun: #CatalogueTest #test04ShouldNotAddAProductWithNonPositivePrice stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

!testRun: #CreditCardTest #test01ValidCardRetrievesPropertiesCorrectly stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

!testRun: #CreditCardTest #test03CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

!testRun: #CreditCardTest #test04CardNumberShouldBeAnInteger stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

!testRun: #CreditCardTest #test05CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeEmpty stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

!testRun: #CreditCardTest #test07OwnerNameShouldNotBeBlank stamp: 'AM 11/26/2020 11:23:19'!
PASSED!

----STARTUP---- (30 November 2020 17:16:33) as /home/agustin/Escritorio/Uba/Materias/Compu/ISW1/TusLibros/CuisUniversity-4384.image!


!classRemoval: #Ticket stamp: 'AM 11/30/2020 17:17:06'!
Object subclass: #Ticket
	instanceVariableNames: 'total products'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #MerchantProcessorDouble stamp: 'AM 11/30/2020 17:17:07'!
Object subclass: #MerchantProcessorDouble
	instanceVariableNames: 'messages block'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CreditCard stamp: 'AM 11/30/2020 17:17:09'!
Object subclass: #CreditCard
	instanceVariableNames: 'number expirationDate owner'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Catalogue stamp: 'AM 11/30/2020 17:17:10'!
Object subclass: #Catalogue
	instanceVariableNames: 'products'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cashier stamp: 'AM 11/30/2020 17:17:11'!
Object subclass: #Cashier
	instanceVariableNames: 'merchantProcessor catalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cart stamp: 'AM 11/30/2020 17:17:12'!
Object subclass: #Cart
	instanceVariableNames: 'books catalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CreditCardTest stamp: 'AM 11/30/2020 17:17:14'!
TestCase subclass: #CreditCardTest
	instanceVariableNames: 'validCardNumber monthInACalendar hernan validCreditCard'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CatalogueTest stamp: 'AM 11/30/2020 17:17:15'!
TestCase subclass: #CatalogueTest
	instanceVariableNames: 'harryPotter lordOfTheRings ageOfEmpires'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CashierTest stamp: 'AM 11/30/2020 17:17:17'!
TestCase subclass: #CashierTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CartTest stamp: 'AM 11/30/2020 17:17:18'!
TestCase subclass: #CartTest
	instanceVariableNames: 'harryPotter lordOfTheRings ageOfEmpires harryPotterCatalogue threeBookCatalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

----End fileIn of /home/agustin/Escritorio/Uba/Materias/Compu/ISW1/isw1-2c2020-ejercicios/20-TusLibros/TusLibros-3/TusLibros.st----!
!TusLibrosInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 11/30/2020 17:39:46' prior: 50873151!
test14ListPurchasesFromMoreThanOneUser
	
	| interface aCartId purchases |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	interface checkOut: aCartId with: testObjectsFactory notExpiredCreditCard on: testObjectsFactory today.
	
	aCartId := interface createCartForUser: testObjectsFactory anotherValidUser password: testObjectsFactory anotherValidPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	interface checkOut: aCartId with: testObjectsFactory notExpiredCreditCard on: testObjectsFactory today.
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice equals: purchases total.
	self assert: ( purchases products hasEqualElements: {testObjectsFactory itemSellByTheStore } ) .
	
	! !

!testRun: #TusLibrosInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 17:39:48'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 17:39:48'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 17:39:48'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 17:39:48'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 17:39:48'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 17:39:48'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 17:39:48'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 17:39:48'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 17:39:48'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 17:39:48'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 17:39:48'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 17:39:48'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 17:39:48'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 17:39:48'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 17:39:48'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 17:39:48'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 17:39:48'!
PASSED!

time := GregorianDateTime today!

time := GregorianDateTime now!

time := GregorianDateTime now!

time!

time next!

time next: 30 minutes!

30 minute!

time next: 30*minute!

GregorianDateTime now!

GregorianDateTime now!

GregorianDateTime now!

GregorianDateTime now!

GregorianDateTime now!

TestCase subclass: #CreditCardTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CreditCardTest category: 'TusLibros' stamp: 'AM 11/30/2020 18:16:49'!
TestCase subclass: #CreditCardTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #ClockSimulator category: 'TusLibros' stamp: 'AM 11/30/2020 18:26:54'!
Object subclass: #ClockSimulator
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterfaceTest methodsFor: 'tests - credentials' stamp: 'AM 11/30/2020 18:26:43'!
test17
	
	| interface aCartId clock |
		
	clock := ClockSimulator withBlock: [ ^false ].
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: testObjectsFactory time.
								
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	
	
	self should: [ interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore. ]
	raise: Error
	withMessageText: TusLibrosInterface cartHasTimedOutErrorDescription.
		
	! !
!TusLibrosInterfaceTest methodsFor: 'tests - credentials' stamp: 'AM 11/30/2020 18:27:14' prior: 50873898!
test17
	
	| interface aCartId clock |
		
	clock := ClockSimulator withBlock: [ ^false ].
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
								
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	
	
	self should: [ interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore. ]
	raise: Error
	withMessageText: TusLibrosInterface cartHasTimedOutErrorDescription.
		
	! !

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 18:27:14'!
ERROR!
!ClockSimulator class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 18:27:28'!
withBlock: aBlockClosure 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeWithBlock: aBlockClosure ! !
!ClockSimulator class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 18:27:57' prior: 50873946!
withBlock: blockToExecuteOnTestingTime 
	
	^ self new initializeWithBlock: blockToExecuteOnTestingTime ! !

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 18:27:58'!
ERROR!

!classDefinition: #ClockSimulator category: 'TusLibros' stamp: 'AM 11/30/2020 18:28:15'!
Object subclass: #ClockSimulator
	instanceVariableNames: 'blockToExecuteOnTestingTime_CHANGE_ME'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!ClockSimulator methodsFor: 'initialization' stamp: 'AM 11/30/2020 18:28:15'!
initializeWithBlock: blockToExecuteOnTestingTime 
	self shouldBeImplemented.
	blockToExecuteOnTestingTime_CHANGE_ME := blockToExecuteOnTestingTime.! !
!ClockSimulator methodsFor: 'initialization' stamp: 'AM 11/30/2020 18:28:28' prior: 50873972!
initializeWithBlock: blockToExecuteOnTestingTime 
	
	blockToExecuteOnTestingTime_CHANGE_ME := blockToExecuteOnTestingTime.! !

!classDefinition: #ClockSimulator category: 'TusLibros' stamp: 'AM 11/30/2020 18:28:33'!
Object subclass: #ClockSimulator
	instanceVariableNames: 'block'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!ClockSimulator methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 18:28:33' prior: 50873980!
initializeWithBlock: blockToExecuteOnTestingTime 
	
	block := blockToExecuteOnTestingTime.! !

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 18:28:39'!
ERROR!
!TusLibrosInterface class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 18:28:58'!
with: anAuthenticationSystemSimulator catalog: aDictionary through: aStoreTestObjectsFactory clock: aClockSimulator 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeWith: anAuthenticationSystemSimulator catalog: aDictionary through: aStoreTestObjectsFactory clock: aClockSimulator ! !
!TusLibrosInterface class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 18:29:22' prior: 50874004!
with: anAuthenticationSystem catalog: aCatalog through: aMerchantProcessor clock: aClockSimulator 

	^self new initializeWith: anAuthenticationSystem catalog: aCatalog through: aMerchantProcessor clock: aClockSimulator ! !

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 18:29:25'!
ERROR!

!classDefinition: #TusLibrosInterface category: 'TusLibros' stamp: 'AM 11/30/2020 18:29:39'!
Object subclass: #TusLibrosInterface
	instanceVariableNames: 'authenticationSystem catalog carts nextCartId merchantProcessor salesBooks clientByCart clockSimulator'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterface methodsFor: 'initialization' stamp: 'AM 11/30/2020 18:29:39'!
initializeWith: anAuthenticationSystem catalog: aCatalog through: aMerchantProcessor clock: aClockSimulator 
	self shouldBeImplemented.
	authenticationSystem := anAuthenticationSystem.
	catalog := aCatalog.
	merchantProcessor := aMerchantProcessor.
	clockSimulator := aClockSimulator.! !
!TusLibrosInterface methodsFor: 'initialization' stamp: 'AM 11/30/2020 18:29:46' prior: 50874042!
initializeWith: anAuthenticationSystem catalog: aCatalog through: aMerchantProcessor clock: aClockSimulator 
	
	authenticationSystem := anAuthenticationSystem.
	catalog := aCatalog.
	merchantProcessor := aMerchantProcessor.
	clockSimulator := aClockSimulator.! !

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 18:29:49'!
ERROR!
!TusLibrosInterface methodsFor: 'initialization' stamp: 'AM 11/30/2020 18:31:48' prior: 50874055!
initializeWith: anAuthenticationSystem catalog: aCatalog through: aMerchantProcessor clock: aClockSimulator 
	
	authenticationSystem := anAuthenticationSystem.
	catalog := aCatalog.
	merchantProcessor := aMerchantProcessor.
	clockSimulator := aClockSimulator.
	nextCartId := 0.
	salesBooks := Dictionary new.
	clientByCart := Dictionary new.
	carts := Dictionary new.! !

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 18:31:51'!
ERROR!
!TusLibrosInterface class methodsFor: 'error descriptions' stamp: 'AM 11/30/2020 18:32:06'!
cartHasTimedOutErrorDescription
	self shouldBeImplemented.! !
!TusLibrosInterface class methodsFor: 'error descriptions' stamp: 'AM 11/30/2020 18:32:23' prior: 50874087!
cartHasTimedOutErrorDescription
	
	^ 'The cart has timed out'.! !

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 18:32:25'!
FAILURE!
!TusLibrosInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 18:36:17' prior: 50873661!
addToCart: aCartId product: aProduct withOcurrences: aNumberOfOccurrences 
	
	self hasTimedOut: aCartId.
	( self cartAt: aCartId ) add: aNumberOfOccurrences of: aProduct! !

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 18:36:22'!
FAILURE!
!TusLibrosInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 18:39:46'!
hasTimedOut: aCartId
	
	30*minute <= (self lastTimeFor: aCartId) distanceTo: clockSimulator time.! !
!TusLibrosInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 18:40:09' prior: 50874112!
hasTimedOut: aCartId
	
	^ 30*minute <= ((self lastTimeFor: aCartId) distanceTo: clockSimulator time).! !

!classDefinition: #TusLibrosInterface category: 'TusLibros' stamp: 'AM 11/30/2020 18:40:44'!
Object subclass: #TusLibrosInterface
	instanceVariableNames: 'authenticationSystem catalog carts nextCartId merchantProcessor salesBooks clientByCart clockSimulator lastTime'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 18:40:41'!
lastTimeFor: aCartId

	lastTime at: aCartId.! !
!TusLibrosInterfaceTest methodsFor: 'tests - credentials' stamp: 'AM 11/30/2020 18:43:26' prior: 50873921!
test17
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToList: 30*minute.
	
	self should: [ interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore. ]
	raise: Error
	withMessageText: TusLibrosInterface cartHasTimedOutErrorDescription.
		
	! !
!TusLibrosInterfaceTest methodsFor: 'tests - credentials' stamp: 'AM 11/30/2020 18:43:36' prior: 50874141!
test17
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore. ]
	raise: Error
	withMessageText: TusLibrosInterface cartHasTimedOutErrorDescription.
		
	! !

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 18:43:40'!
ERROR!
!ClockSimulator class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 18:43:51'!
withTime: aGregorianDateTime 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeWithTime: aGregorianDateTime ! !
!ClockSimulator class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 18:43:57' prior: 50874191!
withTime: aGregorianDateTime 
	
	^self new initializeWithTime: aGregorianDateTime ! !

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 18:44:04'!
ERROR!

!classDefinition: #ClockSimulator category: 'TusLibros' stamp: 'AM 11/30/2020 18:44:17'!
Object subclass: #ClockSimulator
	instanceVariableNames: 'block gregorianDateTime'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!ClockSimulator methodsFor: 'initialization' stamp: 'AM 11/30/2020 18:44:17'!
initializeWithTime: aGregorianDateTime 
	self shouldBeImplemented.
	gregorianDateTime := aGregorianDateTime.! !
!ClockSimulator methodsFor: 'initialization' stamp: 'AM 11/30/2020 18:44:23' prior: 50874216!
initializeWithTime: aGregorianDateTime 
	
	gregorianDateTime := aGregorianDateTime.! !
!ClockSimulator methodsFor: 'initialization' stamp: 'AM 11/30/2020 18:44:30' prior: 50874223!
initializeWithTime: aGregorianDateTime 
	
	gregorianDateTime := aGregorianDateTime.! !

!classDefinition: #ClockSimulator category: 'TusLibros' stamp: 'AM 11/30/2020 18:44:34'!
Object subclass: #ClockSimulator
	instanceVariableNames: 'block time'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!ClockSimulator methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 18:44:34' prior: 50874229!
initializeWithTime: aGregorianDateTime 
	
	time := aGregorianDateTime.! !

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 18:44:37'!
ERROR!
!ClockSimulator methodsFor: 'time operations' stamp: 'AM 11/30/2020 18:44:53'!
addToTime: aSimpleMeasure 
	self shouldBeImplemented.! !
!ClockSimulator methodsFor: 'time operations' stamp: 'AM 11/30/2020 18:45:56' prior: 50874250!
addToTime: aMeasureOfTime

	time next: aMeasureOfTime.
	
	! !

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 18:45:59'!
FAILURE!
!TusLibrosInterface methodsFor: 'initialization' stamp: 'AM 11/30/2020 18:46:25' prior: 50874069!
initializeWith: anAuthenticationSystem catalog: aCatalog through: aMerchantProcessor clock: aClockSimulator 
	
	authenticationSystem := anAuthenticationSystem.
	catalog := aCatalog.
	merchantProcessor := aMerchantProcessor.
	clockSimulator := aClockSimulator.
	nextCartId := 0.
	salesBooks := Dictionary new.
	clientByCart := Dictionary new.
	carts := Dictionary new.
	lastTime := Dictionary new.! !
!TusLibrosInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 18:47:01' prior: 50873683!
createCartForUser: anUser password: aPassword 
	
	| newCartId |
	
	authenticationSystem authenticate: anUser using: aPassword .
	
	newCartId := self newCartId.
	
	carts add: newCartId -> ( Cart acceptingItemsOf: catalog ) .
	clientByCart add: newCartId -> anUser .
	salesBooks at: anUser ifAbsentPut: OrderedCollection new.
	lastTime at: newCartId put: clockSimulator time.
	
	^ newCartId. ! !

!classDefinition: #TusLibrosInterface category: 'TusLibros' stamp: 'AM 11/30/2020 18:47:05'!
Object subclass: #TusLibrosInterface
	instanceVariableNames: 'authenticationSystem catalog carts nextCartId merchantProcessor salesBooks clientByCart clock lastTime'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 18:47:05' prior: 50874119!
hasTimedOut: aCartId
	
	^ 30*minute <= ((self lastTimeFor: aCartId) distanceTo: clock time).! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 18:47:05' prior: 50874279!
createCartForUser: anUser password: aPassword 
	
	| newCartId |
	
	authenticationSystem authenticate: anUser using: aPassword .
	
	newCartId := self newCartId.
	
	carts add: newCartId -> ( Cart acceptingItemsOf: catalog ) .
	clientByCart add: newCartId -> anUser .
	salesBooks at: anUser ifAbsentPut: OrderedCollection new.
	lastTime at: newCartId put: clock time.
	
	^ newCartId. ! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 18:47:06' prior: 50874263!
initializeWith: anAuthenticationSystem catalog: aCatalog through: aMerchantProcessor clock: aClockSimulator 
	
	authenticationSystem := anAuthenticationSystem.
	catalog := aCatalog.
	merchantProcessor := aMerchantProcessor.
	clock := aClockSimulator.
	nextCartId := 0.
	salesBooks := Dictionary new.
	clientByCart := Dictionary new.
	carts := Dictionary new.
	lastTime := Dictionary new.! !

!testRun: #TusLibrosInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 18:47:13'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 18:47:13'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 18:47:13'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 18:47:13'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 18:47:13'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 18:47:13'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 18:47:13'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 18:47:13'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 18:47:13'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 18:47:13'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 18:47:13'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 18:47:13'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 18:47:13'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 18:47:13'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 18:47:13'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 18:47:13'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 18:47:13'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 18:47:20'!
ERROR!
!TusLibrosInterface class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 18:48:06' prior: 50873758!
with: anAuthenticationSystem catalog: aCatalog through: aMerchantProcessor   

	^ self new initializeWith: anAuthenticationSystem catalog: aCatalog through: aMerchantProcessor clock: (ClockSimulator withTime: GregorianDateTime now).! !

!testRun: #TusLibrosInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 18:48:08'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 18:48:08'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 18:48:08'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 18:48:08'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 18:48:08'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 18:48:08'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 18:48:08'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 18:48:08'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 18:48:08'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 18:48:08'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 18:48:08'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 18:48:08'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 18:48:08'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 18:48:08'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 18:48:08'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 18:48:08'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 18:48:08'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 18:48:12'!
ERROR!

!methodRemoval: ClockSimulator class #withBlock: stamp: 'AM 11/30/2020 18:48:29'!
withBlock: blockToExecuteOnTestingTime 
	
	^ self new initializeWithBlock: blockToExecuteOnTestingTime !

!methodRemoval: ClockSimulator #initializeWithBlock: stamp: 'AM 11/30/2020 18:48:37'!
initializeWithBlock: blockToExecuteOnTestingTime 
	
	block := blockToExecuteOnTestingTime.!
!ClockSimulator methodsFor: 'time operations' stamp: 'AM 11/30/2020 18:48:47'!
time

	^ time 
	
	! !

!testRun: #TusLibrosInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 18:48:48'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 18:48:48'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 18:48:48'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 18:48:48'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 18:48:49'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 18:48:49'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 18:48:49'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 18:48:49'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 18:48:49'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 18:48:49'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 18:48:49'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 18:48:49'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 18:48:49'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 18:48:49'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 18:48:49'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 18:48:49'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 18:48:49'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 18:48:53'!
ERROR!
!TusLibrosInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 18:49:16' prior: 50874136!
lastTimeFor: aCartId

	^ lastTime at: aCartId.! !

!testRun: #TusLibrosInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 18:49:21'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 18:49:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 18:49:33'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 18:49:34'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 18:49:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 18:49:36'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 18:49:37'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 18:49:38'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 18:49:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 18:49:41'!
FAILURE!
!TusLibrosInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 18:50:19' prior: 50874101!
addToCart: aCartId product: aProduct withOcurrences: aNumberOfOccurrences 
	
	| cart |
	cart := self cartAt: aCartId.
	self hasTimedOut: aCartId.
	
	cart add: aNumberOfOccurrences of: aProduct! !
!TusLibrosInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 18:50:29' prior: 50874607!
addToCart: aCartId product: aProduct withOcurrences: aNumberOfOccurrences 
	
	| cart |
	
	cart := self cartAt: aCartId.
	self hasTimedOut: aCartId.
	
	cart add: aNumberOfOccurrences of: aProduct! !

!testRun: #TusLibrosInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 18:50:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 18:50:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 18:50:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 18:50:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 18:50:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 18:50:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 18:50:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 18:50:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 18:50:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 18:50:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 18:50:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 18:50:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 18:50:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 18:50:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 18:50:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 18:50:30'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 18:50:30'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 18:50:30'!
FAILURE!

(self lastTimeFor: aCartId)!

clock time!
!ClockSimulator methodsFor: 'time operations' stamp: 'AM 11/30/2020 18:52:14' prior: 50874255!
addToTime: aMeasureOfTime

	time := time next: aMeasureOfTime.
	
	! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 18:52:34'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 18:52:35'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 18:52:35'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 18:52:35'!
FAILURE!

time next: aMeasureOfTime.!
!TusLibrosInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 18:54:21' prior: 50874617!
addToCart: aCartId product: aProduct withOcurrences: aNumberOfOccurrences 
	
	| cart |
	
	cart := self cartAt: aCartId.
	(self hasTimedOut: aCartId) ifTrue: [ self error: self class cartHasTimedOutErrorDescription ].
	
	cart add: aNumberOfOccurrences of: aProduct! !

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 18:54:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 18:54:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 18:54:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 18:54:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 18:54:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 18:54:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 18:54:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 18:54:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 18:54:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 18:54:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 18:54:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 18:54:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 18:54:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 18:54:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 18:54:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 18:54:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 18:54:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 18:54:31'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'tests - credentials' stamp: 'AM 11/30/2020 18:55:41'!
test18
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface listCart: aCartId  ]
	raise: Error
	withMessageText: TusLibrosInterface cartHasTimedOutErrorDescription.
		
	! !
!StoreTestObjectsFactory methodsFor: 'nil' stamp: 'AM 11/30/2020 18:57:04'!
clockSimulator

	^ ClockSimulator withTime:
		 ( GregorianDateTime date: November/25/2020 timeOfDay: 12:00:00 ).! !
!TusLibrosInterfaceTest methodsFor: 'tests - credentials' stamp: 'AM 11/30/2020 18:57:26' prior: 50874165!
test17
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore. ]
	raise: Error
	withMessageText: TusLibrosInterface cartHasTimedOutErrorDescription.
		
	! !

!testRun: #TusLibrosInterfaceTest #test18 stamp: 'AM 11/30/2020 18:57:42'!
FAILURE!
!TusLibrosInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 18:59:17' prior: 50873697!
listCart: aCartId 
	| cart |
	cart := self cartAt: aCartId.
	(self hasTimedOut: aCartId) ifTrue: [self error: self class cartHasTimedOutErrorDescription ].
	^ cart! !

!testRun: #TusLibrosInterfaceTest #test18 stamp: 'AM 11/30/2020 18:59:22'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 18:59:22'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 18:59:22'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 18:59:22'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 18:59:22'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 18:59:22'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 18:59:22'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 18:59:22'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 18:59:22'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 18:59:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 18:59:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 18:59:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 18:59:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 18:59:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 18:59:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 18:59:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 18:59:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 18:59:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test18 stamp: 'AM 11/30/2020 18:59:23'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 18:59:23'!
ERROR!
!TusLibrosInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 18:59:39' prior: 50874939!
listCart: aCartId 
	| cart |
	cart := self cartAt: aCartId.
	(self hasTimedOut: aCartId) ifTrue: [self error: self class cartHasTimedOutErrorDescription ].
	^ cart listCart! !

!testRun: #TusLibrosInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 18:59:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 18:59:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 18:59:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 18:59:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 18:59:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 18:59:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 18:59:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 18:59:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 18:59:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 18:59:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 18:59:40'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 18:59:41'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 18:59:41'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 18:59:41'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 18:59:41'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 18:59:41'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 18:59:41'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test18 stamp: 'AM 11/30/2020 18:59:41'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'tests - credentials' stamp: 'AM 11/30/2020 19:00:20' prior: 50874885!
test18
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface checkOut: aCartId with: testObjectsFactory notExpiredCreditCard on: testObjectsFactory today ]
	raise: Error
	withMessageText: TusLibrosInterface cartHasTimedOutErrorDescription.
		
	! !
!TusLibrosInterfaceTest methodsFor: 'tests - credentials' stamp: 'AM 11/30/2020 18:55:41' prior: 50875092!
test18
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface listCart: aCartId  ]
	raise: Error
	withMessageText: TusLibrosInterface cartHasTimedOutErrorDescription.
		
	! !
!TusLibrosInterfaceTest methodsFor: 'tests - credentials' stamp: 'AM 11/30/2020 19:00:31'!
test19
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface checkOut: aCartId with: testObjectsFactory notExpiredCreditCard on: testObjectsFactory today ]
	raise: Error
	withMessageText: TusLibrosInterface cartHasTimedOutErrorDescription.
		
	! !

!testRun: #TusLibrosInterfaceTest #test19 stamp: 'AM 11/30/2020 19:00:36'!
FAILURE!
!TusLibrosInterfaceTest methodsFor: 'tests - credentials' stamp: 'AM 11/30/2020 19:01:10' prior: 50875138!
test19
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	clock addToTime: 30*minute.
	
	self should: [ interface checkOut: aCartId with: testObjectsFactory notExpiredCreditCard on: testObjectsFactory today ]
	raise: Error
	withMessageText: TusLibrosInterface cartHasTimedOutErrorDescription.
		
	! !

!testRun: #TusLibrosInterfaceTest #test19 stamp: 'AM 11/30/2020 19:01:12'!
FAILURE!
!TusLibrosInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:03:14' prior: 50873669!
checkOut: aCartId with: aCreditCard on: aDate 
	
	| total cart |
	
	cart := self cartAt: aCartId.
	(self hasTimedOut: aCartId) ifTrue: [self error: self class cartHasTimedOutErrorDescription ].
	
	total := ( Cashier toCheckout: cart 
		charging: aCreditCard 
		throught: merchantProcessor 
		on: aDate 
		registeringOn: ( salesBooks at: ( self clientUsingCart: aCartId ) ) )
		checkOut .
			
	carts removeKey: aCartId .
	clientByCart removeKey: aCartId .
	
	^ total.
! !

!testRun: #TusLibrosInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 19:03:18'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 19:03:18'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 19:03:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 19:03:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 19:03:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 19:03:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 19:03:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:03:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 19:03:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 19:03:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 19:03:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:03:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:03:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 19:03:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 19:03:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 19:03:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 19:03:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test18 stamp: 'AM 11/30/2020 19:03:19'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test19 stamp: 'AM 11/30/2020 19:03:19'!
PASSED!
!TusLibrosInterface methodsFor: 'assertions' stamp: 'AM 11/30/2020 19:04:19'!
assertThatCartHasNotTimedOut: aCartId

	(self hasTimedOut: aCartId) ifTrue: [ self error: self class cartHasTimedOutErrorDescription ].! !
!TusLibrosInterface methodsFor: 'assertions' stamp: 'AM 11/30/2020 19:04:56'!
assertThatCartIdIsValid: aCartId

	(self hasTimedOut: aCartId) ifTrue: [ self error: self class cartHasTimedOutErrorDescription ].! !
!TusLibrosInterface methodsFor: 'cart management - private' stamp: 'AM 11/30/2020 19:05:13' prior: 50873702!
cartAt: aCartId

	^ carts at: aCartId ! !
!TusLibrosInterface methodsFor: 'assertions' stamp: 'AM 11/30/2020 19:05:46' prior: 50875286!
assertThatCartIdIsValid: aCartId

	(carts includesKey: aCartId) ifTrue: [ self error: self class invalidCartIdErrorDescription ]! !
!TusLibrosInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:06:29' prior: 50875018!
listCart: aCartId 
	
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	^ self cartAt: aCartId listCart! !
!TusLibrosInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:06:33' prior: 50875307!
listCart: aCartId 
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	^ self cartAt: aCartId listCart! !
!TusLibrosInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:06:47' prior: 50875315!
listCart: aCartId 
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	^ (self cartAt: aCartId) listCart! !
!TusLibrosInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:07:10' prior: 50875194!
checkOut: aCartId with: aCreditCard on: aDate 
	
	| total |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	total := ( Cashier toCheckout: (self cartAt: aCartId) 
		charging: aCreditCard 
		throught: merchantProcessor 
		on: aDate 
		registeringOn: ( salesBooks at: ( self clientUsingCart: aCartId ) ) )
		checkOut .
			
	carts removeKey: aCartId .
	clientByCart removeKey: aCartId .
	
	^ total.
! !
!TusLibrosInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:07:53' prior: 50874809!
addToCart: aCartId product: aProduct withOcurrences: aNumberOfOccurrences 
	
	
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	(self cartAt: aCartId) add: aNumberOfOccurrences of: aProduct! !
!TusLibrosInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:07:58' prior: 50875348!
addToCart: aCartId product: aProduct withOcurrences: aNumberOfOccurrences 
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	(self cartAt: aCartId) add: aNumberOfOccurrences of: aProduct! !

!testRun: #TusLibrosInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 19:08:07'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 19:08:07'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 19:08:07'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 19:08:07'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 19:08:07'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 19:08:07'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 19:08:07'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:08:07'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 19:08:07'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 19:08:07'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 19:08:07'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:08:07'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:08:07'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 19:08:07'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 19:08:07'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 19:08:07'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 19:08:07'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test18 stamp: 'AM 11/30/2020 19:08:07'!
FAILURE!

!testRun: #TusLibrosInterfaceTest #test19 stamp: 'AM 11/30/2020 19:08:07'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 19:08:10'!
ERROR!
!TusLibrosInterface methodsFor: 'assertions' stamp: 'AM 11/30/2020 19:08:29' prior: 50875299!
assertThatCartIdIsValid: aCartId

	(carts includesKey: aCartId) ifFalse: [ self error: self class invalidCartIdErrorDescription ]! !

!testRun: #TusLibrosInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 19:08:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 19:08:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 19:08:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 19:08:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 19:08:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 19:08:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 19:08:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:08:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 19:08:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 19:08:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 19:08:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:08:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:08:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 19:08:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 19:08:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 19:08:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 19:08:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test18 stamp: 'AM 11/30/2020 19:08:31'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test19 stamp: 'AM 11/30/2020 19:08:31'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'tests - credentials' stamp: 'AM 11/30/2020 19:10:12'!
test20
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	interface listCart: aCartId .
	
	clock addToTime: 29*minute.
	
	self assert: (interface listCart: aCartId) isEmpty.
		
	! !
!TusLibrosInterfaceTest methodsFor: 'tests - credentials' stamp: 'AM 11/30/2020 19:10:35' prior: 50875514!
test20
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 	
	
	clock addToTime: 29*minute.
	interface listCart: aCartId .
	clock addToTime: 1*minute.

	self assert: (interface listCart: aCartId) isEmpty.
		
	! !

!testRun: #TusLibrosInterfaceTest #test20 stamp: 'AM 11/30/2020 19:10:43'!
ERROR!
!TusLibrosInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:11:21' prior: 50875323!
listCart: aCartId 
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	lastTime at: aCartId put: clock time.
	
	^ (self cartAt: aCartId) listCart! !

!testRun: #TusLibrosInterfaceTest #test20 stamp: 'AM 11/30/2020 19:11:29'!
ERROR!

!testRun: #TusLibrosInterfaceTest #test20 stamp: 'AM 11/30/2020 19:11:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 19:11:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 19:11:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 19:11:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 19:11:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 19:11:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 19:11:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 19:11:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:11:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 19:11:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 19:11:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 19:11:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:11:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:11:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 19:11:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 19:11:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 19:11:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 19:11:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test18 stamp: 'AM 11/30/2020 19:11:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test19 stamp: 'AM 11/30/2020 19:11:43'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test20 stamp: 'AM 11/30/2020 19:11:43'!
PASSED!
!TusLibrosInterfaceTest methodsFor: 'tests - credentials' stamp: 'AM 11/30/2020 19:15:15' prior: 50875535!
test20
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 	
	
	clock addToTime: 29*minute.
	interface listCart: aCartId .
	clock addToTime: 29*minute.
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	clock addToTime: 29*minute.
	[ interface checkOut: aCartId with: testObjectsFactory expiredCreditCard on: testObjectsFactory today ] on: Error do: [:anError | ].
	clock addToTime: 29*minute.
	interface listCart: aCartId .

	self assert: (interface listCart: aCartId) isEmpty.
		
	! !
!TusLibrosInterfaceTest methodsFor: 'tests - credentials' stamp: 'AM 11/30/2020 19:16:13' prior: 50875643!
test20
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 	
	
	self shouldnt: [ clock addToTime: 29*minute.
				interface listCart: aCartId .
				clock addToTime: 29*minute.
				interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
				clock addToTime: 29*minute.
				[ interface checkOut: aCartId with: testObjectsFactory expiredCreditCard on: testObjectsFactory today ] on: Error do: [:anError | ].
				clock addToTime: 29*minute.
				interface listCart: aCartId ]
		raise: Error.
		
	! !

!testRun: #TusLibrosInterfaceTest #test20 stamp: 'AM 11/30/2020 19:16:25'!
FAILURE!
!TusLibrosInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:16:49' prior: 50875359!
addToCart: aCartId product: aProduct withOcurrences: aNumberOfOccurrences 
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	lastTime at: aCartId put: clock time.

	(self cartAt: aCartId) add: aNumberOfOccurrences of: aProduct! !
!TusLibrosInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:17:05' prior: 50875707!
addToCart: aCartId product: aProduct withOcurrences: aNumberOfOccurrences 
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUsedTimeOf: aCartId.

	(self cartAt: aCartId) add: aNumberOfOccurrences of: aProduct! !
!TusLibrosInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:17:17' prior: 50875559!
listCart: aCartId 
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUsedTimeOf: aCartId.
	
	^ (self cartAt: aCartId) listCart! !
!TusLibrosInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:17:23' prior: 50875331!
checkOut: aCartId with: aCreditCard on: aDate 
	
	| total |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUsedTimeOf: aCartId.

	total := ( Cashier toCheckout: (self cartAt: aCartId) 
		charging: aCreditCard 
		throught: merchantProcessor 
		on: aDate 
		registeringOn: ( salesBooks at: ( self clientUsingCart: aCartId ) ) )
		checkOut .
			
	carts removeKey: aCartId .
	clientByCart removeKey: aCartId .
	
	^ total.
! !
!TusLibrosInterface methodsFor: 'nil' stamp: 'AM 11/30/2020 19:18:08'!
updateLastUsedTimeOf: aCartId

	lastTime at: aCartId put: clock time.
! !

!testRun: #TusLibrosInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 19:18:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 19:18:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 19:18:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 19:18:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 19:18:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 19:18:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 19:18:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:18:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 19:18:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 19:18:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 19:18:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:18:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:18:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 19:18:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 19:18:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 19:18:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 19:18:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test18 stamp: 'AM 11/30/2020 19:18:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test19 stamp: 'AM 11/30/2020 19:18:09'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test20 stamp: 'AM 11/30/2020 19:18:09'!
PASSED!
!TusLibrosInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:19:14' prior: 50874312!
createCartForUser: anUser password: aPassword 
	
	| newCartId |
	
	authenticationSystem authenticate: anUser using: aPassword .
	
	newCartId := self newCartId.
	
	carts add: newCartId -> ( Cart acceptingItemsOf: catalog ) .
	clientByCart add: newCartId -> anUser .
	salesBooks at: anUser ifAbsentPut: OrderedCollection new.
	
	self updateLastUsedTimeOf: newCartId .	
	
	^ newCartId. ! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:19:31'!
updateLastUseOf: aCartId

	lastTime at: aCartId put: clock time.
! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:19:31' prior: 50875740!
checkOut: aCartId with: aCreditCard on: aDate 
	
	| total |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.

	total := ( Cashier toCheckout: (self cartAt: aCartId) 
		charging: aCreditCard 
		throught: merchantProcessor 
		on: aDate 
		registeringOn: ( salesBooks at: ( self clientUsingCart: aCartId ) ) )
		checkOut .
			
	carts removeKey: aCartId .
	clientByCart removeKey: aCartId .
	
	^ total.
! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:19:31' prior: 50875833!
createCartForUser: anUser password: aPassword 
	
	| newCartId |
	
	authenticationSystem authenticate: anUser using: aPassword .
	
	newCartId := self newCartId.
	
	carts add: newCartId -> ( Cart acceptingItemsOf: catalog ) .
	clientByCart add: newCartId -> anUser .
	salesBooks at: anUser ifAbsentPut: OrderedCollection new.
	
	self updateLastUseOf: newCartId .	
	
	^ newCartId. ! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:19:31' prior: 50875731!
listCart: aCartId 
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	^ (self cartAt: aCartId) listCart! !
!TusLibrosInterface methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:19:31' prior: 50875719!
addToCart: aCartId product: aProduct withOcurrences: aNumberOfOccurrences 
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.

	(self cartAt: aCartId) add: aNumberOfOccurrences of: aProduct! !

!methodRemoval: TusLibrosInterface #updateLastUsedTimeOf: stamp: 'AM 11/30/2020 19:19:31'!
updateLastUsedTimeOf: aCartId

	lastTime at: aCartId put: clock time.
!
!TusLibrosInterfaceTest methodsFor: 'tests - credentials' stamp: 'AM 11/30/2020 19:22:11'!
test17ListCartShouldNotListWhenTimedOut
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore. ]
	raise: Error
	withMessageText: TusLibrosInterface cartHasTimedOutErrorDescription.
		
	! !

!methodRemoval: TusLibrosInterfaceTest #test17 stamp: 'AM 11/30/2020 19:22:11'!
test17
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore. ]
	raise: Error
	withMessageText: TusLibrosInterface cartHasTimedOutErrorDescription.
		
	!
!TusLibrosInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 11/30/2020 19:22:57'!
test17ShouldNotListWhenTimedOut
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore. ]
	raise: Error
	withMessageText: TusLibrosInterface cartHasTimedOutErrorDescription.
		
	! !

!methodRemoval: TusLibrosInterfaceTest #test17ListCartShouldNotListWhenTimedOut stamp: 'AM 11/30/2020 19:22:57'!
test17ListCartShouldNotListWhenTimedOut
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore. ]
	raise: Error
	withMessageText: TusLibrosInterface cartHasTimedOutErrorDescription.
		
	!
!TusLibrosInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 11/30/2020 19:23:05'!
test17ShouldNotListWhenCartTimedOut
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore. ]
	raise: Error
	withMessageText: TusLibrosInterface cartHasTimedOutErrorDescription.
		
	! !

!methodRemoval: TusLibrosInterfaceTest #test17ShouldNotListWhenTimedOut stamp: 'AM 11/30/2020 19:23:06'!
test17ShouldNotListWhenTimedOut
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore. ]
	raise: Error
	withMessageText: TusLibrosInterface cartHasTimedOutErrorDescription.
		
	!
!TusLibrosInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 11/30/2020 19:23:22'!
test18ShouldNotAddToTImedOutCart
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface listCart: aCartId  ]
	raise: Error
	withMessageText: TusLibrosInterface cartHasTimedOutErrorDescription.
		
	! !

!methodRemoval: TusLibrosInterfaceTest #test18 stamp: 'AM 11/30/2020 19:23:22'!
test18
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface listCart: aCartId  ]
	raise: Error
	withMessageText: TusLibrosInterface cartHasTimedOutErrorDescription.
		
	!
!TusLibrosInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 11/30/2020 19:23:43'!
test19ShouldNotCheckOutATimedOutCart
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	clock addToTime: 30*minute.
	
	self should: [ interface checkOut: aCartId with: testObjectsFactory notExpiredCreditCard on: testObjectsFactory today ]
	raise: Error
	withMessageText: TusLibrosInterface cartHasTimedOutErrorDescription.
		
	! !

!methodRemoval: TusLibrosInterfaceTest #test19 stamp: 'AM 11/30/2020 19:23:43'!
test19
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	clock addToTime: 30*minute.
	
	self should: [ interface checkOut: aCartId with: testObjectsFactory notExpiredCreditCard on: testObjectsFactory today ]
	raise: Error
	withMessageText: TusLibrosInterface cartHasTimedOutErrorDescription.
		
	!
!TusLibrosInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 11/30/2020 19:23:51'!
test18ShouldNotAddToTimedOutCart
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface listCart: aCartId  ]
	raise: Error
	withMessageText: TusLibrosInterface cartHasTimedOutErrorDescription.
		
	! !

!methodRemoval: TusLibrosInterfaceTest #test18ShouldNotAddToTImedOutCart stamp: 'AM 11/30/2020 19:23:51'!
test18ShouldNotAddToTImedOutCart
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface listCart: aCartId  ]
	raise: Error
	withMessageText: TusLibrosInterface cartHasTimedOutErrorDescription.
		
	!
!TusLibrosInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 11/30/2020 19:24:48'!
test20ShouldNotTimeOutWhen30MInutesHaveNotPassedFromLastOperation
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 	
	
	self shouldnt: [ clock addToTime: 29*minute.
				interface listCart: aCartId .
				clock addToTime: 29*minute.
				interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
				clock addToTime: 29*minute.
				[ interface checkOut: aCartId with: testObjectsFactory expiredCreditCard on: testObjectsFactory today ] on: Error do: [:anError | ].
				clock addToTime: 29*minute.
				interface listCart: aCartId ]
		raise: Error.
		
	! !

!methodRemoval: TusLibrosInterfaceTest #test20 stamp: 'AM 11/30/2020 19:24:48'!
test20
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 	
	
	self shouldnt: [ clock addToTime: 29*minute.
				interface listCart: aCartId .
				clock addToTime: 29*minute.
				interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
				clock addToTime: 29*minute.
				[ interface checkOut: aCartId with: testObjectsFactory expiredCreditCard on: testObjectsFactory today ] on: Error do: [:anError | ].
				clock addToTime: 29*minute.
				interface listCart: aCartId ]
		raise: Error.
		
	!
!TusLibrosInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 11/30/2020 19:25:09'!
test20ShouldNotTimeOutWhen30MinutesHaveNotPassedFromLastOperation
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 	
	
	self shouldnt: [ clock addToTime: 29*minute.
				interface listCart: aCartId .
				clock addToTime: 29*minute.
				interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
				clock addToTime: 29*minute.
				[ interface checkOut: aCartId with: testObjectsFactory expiredCreditCard on: testObjectsFactory today ] on: Error do: [:anError | ].
				clock addToTime: 29*minute.
				interface listCart: aCartId ]
		raise: Error.
		
	! !

!methodRemoval: TusLibrosInterfaceTest #test20ShouldNotTimeOutWhen30MInutesHaveNotPassedFromLastOperation stamp: 'AM 11/30/2020 19:25:09'!
test20ShouldNotTimeOutWhen30MInutesHaveNotPassedFromLastOperation
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 	
	
	self shouldnt: [ clock addToTime: 29*minute.
				interface listCart: aCartId .
				clock addToTime: 29*minute.
				interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
				clock addToTime: 29*minute.
				[ interface checkOut: aCartId with: testObjectsFactory expiredCreditCard on: testObjectsFactory today ] on: Error do: [:anError | ].
				clock addToTime: 29*minute.
				interface listCart: aCartId ]
		raise: Error.
		
	!
!TusLibrosInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 11/30/2020 19:25:52'!
test20TimeOutTimeIsResetAfterAnyOperation
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 	
	
	self shouldnt: [ clock addToTime: 29*minute.
				interface listCart: aCartId .
				clock addToTime: 29*minute.
				interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
				clock addToTime: 29*minute.
				[ interface checkOut: aCartId with: testObjectsFactory expiredCreditCard on: testObjectsFactory today ] on: Error do: [:anError | ].
				clock addToTime: 29*minute.
				interface listCart: aCartId ]
		raise: Error.
		
	! !

!methodRemoval: TusLibrosInterfaceTest #test20ShouldNotTimeOutWhen30MinutesHaveNotPassedFromLastOperation stamp: 'AM 11/30/2020 19:25:52'!
test20ShouldNotTimeOutWhen30MinutesHaveNotPassedFromLastOperation
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  TusLibrosInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 	
	
	self shouldnt: [ clock addToTime: 29*minute.
				interface listCart: aCartId .
				clock addToTime: 29*minute.
				interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
				clock addToTime: 29*minute.
				[ interface checkOut: aCartId with: testObjectsFactory expiredCreditCard on: testObjectsFactory today ] on: Error do: [:anError | ].
				clock addToTime: 29*minute.
				interface listCart: aCartId ]
		raise: Error.
		
	!
!StoreTestObjectsFactory methodsFor: 'tus libros interface' stamp: 'AM 11/30/2020 19:26:51' prior: 50873627!
tusLibrosInterface
	
	^ TusLibrosInterface with: self authenticationSystem 
					catalog: self defaultCatalog 
					through: self
					clock: self clockSimulator.
! !

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 19:26:53'!
PASSED!

!methodRemoval: TusLibrosInterface class #with:catalog:through: stamp: 'AM 11/30/2020 19:27:12'!
with: anAuthenticationSystem catalog: aCatalog through: aMerchantProcessor   

	^ self new initializeWith: anAuthenticationSystem catalog: aCatalog through: aMerchantProcessor clock: (ClockSimulator withTime: GregorianDateTime now).!

!testRun: #TusLibrosInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 19:27:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 19:27:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 19:27:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 19:27:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 19:27:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 19:27:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 19:27:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:27:16'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 19:27:17'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 19:27:17'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 19:27:17'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:27:17'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:27:17'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 19:27:17'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 19:27:17'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 19:27:17'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 19:27:17'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 19:27:17'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 19:27:17'!
PASSED!

!testRun: #TusLibrosInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 19:27:17'!
PASSED!

!classRenamed: #TusLibrosInterface as: #InternalRestInterface stamp: 'AM 11/30/2020 19:27:45'!
Smalltalk renameClassNamed: #TusLibrosInterface as: #InternalRestInterface!
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:27:46' prior: 50876327!
test20TimeOutTimeIsResetAfterAnyOperation
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 	
	
	self shouldnt: [ clock addToTime: 29*minute.
				interface listCart: aCartId .
				clock addToTime: 29*minute.
				interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
				clock addToTime: 29*minute.
				[ interface checkOut: aCartId with: testObjectsFactory expiredCreditCard on: testObjectsFactory today ] on: Error do: [:anError | ].
				clock addToTime: 29*minute.
				interface listCart: aCartId ]
		raise: Error.
		
	! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:27:46' prior: 50876393!
tusLibrosInterface
	
	^ InternalRestInterface with: self authenticationSystem 
					catalog: self defaultCatalog 
					through: self
					clock: self clockSimulator.
! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:27:46' prior: 50872977!
test09ShouldNotCheckOutAnAlreadyCheckedOutCart
	
	| interface aCartId |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	interface checkOut: aCartId with: testObjectsFactory notExpiredCreditCard on: testObjectsFactory today.
	
	self should: [ interface checkOut: aCartId with: testObjectsFactory notExpiredCreditCard on: testObjectsFactory today ]
	raise: Error
	withMessageText: InternalRestInterface invalidCartIdErrorDescription . 
	
	! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:27:46' prior: 50876154!
test18ShouldNotAddToTimedOutCart
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface listCart: aCartId  ]
	raise: Error
	withMessageText: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:27:47' prior: 50876010!
test17ShouldNotListWhenCartTimedOut
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore. ]
	raise: Error
	withMessageText: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:27:47' prior: 50872944!
test07AddingToInvalidCartIdShouldRaise
	
	| interface |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	self should: [ interface addToCart: 0 product: testObjectsFactory itemSellByTheStore ]
	raise: Error - MessageNotUnderstood 
	withMessageText: InternalRestInterface invalidCartIdErrorDescription .

	
	
	! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:27:47' prior: 50876101!
test19ShouldNotCheckOutATimedOutCart
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	clock addToTime: 30*minute.
	
	self should: [ interface checkOut: aCartId with: testObjectsFactory notExpiredCreditCard on: testObjectsFactory today ]
	raise: Error
	withMessageText: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!TusLibrosInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:27:47' prior: 50872932!
test06ListingCartShouldNotListOnInvalidCartId
	
	| interface |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	self should: [ interface listCart: 0 ]
	raise: Error - MessageNotUnderstood 
	withMessageText: InternalRestInterface invalidCartIdErrorDescription .

	
	
	! !

!classRenamed: #TusLibrosInterfaceTest as: #InternalRestInterfaceTest stamp: 'AM 11/30/2020 19:28:05'!
Smalltalk renameClassNamed: #TusLibrosInterfaceTest as: #InternalRestInterfaceTest!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 19:28:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 19:28:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 19:28:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 19:28:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 19:28:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 19:28:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 19:28:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:28:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 19:28:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 19:28:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 19:28:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:28:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:28:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 19:28:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 19:28:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 19:28:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 19:28:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 19:28:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 19:28:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 19:28:12'!
PASSED!
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:28:43' prior: 50875889!
listCart: aCartId 
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	^ (self cartAt: aCartId) listCart asBag.! !

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 19:28:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 19:28:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 19:28:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 19:28:44'!
ERROR!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 19:28:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 19:28:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 19:28:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:28:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 19:28:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 19:28:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 19:28:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:28:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:28:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 19:28:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 19:28:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 19:28:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 19:28:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 19:28:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 19:28:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 19:28:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 19:28:44'!
ERROR!
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 11/30/2020 19:29:53' prior: 50872885!
test04AddingToCartSuccessfullyAddsToOneCart
	
	| interface aCartId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword.
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore withOcurrences: 2.


	self assert: (interface listCart: aCartId ) equals: { testObjectsFactory itemSellByTheStore. 
												 testObjectsFactory itemSellByTheStore. 
												 testObjectsFactory itemSellByTheStore} asBag.
	
	
	
	! !

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 19:29:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 19:30:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 19:30:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 19:30:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 19:30:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 19:30:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 19:30:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 19:30:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:30:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 19:30:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 19:30:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 19:30:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:30:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:30:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 19:30:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 19:30:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 19:30:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 19:30:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 19:30:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 19:30:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 19:30:01'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 11/30/2020 19:30:37' prior: 50872909!
test05AddingToCartSuccessfullyAddsToManyCarts
	
	| interface fortCartId maradonaCartId |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	maradonaCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	fortCartId := interface createCartForUser: testObjectsFactory anotherValidUser password: testObjectsFactory anotherValidPassword .
	interface addToCart: maradonaCartId product: testObjectsFactory itemSellByTheStore .

	self assert: ( interface listCart: maradonaCartId ) equals: { testObjectsFactory itemSellByTheStore } asBag.
	self assert: ( ( interface listCart: fortCartId ) isEmpty ).

	
	
	! !

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 19:30:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 19:30:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 19:30:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 19:30:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 19:30:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 19:30:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 19:30:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 19:30:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:30:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 19:30:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 19:30:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 19:30:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:30:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:30:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 19:30:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 19:30:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 19:30:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 19:30:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 19:30:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 19:30:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 19:30:39'!
PASSED!
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:31:05'!
invalidCartId

	^ Object new.! !
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 11/30/2020 19:31:23' prior: 50876765!
test06ListingCartShouldNotListOnInvalidCartId
	
	| interface |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	self should: [ interface listCart: testObjectsFactory invalidCartId ]
	raise: Error - MessageNotUnderstood 
	withMessageText: InternalRestInterface invalidCartIdErrorDescription .

	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 11/30/2020 19:31:41' prior: 50876723!
test07AddingToInvalidCartIdShouldRaise
	
	| interface |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	self should: [ interface addToCart: testObjectsFactory invalidCartId product: testObjectsFactory itemSellByTheStore ]
	raise: Error - MessageNotUnderstood 
	withMessageText: InternalRestInterface invalidCartIdErrorDescription .

	
	
	! !
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:32:37' prior: 50876858!
listCart: aCartId 
	
	self assertThatCartIdIsValid: aCartId.
	"self assertThatCartHasNotTimedOut: aCartId."
	
	self updateLastUseOf: aCartId.
	
	^ (self cartAt: aCartId) listCart asBag.! !

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 19:32:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 19:32:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 19:32:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 19:32:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 19:32:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 19:32:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 19:32:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:32:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 19:32:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 19:32:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 19:32:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:32:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:32:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 19:32:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 19:32:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 19:32:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 19:32:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 19:32:39'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 19:32:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 19:32:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 19:32:39'!
FAILURE!
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:32:47' prior: 50877187!
listCart: aCartId 
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	^ (self cartAt: aCartId) listCart asBag.! !
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:32:51' prior: 50877275!
listCart: aCartId 
	
	"self assertThatCartIdIsValid: aCartId."
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	^ (self cartAt: aCartId) listCart asBag.! !

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 19:32:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 19:32:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 19:32:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 19:32:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 19:32:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 19:32:52'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 19:32:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:32:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 19:32:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 19:32:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 19:32:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:32:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:32:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 19:32:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 19:32:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 19:32:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 19:32:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 19:32:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 19:32:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 19:32:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 19:32:52'!
FAILURE!
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:32:58' prior: 50877285!
listCart: aCartId 
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	^ (self cartAt: aCartId) listCart asBag.! !
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:33:05' prior: 50875898!
addToCart: aCartId product: aProduct withOcurrences: aNumberOfOccurrences 
	
	"self assertThatCartIdIsValid: aCartId."
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.

	(self cartAt: aCartId) add: aNumberOfOccurrences of: aProduct! !

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 19:33:06'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 19:33:06'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 19:33:06'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 19:33:06'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 19:33:06'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 19:33:06'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 19:33:06'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:33:06'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 19:33:06'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 19:33:06'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 19:33:06'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:33:06'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:33:06'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 19:33:06'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 19:33:06'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 19:33:06'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 19:33:06'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 19:33:06'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 19:33:06'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 19:33:06'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 19:33:06'!
FAILURE!
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:33:12' prior: 50877384!
addToCart: aCartId product: aProduct withOcurrences: aNumberOfOccurrences 
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.

	(self cartAt: aCartId) add: aNumberOfOccurrences of: aProduct! !
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:33:19' prior: 50875854!
checkOut: aCartId with: aCreditCard on: aDate 
	
	| total |
	
	"self assertThatCartIdIsValid: aCartId."
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.

	total := ( Cashier toCheckout: (self cartAt: aCartId) 
		charging: aCreditCard 
		throught: merchantProcessor 
		on: aDate 
		registeringOn: ( salesBooks at: ( self clientUsingCart: aCartId ) ) )
		checkOut .
			
	carts removeKey: aCartId .
	clientByCart removeKey: aCartId .
	
	^ total.
! !

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 19:33:21'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 19:33:21'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 19:33:21'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 19:33:21'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 19:33:21'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 19:33:21'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 19:33:21'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:33:21'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 19:33:21'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 19:33:21'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 19:33:21'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:33:21'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:33:21'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 19:33:21'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 19:33:21'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 19:33:21'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 19:33:21'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 19:33:21'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 19:33:21'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 19:33:21'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 19:33:21'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 19:33:51'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 19:33:51'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 19:33:51'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 19:33:51'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 19:33:51'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 19:33:51'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 19:33:51'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:33:51'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 19:33:51'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 19:33:51'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 19:33:51'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:33:51'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:33:51'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 19:33:51'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 19:33:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 19:33:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 19:33:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 19:33:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 19:33:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 19:33:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 19:33:52'!
FAILURE!
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:35:31' prior: 50877487!
checkOut: aCartId with: aCreditCard on: aDate 
	
	| total |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.

	total := ( Cashier toCheckout: (self cartAt: aCartId) 
		charging: aCreditCard 
		throught: merchantProcessor 
		on: aDate 
		registeringOn: ( salesBooks at: ( self clientUsingCart: aCartId ) ) )
		checkOut .
			
	carts removeKey: aCartId .
	clientByCart removeKey: aCartId .
	
	^ total.
! !
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:40:42'!
checkOut: aCartId withCCN: aCreditCard on: aDate 
	
	| total |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.

	total := ( Cashier toCheckout: (self cartAt: aCartId) 
		charging: aCreditCard 
		throught: merchantProcessor 
		on: aDate 
		registeringOn: ( salesBooks at: ( self clientUsingCart: aCartId ) ) )
		checkOut .
			
	carts removeKey: aCartId .
	clientByCart removeKey: aCartId .
	
	^ total.
! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:40:42' prior: 50876651!
test09ShouldNotCheckOutAnAlreadyCheckedOutCart
	
	| interface aCartId |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard on: testObjectsFactory today.
	
	self should: [ interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard on: testObjectsFactory today ]
	raise: Error
	withMessageText: InternalRestInterface invalidCartIdErrorDescription . 
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:40:42' prior: 50876737!
test19ShouldNotCheckOutATimedOutCart
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	clock addToTime: 30*minute.
	
	self should: [ interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard on: testObjectsFactory today ]
	raise: Error
	withMessageText: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:40:42' prior: 50876610!
test20TimeOutTimeIsResetAfterAnyOperation
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 	
	
	self shouldnt: [ clock addToTime: 29*minute.
				interface listCart: aCartId .
				clock addToTime: 29*minute.
				interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
				clock addToTime: 29*minute.
				[ interface checkOut: aCartId withCCN: testObjectsFactory expiredCreditCard on: testObjectsFactory today ] on: Error do: [:anError | ].
				clock addToTime: 29*minute.
				interface listCart: aCartId ]
		raise: Error.
		
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:40:43' prior: 50873122!
test13ListMoreThanOnePurchaseSuccessfully
	
	| interface aCartId purchases |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	2 timesRepeat: [ 
		aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
		interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
		interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard on: testObjectsFactory today 
		].
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice * 2 equals: purchases total.
	self assert: ( purchases products hasEqualElements: { testObjectsFactory itemSellByTheStore. testObjectsFactory itemSellByTheStore } ) .
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:40:43' prior: 50873772!
test14ListPurchasesFromMoreThanOneUser
	
	| interface aCartId purchases |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard on: testObjectsFactory today.
	
	aCartId := interface createCartForUser: testObjectsFactory anotherValidUser password: testObjectsFactory anotherValidPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard on: testObjectsFactory today.
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice equals: purchases total.
	self assert: ( purchases products hasEqualElements: {testObjectsFactory itemSellByTheStore } ) .
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:40:43' prior: 50873000!
test10FailedCheckOutShouldNotInvalidateFutureCheckOut
	
	| interface aCartId total |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .

	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	[ interface checkOut: aCartId withCCN: testObjectsFactory expiredCreditCard on: testObjectsFactory today. ] on: Error do: [:anError | ].

	total := interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard on: testObjectsFactory today.
	
	self assert: total equals: testObjectsFactory itemSellByTheStorePrice .
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:40:43' prior: 50873096!
test12ListOnePurchaseSuccessfully
	
	| interface aCartId purchases |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard on: testObjectsFactory today.
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: purchases total equals: testObjectsFactory itemSellByTheStorePrice .
	self assert: ( purchases products hasEqualElements: {testObjectsFactory itemSellByTheStore } ) .
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:40:43' prior: 50872957!
test08CheckOutSuccessfullyChecksOutOneCart
	
	| interface aCartId total |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	total := interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard on: testObjectsFactory today.
	
	self assert: total equals: testObjectsFactory itemSellByTheStorePrice .
	
	! !

!methodRemoval: InternalRestInterface #checkOut:with:on: stamp: 'AM 11/30/2020 19:40:44'!
checkOut: aCartId with: aCreditCard on: aDate 
	
	| total |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.

	total := ( Cashier toCheckout: (self cartAt: aCartId) 
		charging: aCreditCard 
		throught: merchantProcessor 
		on: aDate 
		registeringOn: ( salesBooks at: ( self clientUsingCart: aCartId ) ) )
		checkOut .
			
	carts removeKey: aCartId .
	clientByCart removeKey: aCartId .
	
	^ total.
!
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:42:30'!
checkOut: aCartId withCCN: aCreditCard CCED: anExpirationDate on: aDate 
	
	| total |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.

	total := ( Cashier toCheckout: (self cartAt: aCartId) 
		charging: aCreditCard 
		throught: merchantProcessor 
		on: aDate 
		registeringOn: ( salesBooks at: ( self clientUsingCart: aCartId ) ) )
		checkOut .
			
	carts removeKey: aCartId .
	clientByCart removeKey: aCartId .
	
	^ total.
! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:42:30' prior: 50877753!
test20TimeOutTimeIsResetAfterAnyOperation
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 	
	
	self shouldnt: [ clock addToTime: 29*minute.
				interface listCart: aCartId .
				clock addToTime: 29*minute.
				interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
				clock addToTime: 29*minute.
				[ interface checkOut: aCartId withCCN: testObjectsFactory expiredCreditCard CCED: testObjectFactory futureExpirationDate on: testObjectsFactory today ] on: Error do: [:anError | ].
				clock addToTime: 29*minute.
				interface listCart: aCartId ]
		raise: Error.
		
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:42:30' prior: 50877903!
test08CheckOutSuccessfullyChecksOutOneCart
	
	| interface aCartId total |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	total := interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectFactory futureExpirationDate on: testObjectsFactory today.
	
	self assert: total equals: testObjectsFactory itemSellByTheStorePrice .
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:42:30' prior: 50877785!
test13ListMoreThanOnePurchaseSuccessfully
	
	| interface aCartId purchases |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	2 timesRepeat: [ 
		aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
		interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
		interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectFactory futureExpirationDate on: testObjectsFactory today 
		].
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice * 2 equals: purchases total.
	self assert: ( purchases products hasEqualElements: { testObjectsFactory itemSellByTheStore. testObjectsFactory itemSellByTheStore } ) .
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:42:30' prior: 50877701!
test09ShouldNotCheckOutAnAlreadyCheckedOutCart
	
	| interface aCartId |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectFactory futureExpirationDate on: testObjectsFactory today.
	
	self should: [ interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectFactory futureExpirationDate on: testObjectsFactory today ]
	raise: Error
	withMessageText: InternalRestInterface invalidCartIdErrorDescription . 
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:42:31' prior: 50877725!
test19ShouldNotCheckOutATimedOutCart
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	clock addToTime: 30*minute.
	
	self should: [ interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectFactory futureExpirationDate on: testObjectsFactory today ]
	raise: Error
	withMessageText: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:42:31' prior: 50877876!
test12ListOnePurchaseSuccessfully
	
	| interface aCartId purchases |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectFactory futureExpirationDate on: testObjectsFactory today.
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: purchases total equals: testObjectsFactory itemSellByTheStorePrice .
	self assert: ( purchases products hasEqualElements: {testObjectsFactory itemSellByTheStore } ) .
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:42:31' prior: 50877814!
test14ListPurchasesFromMoreThanOneUser
	
	| interface aCartId purchases |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectFactory futureExpirationDate on: testObjectsFactory today.
	
	aCartId := interface createCartForUser: testObjectsFactory anotherValidUser password: testObjectsFactory anotherValidPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectFactory futureExpirationDate on: testObjectsFactory today.
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice equals: purchases total.
	self assert: ( purchases products hasEqualElements: {testObjectsFactory itemSellByTheStore } ) .
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:42:31' prior: 50877851!
test10FailedCheckOutShouldNotInvalidateFutureCheckOut
	
	| interface aCartId total |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .

	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	[ interface checkOut: aCartId withCCN: testObjectsFactory expiredCreditCard CCED: testObjectFactory futureExpirationDate on: testObjectsFactory today. ] on: Error do: [:anError | ].

	total := interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectFactory futureExpirationDate on: testObjectsFactory today.
	
	self assert: total equals: testObjectsFactory itemSellByTheStorePrice .
	
	! !

!methodRemoval: InternalRestInterface #checkOut:withCCN:on: stamp: 'AM 11/30/2020 19:42:31'!
checkOut: aCartId withCCN: aCreditCard on: aDate 
	
	| total |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.

	total := ( Cashier toCheckout: (self cartAt: aCartId) 
		charging: aCreditCard 
		throught: merchantProcessor 
		on: aDate 
		registeringOn: ( salesBooks at: ( self clientUsingCart: aCartId ) ) )
		checkOut .
			
	carts removeKey: aCartId .
	clientByCart removeKey: aCartId .
	
	^ total.
!
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:43:24'!
checkOut: aCartId withCCN: aCreditCard CCED: anExpirationDate CCO: anOwner on: aDate 
	
	| total |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.

	total := ( Cashier toCheckout: (self cartAt: aCartId) 
		charging: aCreditCard 
		throught: merchantProcessor 
		on: aDate 
		registeringOn: ( salesBooks at: ( self clientUsingCart: aCartId ) ) )
		checkOut .
			
	carts removeKey: aCartId .
	clientByCart removeKey: aCartId .
	
	^ total.
! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:43:24' prior: 50878074!
test19ShouldNotCheckOutATimedOutCart
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	clock addToTime: 30*minute.
	
	self should: [ interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectFactory futureExpirationDate CCO: testObjectFactory validOwner on: testObjectsFactory today ]
	raise: Error
	withMessageText: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:43:24' prior: 50878104!
test12ListOnePurchaseSuccessfully
	
	| interface aCartId purchases |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectFactory futureExpirationDate CCO: testObjectFactory validOwner on: testObjectsFactory today.
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: purchases total equals: testObjectsFactory itemSellByTheStorePrice .
	self assert: ( purchases products hasEqualElements: {testObjectsFactory itemSellByTheStore } ) .
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:43:24' prior: 50878016!
test13ListMoreThanOnePurchaseSuccessfully
	
	| interface aCartId purchases |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	2 timesRepeat: [ 
		aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
		interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
		interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectFactory futureExpirationDate CCO: testObjectFactory validOwner on: testObjectsFactory today 
		].
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice * 2 equals: purchases total.
	self assert: ( purchases products hasEqualElements: { testObjectsFactory itemSellByTheStore. testObjectsFactory itemSellByTheStore } ) .
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:43:24' prior: 50877994!
test08CheckOutSuccessfullyChecksOutOneCart
	
	| interface aCartId total |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	total := interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectFactory futureExpirationDate CCO: testObjectFactory validOwner on: testObjectsFactory today.
	
	self assert: total equals: testObjectsFactory itemSellByTheStorePrice .
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:43:24' prior: 50878132!
test14ListPurchasesFromMoreThanOneUser
	
	| interface aCartId purchases |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectFactory futureExpirationDate CCO: testObjectFactory validOwner on: testObjectsFactory today.
	
	aCartId := interface createCartForUser: testObjectsFactory anotherValidUser password: testObjectsFactory anotherValidPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectFactory futureExpirationDate CCO: testObjectFactory validOwner on: testObjectsFactory today.
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice equals: purchases total.
	self assert: ( purchases products hasEqualElements: {testObjectsFactory itemSellByTheStore } ) .
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:43:24' prior: 50877960!
test20TimeOutTimeIsResetAfterAnyOperation
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 	
	
	self shouldnt: [ clock addToTime: 29*minute.
				interface listCart: aCartId .
				clock addToTime: 29*minute.
				interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
				clock addToTime: 29*minute.
				[ interface checkOut: aCartId withCCN: testObjectsFactory expiredCreditCard CCED: testObjectFactory futureExpirationDate CCO: testObjectFactory validOwner on: testObjectsFactory today ] on: Error do: [:anError | ].
				clock addToTime: 29*minute.
				interface listCart: aCartId ]
		raise: Error.
		
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:43:25' prior: 50878172!
test10FailedCheckOutShouldNotInvalidateFutureCheckOut
	
	| interface aCartId total |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .

	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	[ interface checkOut: aCartId withCCN: testObjectsFactory expiredCreditCard CCED: testObjectFactory futureExpirationDate CCO: testObjectFactory validOwner on: testObjectsFactory today. ] on: Error do: [:anError | ].

	total := interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectFactory futureExpirationDate CCO: testObjectFactory validOwner on: testObjectsFactory today.
	
	self assert: total equals: testObjectsFactory itemSellByTheStorePrice .
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:43:25' prior: 50878047!
test09ShouldNotCheckOutAnAlreadyCheckedOutCart
	
	| interface aCartId |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectFactory futureExpirationDate CCO: testObjectFactory validOwner on: testObjectsFactory today.
	
	self should: [ interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectFactory futureExpirationDate CCO: testObjectFactory validOwner on: testObjectsFactory today ]
	raise: Error
	withMessageText: InternalRestInterface invalidCartIdErrorDescription . 
	
	! !

!methodRemoval: InternalRestInterface #checkOut:withCCN:CCED:on: stamp: 'AM 11/30/2020 19:43:25'!
checkOut: aCartId withCCN: aCreditCard CCED: anExpirationDate on: aDate 
	
	| total |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.

	total := ( Cashier toCheckout: (self cartAt: aCartId) 
		charging: aCreditCard 
		throught: merchantProcessor 
		on: aDate 
		registeringOn: ( salesBooks at: ( self clientUsingCart: aCartId ) ) )
		checkOut .
			
	carts removeKey: aCartId .
	clientByCart removeKey: aCartId .
	
	^ total.
!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 19:43:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 19:43:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 19:43:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 19:43:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 19:43:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 19:43:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 19:43:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:43:40'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 19:43:40'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 19:43:40'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 19:43:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:43:40'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:43:40'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 19:43:40'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 19:43:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 19:43:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 19:43:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 19:43:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 19:43:40'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 19:43:40'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:43:44'!
ERROR!
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 11/30/2020 19:44:14' prior: 50878329!
test08CheckOutSuccessfullyChecksOutOneCart
	
	| interface aCartId total |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	total := interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	
	self assert: total equals: testObjectsFactory itemSellByTheStorePrice .
	
	! !

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:44:16'!
ERROR!
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'AM 11/30/2020 19:44:32'!
futureExpirationDate
	self shouldBeImplemented.! !

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:44:36'!
ERROR!
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'AM 11/30/2020 19:45:00' prior: 50878612!
futureExpirationDate
	
	^ (Month month: today monthIndex year: today yearNumber + 1)! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'AM 11/30/2020 19:45:04' prior: 50878621!
futureExpirationDate
	
	^ Month month: today monthIndex year: today yearNumber + 1! !

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:45:09'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 19:45:09'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 19:45:09'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:45:09'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:45:09'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 19:45:09'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 19:45:09'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 19:45:09'!
FAILURE!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 19:45:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:45:12'!
ERROR!
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'AM 11/30/2020 19:45:25'!
validOwner
	self shouldBeImplemented.! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'AM 11/30/2020 19:45:36' prior: 50878757!
validOwner
	
	^ 'Maradona'! !

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:45:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 19:45:46'!
ERROR!
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 11/30/2020 19:46:05' prior: 50878459!
test09ShouldNotCheckOutAnAlreadyCheckedOutCart
	
	| interface aCartId |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	
	self should: [ interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today ]
	raise: Error
	withMessageText: InternalRestInterface invalidCartIdErrorDescription . 
	
	! !

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 19:46:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 19:46:09'!
ERROR!
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 11/30/2020 19:46:26' prior: 50878429!
test10FailedCheckOutShouldNotInvalidateFutureCheckOut
	
	| interface aCartId total |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .

	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	[ interface checkOut: aCartId withCCN: testObjectsFactory expiredCreditCard CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today. ] on: Error do: [:anError | ].

	total := interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	
	self assert: total equals: testObjectsFactory itemSellByTheStorePrice .
	
	! !

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 19:46:27'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:46:28'!
ERROR!
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 11/30/2020 19:46:51' prior: 50878268!
test12ListOnePurchaseSuccessfully
	
	| interface aCartId purchases |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: purchases total equals: testObjectsFactory itemSellByTheStorePrice .
	self assert: ( purchases products hasEqualElements: {testObjectsFactory itemSellByTheStore } ) .
	
	! !

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:46:53'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:46:54'!
ERROR!
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 11/30/2020 19:47:04' prior: 50878297!
test13ListMoreThanOnePurchaseSuccessfully
	
	| interface aCartId purchases |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	2 timesRepeat: [ 
		aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
		interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
		interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today 
		].
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice * 2 equals: purchases total.
	self assert: ( purchases products hasEqualElements: { testObjectsFactory itemSellByTheStore. testObjectsFactory itemSellByTheStore } ) .
	
	! !

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:47:06'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 11/30/2020 19:47:20' prior: 50878352!
test14ListPurchasesFromMoreThanOneUser
	
	| interface aCartId purchases |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	
	aCartId := interface createCartForUser: testObjectsFactory anotherValidUser password: testObjectsFactory anotherValidPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice equals: purchases total.
	self assert: ( purchases products hasEqualElements: {testObjectsFactory itemSellByTheStore } ) .
	
	! !

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 19:47:21'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 11/30/2020 19:47:28' prior: 50878237!
test19ShouldNotCheckOutATimedOutCart
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	clock addToTime: 30*minute.
	
	self should: [ interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today ]
	raise: Error
	withMessageText: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 19:47:29'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 11/30/2020 19:49:11' prior: 50878394!
test20TimeOutTimeIsResetAfterAnyOperation
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 	
	
	self shouldnt: [ clock addToTime: 29*minute.
				interface listCart: aCartId .
				clock addToTime: 29*minute.
				interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
				clock addToTime: 29*minute.
				[ interface checkOut: aCartId withCCN: testObjectsFactory expiredCreditCard CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today ] on: Error do: [:anError | ].
				clock addToTime: 29*minute.
				interface listCart: aCartId ]
		raise: Error.
		
	! !

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 19:49:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 19:49:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 19:49:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 19:49:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 19:49:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 19:49:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 19:49:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 19:49:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:49:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 19:49:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 19:49:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 19:49:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:49:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:49:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 19:49:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 19:49:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 19:49:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 19:49:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 19:49:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 19:49:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 19:49:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 19:49:15'!
PASSED!
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 19:52:33' prior: 50878217!
checkOut: aCartId withCCN: aCreditCardNumber CCED: anExpirationDate CCO: anOwner on: aDate 
	
	| total |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.

	total := ( Cashier toCheckout: (self cartAt: aCartId) 
		charging: aCreditCardNumber 
		throught: merchantProcessor 
		on: aDate 
		registeringOn: ( salesBooks at: ( self clientUsingCart: aCartId ) ) )
		checkOut .
			
	carts removeKey: aCartId .
	clientByCart removeKey: aCartId .
	
	^ total.
! !
!ClockSimulator methodsFor: 'time operations' stamp: 'AM 11/30/2020 19:57:09'!
now

	^ time 
	
	! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:57:09' prior: 50874305!
hasTimedOut: aCartId
	
	^ 30*minute <= ((self lastTimeFor: aCartId) distanceTo: clock now).! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 19:57:10' prior: 50875848!
updateLastUseOf: aCartId

	lastTime at: aCartId put: clock now.
! !

!methodRemoval: ClockSimulator #time stamp: 'AM 11/30/2020 19:57:10'!
time

	^ time 
	
	!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 19:57:16'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 19:57:16'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 19:57:16'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 19:57:16'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 19:57:16'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 19:57:16'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 19:57:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:57:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 19:57:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 19:57:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 19:57:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:57:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:57:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 19:57:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 19:57:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 19:57:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 19:57:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 19:57:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 19:57:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 19:57:17'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 19:57:20'!
PASSED!

!methodRemoval: InternalRestInterface #initializeWith:catalog:through: stamp: 'AM 11/30/2020 20:04:12'!
initializeWith: anAuthenticationSystem catalog: aCatalog through: aMerchantProcessor 

	authenticationSystem := anAuthenticationSystem .
	catalog := aCatalog .
	carts := Dictionary new.
	nextCartId := 0.
	merchantProcessor := aMerchantProcessor .
	salesBooks := Dictionary new.
	clientByCart := Dictionary new.
!

!classDefinition: #CreditCardTest category: 'TusLibros' stamp: 'AM 11/30/2020 20:09:05'!
TestCase subclass: #CreditCardTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CreditCardTest methodsFor: 'nil' stamp: 'AM 11/30/2020 20:09:04' overrides: 16927572!
setUp

	testObjectsFactory := StoreTestObjectsFactory new.
	

	! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 20:11:12'!
test01CardNumberShouldNotHaveLessThan16Digits

	| invalidCardId |
	
	invalidCardId := 10 ^ 15 - 1.
	
	self should: [ CreditCard withNumber: invalidCardId 
						expirationDate: testObjectsFactory futureExpirationDate
						owner: testObjectsFactory validOwner ]
	raise: Error
	withMessageText: CreditCard invalidCardNumberErrorDescription .
	

	! !

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:11:24'!
ERROR!
!CreditCard class methodsFor: 'error descriptions' stamp: 'AM 11/30/2020 20:13:22'!
invalidCardNumberErrorDescription
	self shouldBeImplemented.! !
!CreditCard class methodsFor: 'error descriptions' stamp: 'AM 11/30/2020 20:13:51' prior: 50879399!
invalidCardNumberErrorDescription
	
	^ 'Credit card number must have exactly 16 digits' .! !

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:13:52'!
FAILURE!
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 20:14:10' prior: 50879381!
test01CardNumberShouldNotHaveLessThan16Digits

	| invalidCardId |
	
	invalidCardId := 10 ^ 15 - 1.
	
	self should: [ CreditCard withNumber: invalidCardId 
						expirationDate: testObjectsFactory futureExpirationDate
						owner: testObjectsFactory validOwner ]
	raise: Error - MessageNotUnderstood
	withMessageText: CreditCard invalidCardNumberErrorDescription .
	

	! !

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:14:12'!
ERROR!
!CreditCard class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 20:14:19'!
withNumber: aSmallInteger expirationDate: aMonth owner: aString 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeWithNumber: aSmallInteger expirationDate: aMonth owner: aString ! !
!CreditCard class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 20:15:07' prior: 50879433!
withNumber: aNumber expirationDate: aMonthOfYear owner: aPerson 
	
	^self new initializeWithNumber: aNumber expirationDate: aMonthOfYear owner: aPerson ! !

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:15:10'!
ERROR!

!classDefinition: #CreditCard category: 'TusLibros' stamp: 'AM 11/30/2020 20:15:24'!
Object subclass: #CreditCard
	instanceVariableNames: 'expiration number'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CreditCard category: 'TusLibros' stamp: 'AM 11/30/2020 20:15:24'!
Object subclass: #CreditCard
	instanceVariableNames: 'expiration number monthOfYear'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CreditCard category: 'TusLibros' stamp: 'AM 11/30/2020 20:15:24'!
Object subclass: #CreditCard
	instanceVariableNames: 'expiration number monthOfYear person'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CreditCard methodsFor: 'initialization' stamp: 'AM 11/30/2020 20:15:24'!
initializeWithNumber: aNumber expirationDate: aMonthOfYear owner: aPerson 
	self shouldBeImplemented.
	number := aNumber.
	monthOfYear := aMonthOfYear.
	person := aPerson.! !
!CreditCard methodsFor: 'initialization' stamp: 'AM 11/30/2020 20:15:32' prior: 50879478!
initializeWithNumber: aNumber expirationDate: aMonthOfYear owner: aPerson 
	
	number := aNumber.
	monthOfYear := aMonthOfYear.
	person := aPerson.! !

!classDefinition: #CreditCard category: 'TusLibros' stamp: 'AM 11/30/2020 20:15:38'!
Object subclass: #CreditCard
	instanceVariableNames: 'expiration number expirationDate person'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CreditCard methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 20:15:38' prior: 50879487!
initializeWithNumber: aNumber expirationDate: aMonthOfYear owner: aPerson 
	
	number := aNumber.
	expirationDate := aMonthOfYear.
	person := aPerson.! !

!classDefinition: #CreditCard category: 'TusLibros' stamp: 'AM 11/30/2020 20:15:41'!
Object subclass: #CreditCard
	instanceVariableNames: 'expiration number expirationDate owner'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CreditCard methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 20:15:41' prior: 50879503!
initializeWithNumber: aNumber expirationDate: aMonthOfYear owner: aPerson 
	
	number := aNumber.
	expirationDate := aMonthOfYear.
	owner := aPerson.! !

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:15:44'!
FAILURE!
!CreditCard class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 20:16:52' prior: 50879444!
withNumber: aNumber expirationDate: aMonthOfYear owner: aPerson 
	
	aNumber < 10^15 ifTrue: [ self error: self invalidCardNumberErrorDescription ].
	^self new initializeWithNumber: aNumber expirationDate: aMonthOfYear owner: aPerson ! !

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:16:54'!
ERROR!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:16:54'!
ERROR!
!CreditCard class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 20:17:01' prior: 50879531!
withNumber: aNumber expirationDate: aMonthOfYear owner: aPerson 
	
	aNumber < 10^15 ifTrue: [ self error: self invalidCardNumberErrorDescription ].
	^ self new initializeWithNumber: aNumber expirationDate: aMonthOfYear owner: aPerson ! !
!CreditCard class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 20:17:13' prior: 50879549!
withNumber: aNumber expirationDate: aMonthOfYear owner: aPerson 
	
	aNumber < (10^15) ifTrue: [ self error: self invalidCardNumberErrorDescription ].
	^ self new initializeWithNumber: aNumber expirationDate: aMonthOfYear owner: aPerson ! !

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:17:14'!
PASSED!
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 20:18:13'!
test02CardNumberShouldNotHaveMoreThan16Digits

	| invalidCardId |
	
	invalidCardId := 10 ^ 16.
	
	self should: [ CreditCard withNumber: invalidCardId 
						expirationDate: testObjectsFactory futureExpirationDate
						owner: testObjectsFactory validOwner ]
	raise: Error - MessageNotUnderstood
	withMessageText: CreditCard invalidCardNumberErrorDescription .
	

	! !

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:18:14'!
FAILURE!
!CreditCard class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 20:18:49' prior: 50879560!
withNumber: aNumber expirationDate: aMonthOfYear owner: aPerson 
	
	(aNumber between: 10^15 and: 10^16-1) ifTrue: [ self error: self invalidCardNumberErrorDescription ].
	^ self new initializeWithNumber: aNumber expirationDate: aMonthOfYear owner: aPerson ! !

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:18:51'!
FAILURE!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:18:51'!
FAILURE!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:18:55'!
FAILURE!
!CreditCard class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 20:19:03' prior: 50879593!
withNumber: aNumber expirationDate: aMonthOfYear owner: aPerson 
	
	(aNumber between: 10^15 and: 10^16-1) ifFalse: [ self error: self invalidCardNumberErrorDescription ].
	^ self new initializeWithNumber: aNumber expirationDate: aMonthOfYear owner: aPerson ! !

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:19:04'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:19:04'!
PASSED!
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 20:19:37'!
test03CardNumberShouldBeAnInteger

	| invalidCardId |
	
	invalidCardId := 0.5.
	
	self should: [ CreditCard withNumber: invalidCardId 
						expirationDate: testObjectsFactory futureExpirationDate
						owner: testObjectsFactory validOwner ]
	raise: Error - MessageNotUnderstood
	withMessageText: CreditCard invalidCardNumberErrorDescription .
	

	! !
!CreditCard class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 20:20:00' prior: 50879616!
withNumber: aNumber expirationDate: aMonthOfYear owner: aPerson 
	
	((aNumber between: 10^15 and: 10^16-1) and: [aNumber isInteger] )ifFalse: [ self error: self invalidCardNumberErrorDescription ].
	^ self new initializeWithNumber: aNumber expirationDate: aMonthOfYear owner: aPerson ! !

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:20:02'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:20:02'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:20:02'!
PASSED!
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 20:20:42' prior: 50879634!
test03CardNumberShouldBeAnInteger

	| aDayInAMonthOfAnYear |
	
	aDayInAMonthOfAnYear := January/01/2021.
	
	self should: [ CreditCard withNumber: testObjectsFactory validCardId
						expirationDate: aDayInAMonthOfAnYear
						owner: testObjectsFactory validOwner ]
	raise: Error - MessageNotUnderstood
	withMessageText: CreditCard invalidCardNumberErrorDescription .
	

	! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 20:21:01' prior: 50879672!
test03CardNumberShouldBeAnInteger

	| aDayInAMonthOfAnYear |
	
	aDayInAMonthOfAnYear := January/01/2021.
	
	self should: [ CreditCard withNumber: testObjectsFactory validCardId
						expirationDate: aDayInAMonthOfAnYear
						owner: testObjectsFactory validOwner ]
	raise: Error - MessageNotUnderstood
	withMessageText: CreditCard invalidExpirationDateErrorDescription .
	

	! !

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:21:03'!
ERROR!
!CreditCard class methodsFor: 'error descriptions' stamp: 'AM 11/30/2020 20:21:13'!
invalidExpirationDateErrorDescription
	self shouldBeImplemented.! !
!CreditCard class methodsFor: 'error descriptions' stamp: 'AM 11/30/2020 20:21:25' prior: 50879705!
invalidExpirationDateErrorDescription
	
	^ 'Expiration date must be a moth of year' .! !

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:21:26'!
ERROR!
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'AM 11/30/2020 20:21:34'!
validCardId
	self shouldBeImplemented.! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'AM 11/30/2020 20:21:45' prior: 50879720!
validCardId
	
	^ 4 * 10^15! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'AM 11/30/2020 20:21:54' prior: 50879725!
validCardId
	
	^ 10^15 * 4! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:21:56'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:21:56'!
FAILURE!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:21:56'!
FAILURE!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:22:01'!
FAILURE!
!CreditCard class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 20:22:20' prior: 50879649!
withNumber: aNumber expirationDate: aMonthOfYear owner: aPerson 
	
	((aNumber between: 10^15 and: 10^16-1) and: [aNumber isInteger] )ifFalse: [ self error: self invalidCardNumberErrorDescription ].
	( aMonthOfYear isKindOf: GregorianMonthOfYear ) ifFalse: [ self error: self invalidExpirationDateErrorDescription ] .
	
	
	^ self new initializeWithNumber: aNumber expirationDate: aMonthOfYear owner: aPerson ! !

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:22:22'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:22:22'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:22:22'!
PASSED!
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 20:19:37' prior: 50879687!
test03CardNumberShouldBeAnInteger

	| invalidCardId |
	
	invalidCardId := 0.5.
	
	self should: [ CreditCard withNumber: invalidCardId 
						expirationDate: testObjectsFactory futureExpirationDate
						owner: testObjectsFactory validOwner ]
	raise: Error - MessageNotUnderstood
	withMessageText: CreditCard invalidCardNumberErrorDescription .
	

	! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 20:23:17'!
test04CardExpirationDateShouldBeAMonthOfAnYear

	| aDayInAMonthOfAnYear |
	
	aDayInAMonthOfAnYear := January/01/2021.
	
	self should: [ CreditCard withNumber: testObjectsFactory validCardId
						expirationDate: aDayInAMonthOfAnYear
						owner: testObjectsFactory validOwner ]
	raise: Error - MessageNotUnderstood
	withMessageText: CreditCard invalidExpirationDateErrorDescription .
	! !

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:23:19'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:23:19'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:23:19'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:23:19'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:23:19'!
PASSED!
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 20:24:03'!
test05OwnerNameShouldNotBeEmpty

	| aDayInAMonthOfAnYear |
	
	aDayInAMonthOfAnYear := January/01/2021.
	
	self should: [ CreditCard withNumber: testObjectsFactory validCardId
						expirationDate: testObjectsFactory futureExpirationDate 
						owner: '' ]
	raise: Error - MessageNotUnderstood
	withMessageText: CreditCard invalidExpirationDateErrorDescription .
	! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 20:24:13' prior: 50879946!
test05OwnerNameShouldNotBeEmpty
	
	self should: [ CreditCard withNumber: testObjectsFactory validCardId
						expirationDate: testObjectsFactory futureExpirationDate 
						owner: '' ]
	raise: Error - MessageNotUnderstood
	withMessageText: CreditCard invalidExpirationDateErrorDescription .
	! !

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:24:15'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:24:15'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:24:15'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:24:15'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:24:15'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:24:15'!
PASSED!
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 20:24:21' prior: 50879574!
test02CardNumberShouldNotHaveMoreThan16Digits

	| invalidCardId |
	
	invalidCardId := 10 ^ 16.
	
	self should: [ CreditCard withNumber: invalidCardId 
						expirationDate: testObjectsFactory futureExpirationDate
						owner: testObjectsFactory validOwner ]
	raise: Error
	withMessageText: CreditCard invalidCardNumberErrorDescription .
	

	! !

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:24:22'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:24:22'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:24:22'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:24:22'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:24:22'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:24:22'!
PASSED!
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 20:24:28' prior: 50879899!
test03CardNumberShouldBeAnInteger

	| invalidCardId |
	
	invalidCardId := 0.5.
	
	self should: [ CreditCard withNumber: invalidCardId 
						expirationDate: testObjectsFactory futureExpirationDate
						owner: testObjectsFactory validOwner ]
	raise: Error
	withMessageText: CreditCard invalidCardNumberErrorDescription .
	

	! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 20:24:33' prior: 50879913!
test04CardExpirationDateShouldBeAMonthOfAnYear

	| aDayInAMonthOfAnYear |
	
	aDayInAMonthOfAnYear := January/01/2021.
	
	self should: [ CreditCard withNumber: testObjectsFactory validCardId
						expirationDate: aDayInAMonthOfAnYear
						owner: testObjectsFactory validOwner ]
	raise: Error
	withMessageText: CreditCard invalidExpirationDateErrorDescription .
	! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 20:24:37' prior: 50879961!
test05OwnerNameShouldNotBeEmpty
	
	self should: [ CreditCard withNumber: testObjectsFactory validCardId
						expirationDate: testObjectsFactory futureExpirationDate 
						owner: '' ]
	raise: Error
	withMessageText: CreditCard invalidExpirationDateErrorDescription .
	! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 20:25:01'!
test06OwnerNameShouldNotBeBlank
	
	self should: [ CreditCard withNumber: testObjectsFactory validCardId
						expirationDate: testObjectsFactory futureExpirationDate 
						owner: '            ' ]
	raise: Error
	withMessageText: CreditCard invalidExpirationDateErrorDescription .
	! !
!CreditCard class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 20:25:56' prior: 50879872!
withNumber: aNumber expirationDate: aMonthOfYear owner: aPerson 
	
	((aNumber between: 10^15 and: 10^16-1) and: [aNumber isInteger] )ifFalse: [ self error: self invalidCardNumberErrorDescription ].
	( aMonthOfYear isKindOf: GregorianMonthOfYear ) ifFalse: [ self error: self invalidExpirationDateErrorDescription ] .
	aPerson withoutTrailingBlanks isEmpty ifTrue: [ self error: self invalidOwnerNameErrorDescription ] .
	
	
	^ self new initializeWithNumber: aNumber expirationDate: aMonthOfYear owner: aPerson ! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 20:26:07' prior: 50880070!
test06OwnerNameShouldNotBeBlank
	
	self should: [ CreditCard withNumber: testObjectsFactory validCardId
						expirationDate: testObjectsFactory futureExpirationDate 
						owner: '            ' ]
	raise: Error
	withMessageText: CreditCard invalidOwnerNameErrorDescription .
	! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 20:26:11' prior: 50880058!
test05OwnerNameShouldNotBeEmpty
	
	self should: [ CreditCard withNumber: testObjectsFactory validCardId
						expirationDate: testObjectsFactory futureExpirationDate 
						owner: '' ]
	raise: Error
	withMessageText: CreditCard invalidOwnerNameErrorDescription .
	! !

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:26:12'!
ERROR!
!CreditCard class methodsFor: 'error descriptions' stamp: 'AM 11/30/2020 20:26:19'!
invalidOwnerNameErrorDescription
	self shouldBeImplemented.! !
!CreditCard class methodsFor: 'error descriptions' stamp: 'AM 11/30/2020 20:26:30' prior: 50880129!
invalidOwnerNameErrorDescription

	^ 'Credit card should not have an invalid owner name'! !

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:26:32'!
FAILURE!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:27:13'!
FAILURE!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 20:27:13'!
FAILURE!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:27:16'!
FAILURE!
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'AM 11/30/2020 20:30:10' prior: 50878627!
futureExpirationDate
	
	^ GregorianMonthOfYear year: GregorianDate today year + 1
							 month: GregorianDate today month! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 20:30:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 20:30:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 20:30:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:30:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:30:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 20:30:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 20:30:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 20:30:12'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 20:30:13'!
FAILURE!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:30:13'!
ERROR!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:30:13'!
FAILURE!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:30:13'!
FAILURE!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:30:13'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:30:13'!
FAILURE!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 20:30:13'!
FAILURE!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:30:19'!
ERROR!
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'AM 11/30/2020 20:30:40' prior: 50880154!
futureExpirationDate
	
	^ GregorianMonthOfYear year: FixedGregorianDate today year + 1
							 month: FixedGregorianDate today month! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 20:30:42'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 20:30:42'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 20:30:42'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:30:42'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:30:42'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 20:30:42'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 20:30:42'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 20:30:42'!
FAILURE!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:30:42'!
ERROR!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:30:42'!
FAILURE!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:30:42'!
FAILURE!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:30:42'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:30:42'!
FAILURE!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 20:30:42'!
FAILURE!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:30:49'!
ERROR!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 20:31:13'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 20:31:13'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 20:31:13'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:31:13'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:31:13'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 20:31:13'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 20:31:13'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 20:31:13'!
FAILURE!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:31:13'!
ERROR!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:31:13'!
FAILURE!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:31:13'!
FAILURE!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:31:13'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:31:13'!
FAILURE!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 20:31:13'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 20:31:15'!
ERROR!

FixedGregorianDate today year!
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'AM 11/30/2020 20:32:03' prior: 50880306!
futureExpirationDate
	
	^ GregorianMonthOfYear year: FixedGregorianDate today year next
							 month: FixedGregorianDate today month! !

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 20:32:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 20:32:07'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 20:32:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:32:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:32:10'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 20:32:11'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:32:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 20:32:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 20:32:14'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:32:15'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:32:16'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:32:16'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 20:32:17'!
PASSED!
!CreditCardTest methodsFor: 'tests - accessing' stamp: 'AM 11/30/2020 20:35:46'!
test07ValidCardPropertiesAreCorrect
	
	| creditCard |
	creditCard := CreditCard withNumber: testObjectsFactory validCardId
							expirationDate:  testObjectsFactory futureExpirationDate 
							owner: testObjectsFactory validOwner.
	
	self assert: testObjectsFactory validCardId equals: creditCard number .
	self assert: testObjectsFactory futureExpirationDate equals: creditCard expirationDate .
	self assert: testObjectsFactory validOwner equals: creditCard owner..

	! !
!CreditCardTest methodsFor: 'tests - accessing' stamp: 'AM 11/30/2020 20:35:55' prior: 50880659!
test07ValidCardPropertiesAreCorrect
	
	| creditCard |
	
	creditCard := CreditCard withNumber: testObjectsFactory validCardId
							expirationDate:  testObjectsFactory futureExpirationDate 
							owner: testObjectsFactory validOwner.
	
	self assert: testObjectsFactory validCardId equals: creditCard number .
	self assert: testObjectsFactory futureExpirationDate equals: creditCard expirationDate .
	self assert: testObjectsFactory validOwner equals: creditCard owner..

	! !

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 20:35:55'!
ERROR!
!CreditCard methodsFor: 'accessing' stamp: 'AM 11/30/2020 20:36:04'!
number
	self shouldBeImplemented.
	^number! !
!CreditCard methodsFor: 'accessing' stamp: 'AM 11/30/2020 20:36:11' prior: 50880698!
number
	
	^ number! !

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 20:36:13'!
ERROR!
!CreditCard methodsFor: 'accessing' stamp: 'AM 11/30/2020 20:36:21'!
expirationDate
	self shouldBeImplemented.
	^expirationDate! !
!CreditCard methodsFor: 'accessing' stamp: 'AM 11/30/2020 20:36:26' prior: 50880710!
expirationDate
	
	^ expirationDate! !

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 20:36:28'!
ERROR!
!CreditCard methodsFor: 'accessing' stamp: 'AM 11/30/2020 20:36:36'!
owner
	self shouldBeImplemented.
	^owner! !
!CreditCard methodsFor: 'accessing' stamp: 'AM 11/30/2020 20:36:40' prior: 50880722!
owner
	
	^ owner! !

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 20:36:42'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:36:42'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:36:42'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:36:42'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:36:42'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:36:42'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 20:36:42'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 20:36:42'!
PASSED!
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'AM 11/30/2020 20:37:39' prior: 50873584!
expiredCreditCard
	
	^CreditCard withNumber: self validCardId 
			expirationDate:  self pastExpirationDate
			owner: self validOwner.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 20:37:44'!
ERROR!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 20:37:44'!
FAILURE!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 20:37:44'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 20:37:47'!
ERROR!
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'AM 11/30/2020 20:38:04'!
pastExpirationDate
	self shouldBeImplemented.! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'AM 11/30/2020 20:38:38' prior: 50880913!
pastExpirationDate
	
	^ GregorianMonthOfYear year: FixedGregorianDate today year previous
							 month: FixedGregorianDate today month! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 20:38:41'!
ERROR!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 20:38:41'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 20:38:41'!
ERROR!
!CreditCard methodsFor: 'testing' stamp: 'AM 11/30/2020 20:39:32' prior: 50873434!
isExpiredOn: aDate 
	
	^ expirationDate < (Month month: aDate monthIndex year: aDate yearNumber) start ! !

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:39:34'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:39:34'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:39:34'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:39:34'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:39:34'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 20:39:34'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 20:39:34'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 20:39:51'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:39:52'!
ERROR!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 20:39:52'!
ERROR!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 20:39:52'!
ERROR!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 20:39:52'!
ERROR!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 20:39:52'!
ERROR!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 20:39:52'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 20:39:52'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 20:39:52'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:39:52'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:39:52'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 20:39:52'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 20:39:52'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:39:56'!
ERROR!
!CreditCard class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 20:41:15'!
withNumber: aNumber expiringOn: aMonth 
	
	^self new initializeExpiringOn: aMonth! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 20:41:15' prior: 50873591!
notExpiredCreditCard
	
	^CreditCard withNumber: testObjectsFactory validCardId expiringOn: (Month month: today monthIndex year: today yearNumber + 1)! !

!methodRemoval: CreditCard class #expiringOn: stamp: 'AM 11/30/2020 20:41:15'!
expiringOn: aMonth 
	
	^self new initializeExpiringOn: aMonth!
!CreditCard class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 20:42:09'!
withNumber: aNumber expiringOn: aMonth owner: aPerson  
	
	^self new initializeExpiringOn: aMonth! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 20:42:09' prior: 50881257!
notExpiredCreditCard
	
	^CreditCard withNumber: testObjectsFactory validCardId expiringOn: (Month month: today monthIndex year: today yearNumber + 1) owner: testObjectsFactory validOwner! !

!methodRemoval: CreditCard class #withNumber:expiringOn: stamp: 'AM 11/30/2020 20:42:09'!
withNumber: aNumber expiringOn: aMonth 
	
	^self new initializeExpiringOn: aMonth!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:42:47'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:42:47'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:42:47'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:42:47'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:42:47'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 20:42:47'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 20:42:47'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 20:42:56'!
ERROR!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:42:56'!
ERROR!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 20:42:56'!
ERROR!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 20:42:56'!
ERROR!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 20:42:56'!
ERROR!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 20:42:56'!
ERROR!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 20:42:56'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 20:42:56'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 20:42:56'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:42:56'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:42:56'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 20:42:56'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 20:42:56'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 20:42:56'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 20:43:08'!
ERROR!
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'AM 11/30/2020 20:44:06' prior: 50881276!
notExpiredCreditCard
	
	^CreditCard withNumber: self validCardId 
				expiringOn: self futureExpirationDate 
				owner: self validOwner! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 20:44:07'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 20:44:07'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 20:44:07'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 20:44:07'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 20:44:07'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 20:44:07'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 20:44:07'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 20:44:07'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 20:44:07'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:44:07'!
ERROR!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 20:44:07'!
ERROR!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 20:44:07'!
ERROR!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 20:44:07'!
ERROR!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 20:44:07'!
ERROR!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 20:44:07'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 20:44:07'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 20:44:07'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 20:44:07'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 20:44:07'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 20:44:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 20:44:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 20:44:08'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 20:44:08'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 20:44:08'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 20:44:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:44:08'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:44:08'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 20:44:08'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 20:44:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 20:44:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 20:44:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 20:44:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 20:44:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 20:44:08'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:44:08'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:44:08'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:44:08'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:44:08'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:44:08'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 20:44:08'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 20:44:08'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:44:11'!
ERROR!
!CreditCard methodsFor: 'testing' stamp: 'AM 11/30/2020 20:44:27' prior: 50881073!
isExpiredOn: aDate 
	
	^ expirationDate < aDate! !

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:44:28'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:44:28'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:44:28'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:44:28'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:44:28'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 20:44:28'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 20:44:28'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:44:33'!
ERROR!
!CreditCard class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 20:45:05' prior: 50881269!
withNumber: aNumber expiringOn: aMonthOfYear owner: aPerson  
	
	((aNumber between: 10^15 and: 10^16-1) and: [aNumber isInteger] )ifFalse: [ self error: self invalidCardNumberErrorDescription ].
	( aMonthOfYear isKindOf: GregorianMonthOfYear ) ifFalse: [ self error: self invalidExpirationDateErrorDescription ] .
	aPerson withoutTrailingBlanks isEmpty ifTrue: [ self error: self invalidOwnerNameErrorDescription ] .
	
	
	^ self new initializeWithNumber: aNumber expirationDate: aMonthOfYear owner: aPerson ! !
!CreditCard class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 20:45:10' prior: 50881648!
withNumber: aNumber expiringOn: aMonthOfYear owner: aName  
	
	((aNumber between: 10^15 and: 10^16-1) and: [aNumber isInteger] )ifFalse: [ self error: self invalidCardNumberErrorDescription ].
	( aMonthOfYear isKindOf: GregorianMonthOfYear ) ifFalse: [ self error: self invalidExpirationDateErrorDescription ] .
	aName withoutTrailingBlanks isEmpty ifTrue: [ self error: self invalidOwnerNameErrorDescription ] .
	
	
	^ self new initializeWithNumber: aNumber expirationDate: aMonthOfYear owner: aName ! !
!CreditCard class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 20:45:43' prior: 50880082!
withNumber: aNumber expirationDate: aMonthOfYear owner: aName 
	
	((aNumber between: 10^15 and: 10^16-1) and: [aNumber isInteger] )ifFalse: [ self error: self invalidCardNumberErrorDescription ].
	( aMonthOfYear isKindOf: GregorianMonthOfYear ) ifFalse: [ self error: self invalidExpirationDateErrorDescription ] .
	aName withoutTrailingBlanks isEmpty ifTrue: [ self error: self invalidOwnerNameErrorDescription ] .
	
	
	^ self new initializeWithNumber: aNumber expirationDate: aMonthOfYear owner: aName ! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 20:45:54'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:45:55'!
ERROR!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 20:45:55'!
ERROR!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 20:45:55'!
ERROR!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 20:45:55'!
ERROR!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 20:45:55'!
ERROR!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 20:45:55'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 20:45:55'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 20:45:55'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:45:55'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:45:55'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 20:45:55'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 20:45:55'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:45:57'!
ERROR!
!CreditCard methodsFor: 'testing' stamp: 'AM 11/30/2020 20:47:19' prior: 50881616!
isExpiredOn: aDate 
	
	^ expirationDate < aDate date! !

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:47:21'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:47:21'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:47:21'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:47:21'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:47:21'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 20:47:21'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 20:47:21'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:47:26'!
ERROR!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 20:47:26'!
ERROR!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 20:47:26'!
ERROR!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 20:47:26'!
ERROR!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 20:47:26'!
ERROR!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 20:47:26'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 20:47:26'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 20:47:26'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:47:26'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:47:26'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 20:47:26'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 20:47:26'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:47:29'!
ERROR!

aDate date!

expirationDate!

expirationDate!

expirationDate < aDate date!

aDate date!

aDate!

self < January, 2020!

self < (January, 2020)!

self date < (January, 2020)!

self date!
!CreditCard methodsFor: 'testing' stamp: 'AM 11/30/2020 20:51:21' prior: 50881853!
isExpiredOn: aDate 
	
	^ expirationDate < (aDate month), (aDate year)! !

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:51:31'!
ERROR!
!CreditCard methodsFor: 'testing' stamp: 'AM 11/30/2020 20:51:52' prior: 50882034!
isExpiredOn: aDate 
	
	^ expirationDate < 
		((aDate month), (aDate year))! !

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:51:53'!
ERROR!
!CreditCard methodsFor: 'testing' stamp: 'AM 11/30/2020 20:52:20' prior: 50882042!
isExpiredOn: aDate 
	
	^ expirationDate < 
		(Month month: aDate monthIndex year: aDate yearNumber) ! !

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:52:22'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:52:22'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:52:22'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:52:22'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:52:22'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 20:52:22'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 20:52:22'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 20:52:27'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 20:52:27'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 20:52:27'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 20:52:27'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 20:52:27'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 20:52:27'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 20:52:27'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 20:52:27'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 20:52:27'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:52:27'!
ERROR!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 20:52:27'!
ERROR!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 20:52:27'!
ERROR!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 20:52:27'!
ERROR!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 20:52:27'!
ERROR!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:52:27'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:52:27'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:52:27'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:52:27'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:52:27'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 20:52:28'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 20:52:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 20:52:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 20:52:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 20:52:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 20:52:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 20:52:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 20:52:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 20:52:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 20:52:28'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 20:52:28'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 20:52:28'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 20:52:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:52:28'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:52:28'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 20:52:28'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 20:52:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 20:52:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 20:52:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 20:52:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 20:52:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 20:52:28'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:52:30'!
ERROR!
!CreditCard methodsFor: 'testing' stamp: 'AM 11/30/2020 20:52:58' prior: 50882051!
isExpiredOn: aDate 
	
	^ expirationDate < 
		(GregorianMonthOfYear month: aDate monthIndex year: aDate yearNumber) ! !

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:53:00'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:53:00'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:53:00'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:53:00'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:53:00'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 20:53:00'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 20:53:00'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 20:53:11'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 20:53:11'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 20:53:11'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 20:53:11'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 20:53:11'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 20:53:11'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 20:53:11'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 20:53:11'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 20:53:11'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:53:11'!
ERROR!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 20:53:11'!
ERROR!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 20:53:11'!
ERROR!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 20:53:11'!
ERROR!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 20:53:11'!
ERROR!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:53:11'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:53:11'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:53:11'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:53:11'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:53:11'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 20:53:11'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 20:53:11'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 20:53:11'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 20:53:11'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 20:53:11'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 20:53:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 20:53:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 20:53:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 20:53:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 20:53:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 20:53:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 20:53:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 20:53:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:53:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:53:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 20:53:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 20:53:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 20:53:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 20:53:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 20:53:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 20:53:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 20:53:12'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:53:14'!
ERROR!
!CreditCard methodsFor: 'testing' stamp: 'AM 11/30/2020 20:53:52' prior: 50882228!
isExpiredOn: aDate 
	
	^ expirationDate < 
		(GregorianMonthOfYear year: aDate yearNumber month: aDate monthIndex) ! !

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:53:53'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:53:53'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:53:53'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:53:53'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:53:53'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 20:53:53'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 20:53:53'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:53:57'!
ERROR!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 20:53:57'!
ERROR!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 20:53:57'!
ERROR!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 20:53:57'!
ERROR!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 20:53:57'!
ERROR!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 20:53:57'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 20:53:57'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 20:53:57'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:53:57'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:53:57'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 20:53:57'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 20:53:57'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:54:00'!
ERROR!

GregorianMonthOfYear year: aDate yearNumber month: aDate monthIndex!
!CreditCard methodsFor: 'testing' stamp: 'AM 11/30/2020 20:54:46' prior: 50882405!
isExpiredOn: aDate 
	
	^ expirationDate < 
		(GregorianMonthOfYear year: aDate year month: aDate monthIndex) ! !
!CreditCard methodsFor: 'testing' stamp: 'AM 11/30/2020 20:54:47' prior: 50882585!
isExpiredOn: aDate 
	
	^ expirationDate < 
		(GregorianMonthOfYear year: aDate year month: aDate month) ! !


		(GregorianMonthOfYear year: aDate year month: aDate month) !

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:55:00'!
ERROR!

 aDate year !

aDate month!
!CreditCard methodsFor: 'testing' stamp: 'AM 11/30/2020 20:55:48' prior: 50882592!
isExpiredOn: aDate 
	
	^ expirationDate <  aDate month! !

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 20:55:50'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 20:55:50'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 20:55:50'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 20:55:50'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 20:55:50'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 20:55:50'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 20:55:50'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:55:52'!
ERROR!

aDate month!

aDate month!

expirationDate!

GregorianMonthOfYear!
!CreditCard methodsFor: 'testing' stamp: 'AM 11/30/2020 20:58:16' prior: 50882604!
isExpiredOn: aDate 
	
	^ expirationDate <  (GregorianMonthOfYear yearNumber: aDate yearNumber monthNumber: aDate monthIndex).! !

(GregorianMonthOfYear yearNumber: aDate yearNumber monthNumber: aDate monthIndex)!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 20:58:25'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 20:58:29'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 20:58:31'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 20:58:32'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 20:58:33'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 20:58:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 20:58:35'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 20:58:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:58:37'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 20:58:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 20:58:39'!
PASSED!
!CreditCard methodsFor: 'testing' stamp: 'AM 11/30/2020 20:58:52' prior: 50882638!
isExpiredOn: aDate 
	
	^ expirationDate <  
		(GregorianMonthOfYear yearNumber: aDate yearNumber monthNumber: aDate monthIndex).! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 11/30/2020 20:59:48' prior: 50878586!
test08CheckOutSuccessfullyChecksOutOneCart
	
	| interface aCartId total |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	total := interface checkOut: aCartId withCCN: testObjectsFactory validCardId CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	
	self assert: total equals: testObjectsFactory itemSellByTheStorePrice .
	
	! !

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 20:59:52'!
ERROR!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 20:59:52'!
ERROR!
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 21:01:18' prior: 50879121!
checkOut: aCartId withCCN: aCreditCardNumber CCED: anExpirationDate CCO: anOwner on: aDate 
	
	| total creditCard |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	creditCard := CreditCard withNumber: aCreditCardNumber
							expirationDate:  anExpirationDate
							owner: anOwner.

	total := ( Cashier toCheckout: (self cartAt: aCartId) 
		charging: creditCard 
		throught: merchantProcessor 
		on: aDate 
		registeringOn: ( salesBooks at: ( self clientUsingCart: aCartId ) ) )
		checkOut .
			
	carts removeKey: aCartId .
	clientByCart removeKey: aCartId .
	
	^ total.
! !

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 21:01:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 21:01:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 21:01:38'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 21:01:38'!
ERROR!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 21:01:46'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 21:01:46'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 21:01:47'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 21:01:47'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 21:01:47'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 21:01:47'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 21:01:47'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 21:01:47'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 21:01:47'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 21:01:47'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 21:01:47'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:01:47'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:01:47'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 21:01:47'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 21:01:47'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 21:01:47'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 21:01:47'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 21:01:47'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 21:01:47'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 21:01:47'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 11/30/2020 21:01:55' prior: 50878775!
test09ShouldNotCheckOutAnAlreadyCheckedOutCart
	
	| interface aCartId |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	interface checkOut: aCartId withCCN: testObjectsFactory validCardId CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	
	self should: [ interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today ]
	raise: Error
	withMessageText: InternalRestInterface invalidCartIdErrorDescription . 
	
	! !

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 21:01:57'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 11/30/2020 21:02:11' prior: 50878812!
test10FailedCheckOutShouldNotInvalidateFutureCheckOut
	
	| interface aCartId total |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .

	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	[ interface checkOut: aCartId withCCN: testObjectsFactory validCardId CCED: testObjectsFactory pastExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today. ] on: Error do: [:anError | ].

	total := interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	
	self assert: total equals: testObjectsFactory itemSellByTheStorePrice .
	
	! !

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 21:02:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 21:02:36'!
ERROR!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 21:03:07'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 21:03:07'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 21:03:07'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 21:03:07'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 21:03:07'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 21:03:07'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 21:03:07'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 21:03:07'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 21:03:07'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 21:03:07'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 21:03:07'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:03:07'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:03:07'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 21:03:07'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 21:03:07'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 21:03:07'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 21:03:07'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 21:03:07'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 21:03:07'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 21:03:07'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 11/30/2020 21:03:23' prior: 50882874!
test10FailedCheckOutShouldNotInvalidateFutureCheckOut
	
	| interface aCartId total |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .

	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	[ interface checkOut: aCartId withCCN: testObjectsFactory validCardId CCED: testObjectsFactory pastExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today. ] on: Error do: [:anError | ].

	total := interface checkOut: aCartId withCCN: testObjectsFactory validCardId CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	
	self assert: total equals: testObjectsFactory itemSellByTheStorePrice .
	
	! !

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 21:03:25'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 21:03:25'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 21:03:25'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 21:03:25'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 21:03:25'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 21:03:25'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 21:03:25'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 21:03:25'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 21:03:25'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 21:03:25'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 21:03:25'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 21:03:25'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:03:25'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:03:25'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 21:03:25'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 21:03:25'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 21:03:25'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 21:03:25'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 21:03:25'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 21:03:25'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 21:03:25'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 21:03:28'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 11/30/2020 21:03:37' prior: 50878850!
test12ListOnePurchaseSuccessfully
	
	| interface aCartId purchases |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	interface checkOut: aCartId withCCN: testObjectsFactory validCardId CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: purchases total equals: testObjectsFactory itemSellByTheStorePrice .
	self assert: ( purchases products hasEqualElements: {testObjectsFactory itemSellByTheStore } ) .
	
	! !

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:03:38'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 11/30/2020 21:03:47' prior: 50878887!
test13ListMoreThanOnePurchaseSuccessfully
	
	| interface aCartId purchases |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	2 timesRepeat: [ 
		aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
		interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
		interface checkOut: aCartId withCCN: testObjectsFactory validCardId CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today 
		].
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice * 2 equals: purchases total.
	self assert: ( purchases products hasEqualElements: { testObjectsFactory itemSellByTheStore. testObjectsFactory itemSellByTheStore } ) .
	
	! !

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:03:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 21:03:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 21:03:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 21:03:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 21:03:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 21:03:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 21:03:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 21:03:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 21:03:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 21:03:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 21:03:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 21:03:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:03:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:03:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 21:03:49'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 21:03:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 21:03:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 21:03:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 21:03:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 21:03:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 21:03:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 21:03:49'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:03:54'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 11/30/2020 21:04:03' prior: 50878923!
test14ListPurchasesFromMoreThanOneUser
	
	| interface aCartId purchases |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	interface checkOut: aCartId withCCN: testObjectsFactory validCardId CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	
	aCartId := interface createCartForUser: testObjectsFactory anotherValidUser password: testObjectsFactory anotherValidPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice equals: purchases total.
	self assert: ( purchases products hasEqualElements: {testObjectsFactory itemSellByTheStore } ) .
	
	! !

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 21:04:04'!
ERROR!
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 11/30/2020 21:04:25' prior: 50883251!
test14ListPurchasesFromMoreThanOneUser
	
	| interface aCartId purchases |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	interface checkOut: aCartId withCCN: testObjectsFactory validCardId CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	
	aCartId := interface createCartForUser: testObjectsFactory anotherValidUser password: testObjectsFactory anotherValidPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	interface checkOut: aCartId withCCN: testObjectsFactory validCardId notExpiredCreditCard CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice equals: purchases total.
	self assert: ( purchases products hasEqualElements: {testObjectsFactory itemSellByTheStore } ) .
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 11/30/2020 21:04:30' prior: 50883297!
test14ListPurchasesFromMoreThanOneUser
	
	| interface aCartId purchases |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	interface checkOut: aCartId withCCN: testObjectsFactory validCardId CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	
	aCartId := interface createCartForUser: testObjectsFactory anotherValidUser password: testObjectsFactory anotherValidPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	interface checkOut: aCartId withCCN: testObjectsFactory validCardId CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice equals: purchases total.
	self assert: ( purchases products hasEqualElements: {testObjectsFactory itemSellByTheStore } ) .
	
	! !

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 21:04:32'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 21:04:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 21:04:38'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - credentials' stamp: 'AM 11/30/2020 21:04:50' prior: 50873039!
test02WrongPasswordShouldNotCreateCart
	
	| interface |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	self should: [ interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory invalidPassword ]
	raise: Error
	withMessageText: AuthenticationSystemSimulator invalidPasswordErrorDescription.
	
	
	
	! !
!InternalRestInterface methodsFor: 'initialization' stamp: 'AM 11/30/2020 21:05:33' prior: 50874328!
initializeWith: anAuthenticationSystem catalog: aCatalog through: aMerchantProcessor clock: aClockSimulator 
	
	authenticationSystem := anAuthenticationSystem.
	catalog := aCatalog.
	merchantProcessor := aMerchantProcessor.
	clock := aClockSimulator.
	nextCartId := 0.
	
	salesBooks := Dictionary new.
	clientByCart := Dictionary new.
	carts := Dictionary new.
	lastTime := Dictionary new.! !

Object subclass: #InterfaceCartData
	instanceVariableNames: 'client lastTimeUsed'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #InterfaceCartData category: 'TusLibros' stamp: 'AM 11/30/2020 21:08:29'!
Object subclass: #InterfaceCartData
	instanceVariableNames: 'client lastTimeUsed'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InternalRestInterface methodsFor: 'initialization' stamp: 'AM 11/30/2020 21:08:53' prior: 50883542!
initializeWith: anAuthenticationSystem catalog: aCatalog through: aMerchantProcessor clock: aClockSimulator 
	
	authenticationSystem := anAuthenticationSystem.
	catalog := aCatalog.
	merchantProcessor := aMerchantProcessor.
	clock := aClockSimulator.
	nextCartId := 0.
	
	carts := Dictionary new.! !
!InternalRestInterface methodsFor: 'time out - private' stamp: 'AM 11/30/2020 21:09:16' prior: 50874564!
lastTimeFor: aCartId

	^ (carts at: aCartId) lastTimeUsed.! !
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 11/30/2020 21:09:49' prior: 50875294!
cartAt: aCartId

	^ (carts at: aCartId) cart. ! !
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 11/30/2020 21:10:31' prior: 50873709!
clientUsingCart: aCartId

	^ (carts at: aCartId) client! !
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 21:12:15' prior: 50875873!
createCartForUser: anUser password: aPassword 
	
	| newCartId |
	
	authenticationSystem authenticate: anUser using: aPassword .
	
	newCartId := self newCartId.
	
	carts at: newCartId put: (InterfaceCartData cart: Cart new
											client: anUser
											lastTimeUsed: clock now).
	
	salesBooks at: anUser ifAbsentPut: OrderedCollection new.
	
	^ newCartId. ! !
!InternalRestInterface methodsFor: 'time out - private' stamp: 'AM 11/30/2020 21:13:29' prior: 50879151!
updateLastUseOf: aCartId

	(carts at: aCartId) updateLastUseTo: clock now.
! !
!InternalRestInterface methodsFor: 'initialization' stamp: 'AM 11/30/2020 21:13:52' prior: 50883570!
initializeWith: anAuthenticationSystem catalog: aCatalog through: aMerchantProcessor clock: aClockSimulator 
	
	authenticationSystem := anAuthenticationSystem.
	catalog := aCatalog.
	merchantProcessor := aMerchantProcessor.
	clock := aClockSimulator.
	nextCartId := 0.
	
	carts := Dictionary new.
	salesBooks := Dictionary new.! !
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 21:14:35' prior: 50882726!
checkOut: aCartId withCCN: aCreditCardNumber CCED: anExpirationDate CCO: anOwner on: aDate 
	
	| total creditCard |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	creditCard := CreditCard withNumber: aCreditCardNumber
							expirationDate:  anExpirationDate
							owner: anOwner.

	total := ( Cashier toCheckout: (self cartAt: aCartId) 
		charging: creditCard 
		throught: merchantProcessor 
		on: aDate 
		registeringOn: ( salesBooks at: ( self clientUsingCart: aCartId ) ) )
		checkOut .
			
	carts removeKey: aCartId .
	
	^ total.
! !
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 21:14:53' prior: 50877475!
addToCart: aCartId product: aProduct withOcurrences: aNumberOfOccurrences 
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.

	(self cartAt: aCartId)  cart add: aNumberOfOccurrences of: aProduct! !

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 21:15:22'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 21:15:22'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 21:15:22'!
ERROR!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 21:15:22'!
ERROR!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 21:15:22'!
ERROR!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 21:15:22'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 21:15:22'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 21:15:22'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 21:15:22'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 21:15:22'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 21:15:22'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:15:22'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:15:22'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 21:15:22'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 21:15:22'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 21:15:22'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 21:15:22'!
ERROR!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 21:15:22'!
ERROR!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 21:15:22'!
ERROR!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 21:15:22'!
ERROR!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 21:15:24'!
ERROR!
!InterfaceCartData class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 21:15:34'!
cart: aCart client: aString lastTimeUsed: aGregorianDateTime 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeCart: aCart client: aString lastTimeUsed: aGregorianDateTime ! !
!InterfaceCartData class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 21:15:51' prior: 50883749!
cart: aCart client: anUser lastTimeUsed: aTime 
	
	^self new initializeCart: aCart client: anUser lastTimeUsed: aTime ! !

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 21:15:52'!
ERROR!

!classDefinition: #InterfaceCartData category: 'TusLibros' stamp: 'AM 11/30/2020 21:16:10'!
Object subclass: #InterfaceCartData
	instanceVariableNames: 'client lastTimeUsed cart'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #InterfaceCartData category: 'TusLibros' stamp: 'AM 11/30/2020 21:16:11'!
Object subclass: #InterfaceCartData
	instanceVariableNames: 'client lastTimeUsed cart user'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #InterfaceCartData category: 'TusLibros' stamp: 'AM 11/30/2020 21:16:11'!
Object subclass: #InterfaceCartData
	instanceVariableNames: 'client lastTimeUsed cart user time'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InterfaceCartData methodsFor: 'initialization' stamp: 'AM 11/30/2020 21:16:11'!
initializeCart: aCart client: anUser lastTimeUsed: aTime 
	self shouldBeImplemented.
	cart := aCart.
	user := anUser.
	time := aTime.! !
!InterfaceCartData methodsFor: 'initialization' stamp: 'AM 11/30/2020 21:16:15' prior: 50883794!
initializeCart: aCart client: anUser lastTimeUsed: aTime 
	
	cart := aCart.
	user := anUser.
	time := aTime.! !

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 21:16:16'!
ERROR!
!InterfaceCartData methodsFor: 'accessing' stamp: 'AM 11/30/2020 21:16:25'!
lastTimeUsed
	self shouldBeImplemented.
	^lastTimeUsed! !
!InterfaceCartData methodsFor: 'accessing' stamp: 'AM 11/30/2020 21:16:30' prior: 50883812!
lastTimeUsed
	
	^lastTimeUsed! !

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 21:16:32'!
ERROR!

Object subclass: #InterfaceCartData
	instanceVariableNames: 'client cart time'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #InterfaceCartData category: 'TusLibros' stamp: 'AM 11/30/2020 21:16:57'!
Object subclass: #InterfaceCartData
	instanceVariableNames: 'client cart time'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InterfaceCartData methodsFor: 'accessing' stamp: 'AM 11/30/2020 21:17:02' prior: 50883817!
lastTimeUsed
	
	^ time! !

Object subclass: #InterfaceCartData
	instanceVariableNames: 'client cart time'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #InterfaceCartData category: 'TusLibros' stamp: 'AM 11/30/2020 21:17:11'!
Object subclass: #InterfaceCartData
	instanceVariableNames: 'client cart time'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #InterfaceCartData category: 'TusLibros' stamp: 'AM 11/30/2020 21:17:16'!
Object subclass: #InterfaceCartData
	instanceVariableNames: 'client cart lastTimeUsed'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InterfaceCartData methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 21:17:16' prior: 50883837!
lastTimeUsed
	
	^ lastTimeUsed! !
!InterfaceCartData methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 21:17:16' prior: 50883802!
initializeCart: aCart client: anUser lastTimeUsed: aTime 
	
	cart := aCart.
	user := anUser.
	lastTimeUsed := aTime.! !

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 21:17:22'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 21:17:22'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 21:17:22'!
ERROR!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 21:17:22'!
ERROR!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 21:17:22'!
ERROR!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 21:17:22'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 21:17:22'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 21:17:22'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 21:17:22'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 21:17:22'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 21:17:22'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:17:22'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:17:22'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 21:17:22'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 21:17:22'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 21:17:22'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 21:17:22'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 21:17:22'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 21:17:22'!
ERROR!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 21:17:22'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 21:17:25'!
ERROR!
!InterfaceCartData methodsFor: 'updating' stamp: 'AM 11/30/2020 21:17:42'!
updateLastUseTo: aGregorianDateTime 
	self shouldBeImplemented.! !
!InterfaceCartData methodsFor: 'updating' stamp: 'AM 11/30/2020 21:17:54' prior: 50883952!
updateLastUseTo: aGregorianDateTime 
	
	lastTimeUsed := aGregorianDateTime ! !
!InterfaceCartData methodsFor: 'updating' stamp: 'AM 11/30/2020 21:17:59' prior: 50883957!
updateLastUseTo: aTime 
	
	lastTimeUsed := aTime ! !

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 21:18:01'!
ERROR!
!InterfaceCartData methodsFor: 'accessing' stamp: 'AM 11/30/2020 21:18:10'!
cart
	self shouldBeImplemented.
	^cart! !
!InterfaceCartData methodsFor: 'accessing' stamp: 'AM 11/30/2020 21:18:14' prior: 50883971!
cart
	
	^cart! !

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 21:18:15'!
ERROR!
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 21:18:27' prior: 50877374!
listCart: aCartId 
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	^ (self cartAt: aCartId) cart listCart asBag.! !

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 21:18:29'!
ERROR!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 21:18:37'!
ERROR!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 21:18:57'!
ERROR!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 21:19:18'!
ERROR!
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 21:19:25' prior: 50883984!
listCart: aCartId 
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	^ (self cartAt: aCartId) listCart asBag.! !

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 21:19:27'!
ERROR!

(self cartAt: aCartId)!

self listCart !
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 21:20:27' prior: 50883601!
createCartForUser: anUser password: aPassword 
	
	| newCartId |
	
	authenticationSystem authenticate: anUser using: aPassword .
	
	newCartId := self newCartId.
	
	carts at: newCartId put: (InterfaceCartData cart: (Cart acceptingItemsOf: catalog)
											client: anUser
											lastTimeUsed: clock now).
	
	salesBooks at: anUser ifAbsentPut: OrderedCollection new.
	
	^ newCartId. ! !

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 21:20:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 21:20:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 21:20:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 21:20:28'!
ERROR!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 21:20:29'!
ERROR!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 21:20:29'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 21:20:29'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 21:20:29'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 21:20:29'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 21:20:29'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 21:20:29'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:20:29'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:20:29'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 21:20:29'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 21:20:29'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 21:20:29'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 21:20:29'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 21:20:29'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 21:20:29'!
ERROR!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 21:20:29'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 21:20:31'!
ERROR!
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 21:20:41' prior: 50883659!
addToCart: aCartId product: aProduct withOcurrences: aNumberOfOccurrences 
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.

	(self cartAt: aCartId)  add: aNumberOfOccurrences of: aProduct! !

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 21:20:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 21:20:45'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 21:20:46'!
ERROR!
!InterfaceCartData methodsFor: 'accessing' stamp: 'AM 11/30/2020 21:20:59'!
client
	self shouldBeImplemented.
	^client! !
!InterfaceCartData methodsFor: 'accessing' stamp: 'AM 11/30/2020 21:21:03' prior: 50884139!
client
	
	^ client! !

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 21:21:04'!
ERROR!

(carts at: aCartId)!
!InterfaceCartData methodsFor: 'initialization' stamp: 'AM 11/30/2020 21:22:27' prior: 50883867!
initializeCart: aCart client: anUser lastTimeUsed: aTime 
	
	cart := aCart.
	client := anUser.
	lastTimeUsed := aTime.! !

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 21:22:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 21:22:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 21:22:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 21:22:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 21:22:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 21:22:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 21:22:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 21:22:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 21:22:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 21:22:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 21:22:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:22:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:22:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 21:22:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 21:22:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 21:22:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 21:22:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 21:22:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 21:22:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 21:22:31'!
PASSED!

Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticationSystem catalog carts nextCartId merchantProcessor salesBooks clock'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 'AM 11/30/2020 21:23:01'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticationSystem catalog carts nextCartId merchantProcessor salesBooks clock'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 21:26:01' prior: 50883636!
checkOut: aCartId withCCN: aCreditCardNumber CCED: anExpirationDate CCO: anOwner on: aDate 
	
	| total creditCard |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	creditCard := CreditCard withNumber: aCreditCardNumber
							expirationDate:  anExpirationDate
							owner: anOwner.

	total := ( Cashier toCheckout: (self cartAt: aCartId) 
		charging: creditCard 
		throught: merchantProcessor 
		on: aDate 
		registeringOn: ( self clientSalesBookFor: aCartId ))
		checkOut .
			
	carts removeKey: aCartId .
	
	^ total.
! !

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 21:26:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 21:26:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 21:26:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 21:26:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 21:26:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 21:26:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 21:26:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 21:26:04'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 21:26:04'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 21:26:04'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 21:26:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:26:04'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:26:04'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 21:26:04'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 21:26:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 21:26:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 21:26:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 21:26:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 21:26:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 21:26:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 21:26:06'!
ERROR!
!InternalRestInterface methodsFor: 'dsd' stamp: 'AM 11/30/2020 21:26:17'!
clientSalesBookFor: aSmallInteger 
	self shouldBeImplemented.! !
!InternalRestInterface methodsFor: 'dsd' stamp: 'AM 11/30/2020 21:26:24' prior: 50884352!
clientSalesBookFor: aCartId 
	self shouldBeImplemented.! !
!InternalRestInterface methodsFor: 'dsd' stamp: 'AM 11/30/2020 21:26:38' prior: 50884357!
clientSalesBookFor: aCartId 
	
	^ (carts at: aCartId) client! !

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 21:26:40'!
ERROR!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 21:26:48'!
ERROR!
!InternalRestInterface methodsFor: 'dsd' stamp: 'AM 11/30/2020 21:27:27' prior: 50884362!
clientSalesBookFor: aCartId 
	
	^ salesBooks at: (carts at: aCartId) client! !

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 21:27:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 21:27:33'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 21:27:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:27:35'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:27:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 21:27:38'!
PASSED!
!InternalRestInterface methodsFor: 'assertions' stamp: 'AM 11/30/2020 21:29:21' prior: 50875279!
assertThatCartHasNotTimedOut: aCartId

	(self hasTimedOut: aCartId) ifTrue: [ 
		carts removeKey: aCartId.
		self error: self class cartHasTimedOutErrorDescription ].! !

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 21:29:23'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 21:29:23'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 21:29:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 21:29:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 21:29:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 21:29:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 21:29:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 21:29:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 21:29:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 21:29:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 21:29:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:29:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:29:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 21:29:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 21:29:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 21:29:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 21:29:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 21:29:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 21:29:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 21:29:24'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 11/30/2020 21:34:04' prior: 50876698!
test17ShouldNotListWhenCartTimedOut
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore. ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] raise: Error withMessageText: InternalRestInterface invalidCartIdErrorDescription]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 21:34:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 21:34:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 21:34:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 21:34:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 21:34:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 21:34:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 21:34:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 21:34:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 21:34:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 21:34:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 21:34:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 21:34:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:34:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:34:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 21:34:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 21:34:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 21:34:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 21:34:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 21:34:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 21:34:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 21:34:08'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 11/30/2020 21:34:32'!
test17ShouldNotAddWhenCartTimedOut
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore. ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] raise: Error withMessageText: InternalRestInterface invalidCartIdErrorDescription]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !

!methodRemoval: InternalRestInterfaceTest #test17ShouldNotListWhenCartTimedOut stamp: 'AM 11/30/2020 21:34:33'!
test17ShouldNotListWhenCartTimedOut
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore. ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] raise: Error withMessageText: InternalRestInterface invalidCartIdErrorDescription]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	!
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 11/30/2020 21:34:40'!
test18ShouldNotListToTimedOutCart
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface listCart: aCartId  ]
	raise: Error
	withMessageText: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !

!methodRemoval: InternalRestInterfaceTest #test18ShouldNotAddToTimedOutCart stamp: 'AM 11/30/2020 21:34:40'!
test18ShouldNotAddToTimedOutCart
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface listCart: aCartId  ]
	raise: Error
	withMessageText: InternalRestInterface cartHasTimedOutErrorDescription.
		
	!
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 11/30/2020 21:35:00' prior: 50884655!
test18ShouldNotListToTimedOutCart
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface listCart: aCartId  ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] raise: Error withMessageText: InternalRestInterface invalidCartIdErrorDescription]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 11/30/2020 21:35:06' prior: 50878969!
test19ShouldNotCheckOutATimedOutCart
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	clock addToTime: 30*minute.
	
	self should: [ interface checkOut: aCartId withCCN: testObjectsFactory notExpiredCreditCard CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] raise: Error withMessageText: InternalRestInterface invalidCartIdErrorDescription]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 21:35:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 21:35:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 21:35:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 21:35:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 21:35:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 21:35:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 21:35:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 21:35:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 21:35:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 21:35:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 21:35:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 21:35:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:35:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 21:35:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 21:35:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 21:35:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 21:35:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 11/30/2020 21:35:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 11/30/2020 21:35:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 21:35:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 21:35:09'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 11/30/2020 21:35:48'!
test07ShouldNotAddToInvalidCartId
	
	| interface |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	self should: [ interface addToCart: testObjectsFactory invalidCartId product: testObjectsFactory itemSellByTheStore ]
	raise: Error - MessageNotUnderstood 
	withMessageText: InternalRestInterface invalidCartIdErrorDescription .

	
	
	! !

!methodRemoval: InternalRestInterfaceTest #test07AddingToInvalidCartIdShouldRaise stamp: 'AM 11/30/2020 21:35:48'!
test07AddingToInvalidCartIdShouldRaise
	
	| interface |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	self should: [ interface addToCart: testObjectsFactory invalidCartId product: testObjectsFactory itemSellByTheStore ]
	raise: Error - MessageNotUnderstood 
	withMessageText: InternalRestInterface invalidCartIdErrorDescription .

	
	
	!

----SNAPSHOT----(30 November 2020 21:38:54) CuisUniversity-4384.image priorSource: 17308160!

----STARTUP---- (30 November 2020 22:39:25) as /home/agustin/Escritorio/Uba/Materias/Compu/ISW1/TusLibros/CuisUniversity-4384.image!


!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 22:39:42'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 22:39:42'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 22:39:42'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 22:39:42'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 22:39:42'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 22:39:42'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 22:39:42'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 22:39:42'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 22:39:42'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 22:39:42'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 22:39:42'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 22:39:42'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 22:39:42'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 22:39:42'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 22:39:42'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 22:39:42'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 22:39:42'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 22:39:42'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 22:39:42'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 22:39:42'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 22:39:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 22:39:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 22:39:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 22:39:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 22:39:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 22:39:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 22:39:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 11/30/2020 22:39:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 22:39:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 22:39:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 22:39:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 22:39:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 22:39:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 22:39:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 22:39:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 22:39:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 22:39:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 11/30/2020 22:39:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 11/30/2020 22:39:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 22:39:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 22:39:43'!
PASSED!
!Purchase methodsFor: 'accessing' stamp: 'AM 11/30/2020 22:41:07' prior: 50873469!
products

	^ products asBag.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 22:41:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 22:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 22:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 22:41:13'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 22:41:13'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 22:41:13'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 22:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 22:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 11/30/2020 22:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 11/30/2020 22:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 22:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 22:41:13'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 11/30/2020 22:41:40' prior: 50883100!
test12ListOnePurchaseSuccessfully
	
	| interface aCartId purchases |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	interface checkOut: aCartId withCCN: testObjectsFactory validCardId CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: purchases total equals: testObjectsFactory itemSellByTheStorePrice .
	self assert: ( purchases products hasEqualElements: {testObjectsFactory itemSellByTheStore } asBag) .
	
	! !

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 22:41:40'!
ERROR!
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 11/30/2020 22:42:01' prior: 50885172!
test12ListOnePurchaseSuccessfully
	
	| interface aCartId purchases |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	interface checkOut: aCartId withCCN: testObjectsFactory validCardId CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: purchases total equals: testObjectsFactory itemSellByTheStorePrice .
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag.
	
	! !

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 22:42:03'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 11/30/2020 22:42:16' prior: 50883133!
test13ListMoreThanOnePurchaseSuccessfully
	
	| interface aCartId purchases |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	2 timesRepeat: [ 
		aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
		interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
		interface checkOut: aCartId withCCN: testObjectsFactory validCardId CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today 
		].
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice * 2 equals: purchases total.
	self assert: purchases products equals: { testObjectsFactory itemSellByTheStore. testObjectsFactory itemSellByTheStore } asBag.
	
	! !

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 22:42:17'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 11/30/2020 22:42:42' prior: 50883339!
test14ListPurchasesFromMoreThanOneUser
	
	| interface aCartId purchases |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	interface checkOut: aCartId withCCN: testObjectsFactory validCardId CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	
	aCartId := interface createCartForUser: testObjectsFactory anotherValidUser password: testObjectsFactory anotherValidPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	interface checkOut: aCartId withCCN: testObjectsFactory validCardId CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice equals: purchases total.
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag
	
	! !

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 22:42:43'!
PASSED!
!Cashier methodsFor: 'initialization' stamp: 'AM 11/30/2020 22:43:39'!
initializeToCheckout: aCart charging: aCreditCard through: aMerchantProcessor registeringOn: aSalesBook
	
	cart := aCart.
	creditCard := aCreditCard.
	merchantProcessor := aMerchantProcessor.
	salesBook := aSalesBook! !
!Cashier class methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 22:43:39' prior: 50873394!
toCheckout: aCart charging: aCreditCard throught: aMerchantProcessor on: aDate registeringOn: aSalesBook
	
	self assertIsNotEmpty: aCart.
	self assertIsNotExpired: aCreditCard on: aDate.
	
	^self new initializeToCheckout: aCart charging: aCreditCard through: aMerchantProcessor registeringOn: aSalesBook! !

!methodRemoval: Cashier #initializeToCheckout:charging:throught:registeringOn: stamp: 'AM 11/30/2020 22:43:39'!
initializeToCheckout: aCart charging: aCreditCard throught: aMerchantProcessor registeringOn: aSalesBook
	
	cart := aCart.
	creditCard := aCreditCard.
	merchantProcessor := aMerchantProcessor.
	salesBook := aSalesBook!
!Cashier class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 22:43:50'!
toCheckout: aCart charging: aCreditCard through: aMerchantProcessor on: aDate registeringOn: aSalesBook
	
	self assertIsNotEmpty: aCart.
	self assertIsNotExpired: aCreditCard on: aDate.
	
	^self new initializeToCheckout: aCart charging: aCreditCard through: aMerchantProcessor registeringOn: aSalesBook! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 22:43:50' prior: 50872771!
test04CheckoutRegistersASale

	| cart cashier salesBook total |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	salesBook := OrderedCollection new.
 
	cashier:= Cashier 
		toCheckout: cart 
		charging: testObjectsFactory notExpiredCreditCard
		through: self
		on: testObjectsFactory today
		registeringOn: salesBook.
		
	total := cashier checkOut.
					
	self assert: salesBook size = 1.
	self assert: salesBook first total = total.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 22:43:50' prior: 50872813!
test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit

	| cart cashier salesBook creditCard |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	creditCard := testObjectsFactory notExpiredCreditCard.
	salesBook := OrderedCollection new.
 	debitBehavior := [ :anAmount :aCreditCard | self error: Cashier creditCardHasNoCreditErrorMessage].
	
	cashier:= Cashier 
		toCheckout: cart 
		charging: creditCard
		through: self
		on: testObjectsFactory today
		registeringOn: salesBook.
		
	self 
		should: [cashier checkOut ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier creditCardHasNoCreditErrorMessage.
			self assert: salesBook isEmpty ]! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 22:43:50' prior: 50884252!
checkOut: aCartId withCCN: aCreditCardNumber CCED: anExpirationDate CCO: anOwner on: aDate 
	
	| total creditCard |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	creditCard := CreditCard withNumber: aCreditCardNumber
							expirationDate:  anExpirationDate
							owner: anOwner.

	total := ( Cashier toCheckout: (self cartAt: aCartId) 
		charging: creditCard 
		through: merchantProcessor 
		on: aDate 
		registeringOn: ( self clientSalesBookFor: aCartId ))
		checkOut .
			
	carts removeKey: aCartId .
	
	^ total.
! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 22:43:50' prior: 50872789!
test05CashierChargesCreditCardUsingMerchantProcessor

	| cart cashier salesBook total creditCard debitedAmout debitedCreditCard  |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	creditCard := testObjectsFactory notExpiredCreditCard.
	salesBook := OrderedCollection new.
 
	cashier:= Cashier 
		toCheckout: cart 
		charging: creditCard
		through: self
		on: testObjectsFactory today
		registeringOn: salesBook.
		
	debitBehavior := [ :anAmount :aCreditCard | 
		debitedAmout := anAmount.
		debitedCreditCard := aCreditCard ].
	total := cashier checkOut.
					
	self assert: debitedCreditCard = creditCard.
	self assert: debitedAmout = total.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 22:43:50' prior: 50872716!
test01CanNotCheckoutAnEmptyCart

	| salesBook |
	
	salesBook := OrderedCollection new.
	self 
		should: [ Cashier 
			toCheckout: testObjectsFactory createCart 
			charging: testObjectsFactory notExpiredCreditCard 
			through: self
			on: testObjectsFactory today
			registeringOn:  salesBook ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier cartCanNotBeEmptyErrorMessage.
			self assert: salesBook isEmpty ]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 22:43:50' prior: 50872750!
test03CanNotCheckoutWithAnExpiredCreditCart

	| cart salesBook |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	salesBook := OrderedCollection new.
	
	self
		should: [ Cashier 
				toCheckout: cart 
				charging: testObjectsFactory expiredCreditCard 
				through: self
				on: testObjectsFactory today
				registeringOn: salesBook ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError | 
			self assert: anError messageText = Cashier canNotChargeAnExpiredCreditCardErrorMessage.
			self assert: salesBook isEmpty ]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 22:43:51' prior: 50872734!
test02CalculatedTotalIsCorrect

	| cart cashier |
	
	cart := testObjectsFactory createCart.
	cart add: 2 of: testObjectsFactory itemSellByTheStore.
	
	cashier :=  Cashier
		toCheckout: cart 
		charging: testObjectsFactory notExpiredCreditCard 
		through: self
		on: testObjectsFactory today 
		registeringOn: OrderedCollection new.
		
	self assert: cashier checkOut = (testObjectsFactory itemSellByTheStorePrice * 2)! !

!methodRemoval: Cashier class #toCheckout:charging:throught:on:registeringOn: stamp: 'AM 11/30/2020 22:43:51'!
toCheckout: aCart charging: aCreditCard throught: aMerchantProcessor on: aDate registeringOn: aSalesBook
	
	self assertIsNotEmpty: aCart.
	self assertIsNotExpired: aCreditCard on: aDate.
	
	^self new initializeToCheckout: aCart charging: aCreditCard through: aMerchantProcessor registeringOn: aSalesBook!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 22:43:53'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 22:43:53'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 22:43:53'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 22:43:54'!
PASSED!

!methodRemoval: CreditCard #initializeExpiringOn: stamp: 'AM 11/30/2020 22:44:29'!
initializeExpiringOn: aMonth 
	
	expiration := aMonth !

!methodRemoval: CreditCard class #withNumber:expirationDate:owner: stamp: 'AM 11/30/2020 22:44:59'!
withNumber: aNumber expirationDate: aMonthOfYear owner: aName 
	
	((aNumber between: 10^15 and: 10^16-1) and: [aNumber isInteger] )ifFalse: [ self error: self invalidCardNumberErrorDescription ].
	( aMonthOfYear isKindOf: GregorianMonthOfYear ) ifFalse: [ self error: self invalidExpirationDateErrorDescription ] .
	aName withoutTrailingBlanks isEmpty ifTrue: [ self error: self invalidOwnerNameErrorDescription ] .
	
	
	^ self new initializeWithNumber: aNumber expirationDate: aMonthOfYear owner: aName !
!CreditCardTest methodsFor: 'tests - validations' stamp: 'AM 11/30/2020 22:45:09' prior: 50879415!
test01CardNumberShouldNotHaveLessThan16Digits

	| invalidCardId |
	
	invalidCardId := 10 ^ 15 - 1.
	
	self should: [ CreditCard withNumber: invalidCardId 
						expiringOn: testObjectsFactory futureExpirationDate
						owner: testObjectsFactory validOwner ]
	raise: Error - MessageNotUnderstood
	withMessageText: CreditCard invalidCardNumberErrorDescription .
	

	! !
!CreditCardTest methodsFor: 'tests - validations' stamp: 'AM 11/30/2020 22:45:20' prior: 50879994!
test02CardNumberShouldNotHaveMoreThan16Digits

	| invalidCardId |
	
	invalidCardId := 10 ^ 16.
	
	self should: [ CreditCard withNumber: invalidCardId 
						expiringOn: testObjectsFactory futureExpirationDate
						owner: testObjectsFactory validOwner ]
	raise: Error
	withMessageText: CreditCard invalidCardNumberErrorDescription .
	

	! !
!CreditCardTest methodsFor: 'tests - validations' stamp: 'AM 11/30/2020 22:45:24' prior: 50880029!
test03CardNumberShouldBeAnInteger

	| invalidCardId |
	
	invalidCardId := 0.5.
	
	self should: [ CreditCard withNumber: invalidCardId 
						expiringOn: testObjectsFactory futureExpirationDate
						owner: testObjectsFactory validOwner ]
	raise: Error
	withMessageText: CreditCard invalidCardNumberErrorDescription .
	

	! !
!CreditCardTest methodsFor: 'tests - validations' stamp: 'AM 11/30/2020 22:45:30' prior: 50880043!
test04CardExpirationDateShouldBeAMonthOfAnYear

	| aDayInAMonthOfAnYear |
	
	aDayInAMonthOfAnYear := January/01/2021.
	
	self should: [ CreditCard withNumber: testObjectsFactory validCardId
						expiringOn: aDayInAMonthOfAnYear
						owner: testObjectsFactory validOwner ]
	raise: Error
	withMessageText: CreditCard invalidExpirationDateErrorDescription .
	! !
!CreditCardTest methodsFor: 'tests - validations' stamp: 'AM 11/30/2020 22:45:33' prior: 50880114!
test05OwnerNameShouldNotBeEmpty
	
	self should: [ CreditCard withNumber: testObjectsFactory validCardId
						expiringOn: testObjectsFactory futureExpirationDate 
						owner: '' ]
	raise: Error
	withMessageText: CreditCard invalidOwnerNameErrorDescription .
	! !
!CreditCardTest methodsFor: 'tests - validations' stamp: 'AM 11/30/2020 22:45:42' prior: 50880102!
test06OwnerNameShouldNotBeBlank
	
	self should: [ CreditCard withNumber: testObjectsFactory validCardId
						expiringOn: testObjectsFactory futureExpirationDate 
						owner: '            ' ]
	raise: Error
	withMessageText: CreditCard invalidOwnerNameErrorDescription .
	! !
!CreditCardTest methodsFor: 'tests - accessing' stamp: 'AM 11/30/2020 22:45:48' prior: 50880677!
test07ValidCardPropertiesAreCorrect
	
	| creditCard |
	
	creditCard := CreditCard withNumber: testObjectsFactory validCardId
							expiringOn:  testObjectsFactory futureExpirationDate 
							owner: testObjectsFactory validOwner.
	
	self assert: testObjectsFactory validCardId equals: creditCard number .
	self assert: testObjectsFactory futureExpirationDate equals: creditCard expirationDate .
	self assert: testObjectsFactory validOwner equals: creditCard owner..

	! !
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 22:45:56' prior: 50885408!
checkOut: aCartId withCCN: aCreditCardNumber CCED: anExpirationDate CCO: anOwner on: aDate 
	
	| total creditCard |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	creditCard := CreditCard withNumber: aCreditCardNumber
							expiringOn:  anExpirationDate
							owner: anOwner.

	total := ( Cashier toCheckout: (self cartAt: aCartId) 
		charging: creditCard 
		through: merchantProcessor 
		on: aDate 
		registeringOn: ( self clientSalesBookFor: aCartId ))
		checkOut .
			
	carts removeKey: aCartId .
	
	^ total.
! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'AM 11/30/2020 22:46:02' prior: 50880758!
expiredCreditCard
	
	^CreditCard withNumber: self validCardId 
			expiringOn:  self pastExpirationDate
			owner: self validOwner.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 22:46:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 11/30/2020 22:46:14'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 11/30/2020 22:46:14'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 22:46:14'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 22:46:14'!
PASSED!
!CreditCard methodsFor: 'initialization' stamp: 'AM 11/30/2020 22:46:49'!
initializeWithNumber: aNumber expiringOn: aMonthOfYear owner: aPerson 
	
	number := aNumber.
	expirationDate := aMonthOfYear.
	owner := aPerson.! !
!CreditCard class methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 22:46:50' prior: 50881668!
withNumber: aNumber expiringOn: aMonthOfYear owner: aName  
	
	((aNumber between: 10^15 and: 10^16-1) and: [aNumber isInteger] )ifFalse: [ self error: self invalidCardNumberErrorDescription ].
	( aMonthOfYear isKindOf: GregorianMonthOfYear ) ifFalse: [ self error: self invalidExpirationDateErrorDescription ] .
	aName withoutTrailingBlanks isEmpty ifTrue: [ self error: self invalidOwnerNameErrorDescription ] .
	
	
	^ self new initializeWithNumber: aNumber expiringOn: aMonthOfYear owner: aName ! !

!methodRemoval: CreditCard #initializeWithNumber:expirationDate:owner: stamp: 'AM 11/30/2020 22:46:50'!
initializeWithNumber: aNumber expirationDate: aMonthOfYear owner: aPerson 
	
	number := aNumber.
	expirationDate := aMonthOfYear.
	owner := aPerson.!
!InterfaceCartData methodsFor: 'accessing' stamp: 'AM 11/30/2020 22:50:21' prior: 50883976!
cart
	
	^ cart! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 11/30/2020 22:56:48' prior: 50882696!
test08CheckOutSuccessfullyChecksOutOneCart
	
	| interface aCartId transactionId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	transactionId := interface checkOut: aCartId withCCN: testObjectsFactory validCardId CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	
	self assert: (interface saleFor: transactionId) total equals: testObjectsFactory itemSellByTheStorePrice .
	
	! !

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 22:56:56'!
ERROR!
!InternalRestInterface methodsFor: 'accessing' stamp: 'AM 11/30/2020 22:57:08'!
saleFor: aSmallInteger 
	self shouldBeImplemented.! !
!InternalRestInterface methodsFor: 'accessing' stamp: 'AM 11/30/2020 22:57:14' prior: 50886032!
saleFor: aTransactionId 
	self shouldBeImplemented.! !

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 'AM 11/30/2020 22:57:43'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticationSystem catalog carts nextCartId merchantProcessor salesBooks clock sales'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InternalRestInterface methodsFor: 'accessing' stamp: 'AM 11/30/2020 22:57:40' prior: 50886037!
saleFor: aTransactionId 

	^ sales at: aTransactionId! !

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 22:57:47'!
ERROR!
!InternalRestInterface methodsFor: 'initialization' stamp: 'AM 11/30/2020 22:58:01' prior: 50883622!
initializeWith: anAuthenticationSystem catalog: aCatalog through: aMerchantProcessor clock: aClockSimulator 
	
	authenticationSystem := anAuthenticationSystem.
	catalog := aCatalog.
	merchantProcessor := aMerchantProcessor.
	clock := aClockSimulator.
	nextCartId := 0.
	
	carts := Dictionary new.
	salesBooks := Dictionary new.
	sales := Dictionary new.! !

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 22:58:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 22:58:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 22:58:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 22:58:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 22:58:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 22:58:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 11/30/2020 22:58:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 22:58:03'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 22:58:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 22:58:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 22:58:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 22:58:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 22:58:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 22:58:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 22:58:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 22:58:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 11/30/2020 22:58:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 11/30/2020 22:58:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 22:58:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 22:58:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 22:58:03'!
ERROR!
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 11/30/2020 22:58:49' prior: 50886005!
test08CheckOutSuccessfullyChecksOutOneCart
	
	| interface aCartId transactionId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	transactionId := interface checkOut: aCartId 
							withCCN: testObjectsFactory validCardId 
							CCED: testObjectsFactory futureExpirationDate 
							CCO: testObjectsFactory validOwner 
							on: testObjectsFactory today.
	
	self assert: (interface saleFor: transactionId) total equals: testObjectsFactory itemSellByTheStorePrice .
	
	! !
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 23:01:57' prior: 50885793!
checkOut: aCartId withCCN: aCreditCardNumber CCED: anExpirationDate CCO: anOwner on: aDate 
	
	| total creditCard nextTransactionId |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	creditCard := CreditCard withNumber: aCreditCardNumber
							expiringOn:  anExpirationDate
							owner: anOwner.

	total := ( Cashier toCheckout: (self cartAt: aCartId) 
		charging: creditCard 
		through: merchantProcessor 
		on: aDate 
		registeringOn: ( self clientSalesBookFor: aCartId ))
		checkOut .
	
	nextTransactionId := self nextTransactionId.
	
	sales at: nextTransactionId put: (self clientSalesBookFor: aCartId) last.
	carts removeKey: aCartId .
	
	^ total.
! !

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 23:02:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 23:02:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 23:02:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 23:02:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 23:02:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 23:02:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 11/30/2020 23:02:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 23:02:01'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 23:02:01'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 23:02:01'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 23:02:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:02:01'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:02:01'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 23:02:01'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 23:02:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 23:02:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 11/30/2020 23:02:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 11/30/2020 23:02:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 23:02:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 23:02:01'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 23:02:04'!
ERROR!
!InternalRestInterface methodsFor: 'sdsa' stamp: 'AM 11/30/2020 23:02:29'!
nextTransactionId
	self shouldBeImplemented.! !
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 23:03:20' prior: 50886180!
checkOut: aCartId withCCN: aCreditCardNumber CCED: anExpirationDate CCO: anOwner on: aDate 
	
	| total creditCard newTransactionId |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	creditCard := CreditCard withNumber: aCreditCardNumber
							expiringOn:  anExpirationDate
							owner: anOwner.

	total := ( Cashier toCheckout: (self cartAt: aCartId) 
		charging: creditCard 
		through: merchantProcessor 
		on: aDate 
		registeringOn: ( self clientSalesBookFor: aCartId ))
		checkOut .
	
	newTransactionId := self nextTransactionId.
	
	sales at: newTransactionId put: (self clientSalesBookFor: aCartId) last.
	carts removeKey: aCartId .
	
	^ total.
! !

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 'AM 11/30/2020 23:03:30'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticationSystem catalog carts nextCartId merchantProcessor salesBooks clock sales nextTransactionId'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InternalRestInterface methodsFor: 'sdsa' stamp: 'AM 11/30/2020 23:03:28' prior: 50886284!
nextTransactionId
	
	nextTransactionId := nextTransactionId + 1.
	^ nextTransactionId! !

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 23:03:33'!
ERROR!
!InternalRestInterface methodsFor: 'initialization' stamp: 'AM 11/30/2020 23:04:02' prior: 50886061!
initializeWith: anAuthenticationSystem catalog: aCatalog through: aMerchantProcessor clock: aClockSimulator 
	
	authenticationSystem := anAuthenticationSystem.
	catalog := aCatalog.
	merchantProcessor := aMerchantProcessor.
	clock := aClockSimulator.
	nextCartId := 0.
	nextTransactionId := 0.
	
	carts := Dictionary new.
	salesBooks := Dictionary new.
	sales := Dictionary new.! !

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 23:04:10'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 23:04:10'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 23:04:10'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 23:04:10'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 23:04:10'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 23:04:10'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 11/30/2020 23:04:10'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 23:04:10'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 23:04:10'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 23:04:10'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 23:04:10'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:04:10'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:04:10'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 23:04:10'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 23:04:10'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 23:04:10'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 11/30/2020 23:04:10'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 11/30/2020 23:04:10'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 23:04:11'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 23:04:11'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 23:04:11'!
ERROR!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 23:04:40'!
ERROR!
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 11/30/2020 23:05:08' prior: 50886289!
checkOut: aCartId withCCN: aCreditCardNumber CCED: anExpirationDate CCO: anOwner on: aDate 
	
	| total creditCard newTransactionId |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	creditCard := CreditCard withNumber: aCreditCardNumber
							expiringOn:  anExpirationDate
							owner: anOwner.

	total := ( Cashier toCheckout: (self cartAt: aCartId) 
		charging: creditCard 
		through: merchantProcessor 
		on: aDate 
		registeringOn: ( self clientSalesBookFor: aCartId ))
		checkOut .
	
	newTransactionId := self nextTransactionId.
	
	sales at: newTransactionId put: (self clientSalesBookFor: aCartId) last.
	carts removeKey: aCartId .
	
	^ newTransactionId
! !

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 23:05:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 23:05:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 23:05:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 23:05:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 23:05:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 23:05:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 11/30/2020 23:05:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 23:05:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 23:05:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 23:05:12'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 23:05:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:05:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:05:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 23:05:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 23:05:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 23:05:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 11/30/2020 23:05:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 11/30/2020 23:05:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 23:05:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 23:05:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 23:05:12'!
FAILURE!
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 11/30/2020 23:05:55' prior: 50886155!
test08CheckOutSuccessfullyChecksOutOneCart
	
	| interface aCartId transactionId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	transactionId := interface checkOut: aCartId 
							withCCN: testObjectsFactory validCardId 
							CCED: testObjectsFactory futureExpirationDate 
							CCO: testObjectsFactory validOwner 
							on: testObjectsFactory today.
	
	self assert: (interface saleFor: transactionId) total equals: testObjectsFactory itemSellByTheStorePrice .
	self assert: (interface saleFor: transactionId) product equals: { testObjectsFactory itemSellByTheStorePrice} asBag .
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 11/30/2020 23:06:11' prior: 50886540!
test08CheckOutSuccessfullyChecksOutOneCart
	
	| interface aCartId transactionId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	transactionId := interface checkOut: aCartId 
							withCCN: testObjectsFactory validCardId 
							CCED: testObjectsFactory futureExpirationDate 
							CCO: testObjectsFactory validOwner 
							on: testObjectsFactory today.
	
	self assert: (interface saleFor: transactionId) total equals: testObjectsFactory itemSellByTheStorePrice .
	self assert: (interface saleFor: transactionId) products equals: { testObjectsFactory itemSellByTheStorePrice} asBag .
	
	! !

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 23:06:13'!
FAILURE!
!Sale methodsFor: 'accessing' stamp: 'AM 11/30/2020 23:06:26' prior: 50873497!
products
	
	^ products asBag! !

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 23:06:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 23:06:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 23:06:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 23:06:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 23:06:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 23:06:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 11/30/2020 23:06:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 23:06:31'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 23:06:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 23:06:31'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 23:06:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:06:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:06:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 23:06:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 23:06:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 23:06:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 11/30/2020 23:06:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 11/30/2020 23:06:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 23:06:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 23:06:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 23:06:34'!
FAILURE!
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 11/30/2020 23:06:59' prior: 50886569!
test08CheckOutSuccessfullyChecksOutOneCart
	
	| interface aCartId transactionId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	transactionId := interface checkOut: aCartId 
							withCCN: testObjectsFactory validCardId 
							CCED: testObjectsFactory futureExpirationDate 
							CCO: testObjectsFactory validOwner 
							on: testObjectsFactory today.
	
	self assert: (interface saleFor: transactionId) total equals: testObjectsFactory itemSellByTheStorePrice .
	self assert: (interface saleFor: transactionId) products equals: { testObjectsFactory itemSellByTheStore} asBag .
	
	! !

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 23:07:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 23:07:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 23:07:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 23:07:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 23:07:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 23:07:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 23:07:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 11/30/2020 23:07:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 23:07:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 23:07:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 23:07:00'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 23:07:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:07:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:07:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 23:07:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 23:07:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 23:07:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 11/30/2020 23:07:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 11/30/2020 23:07:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 23:07:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 23:07:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 23:07:00'!
FAILURE!
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 11/30/2020 23:07:25' prior: 50882987!
test10FailedCheckOutShouldNotInvalidateFutureCheckOut
	
	| interface aCartId transactionId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .

	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	[ interface checkOut: aCartId withCCN: testObjectsFactory validCardId CCED: testObjectsFactory pastExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today. ] on: Error do: [:anError | ].

	transactionId := interface checkOut: aCartId withCCN: testObjectsFactory validCardId CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	
	self assert: transactionId equals: testObjectsFactory itemSellByTheStorePrice .
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 11/30/2020 23:07:34' prior: 50886797!
test10FailedCheckOutShouldNotInvalidateFutureCheckOut
	
	| interface aCartId transactionId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .

	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	[ interface checkOut: aCartId withCCN: testObjectsFactory validCardId CCED: testObjectsFactory pastExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today. ] on: Error do: [:anError | ].

	transactionId := interface checkOut: aCartId withCCN: testObjectsFactory validCardId CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	
	self assert: (interface saleFor: transactionId) total equals: testObjectsFactory itemSellByTheStorePrice .
	self assert: (interface saleFor: transactionId) products equals: { testObjectsFactory itemSellByTheStore} asBag .	
	! !

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 23:07:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 23:07:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 23:07:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 23:07:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 23:07:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 23:07:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 23:07:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 11/30/2020 23:07:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 23:07:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 23:07:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 23:07:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 23:07:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:07:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:07:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 23:07:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 23:07:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 23:07:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 11/30/2020 23:07:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 11/30/2020 23:07:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 23:07:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 23:07:36'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 11/30/2020 23:08:04' prior: 50882841!
test09ShouldNotCheckOutAnAlreadyCheckedOutCart
	
	| interface aCartId |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	interface checkOut: aCartId withCCN: testObjectsFactory validCardId CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	
	self should: [ interface checkOut: aCartId 
						withCCN: testObjectsFactory notExpiredCreditCard 
						CCED: testObjectsFactory futureExpirationDate
						CCO: testObjectsFactory validOwner 
						on: testObjectsFactory today ]
		raise: Error
		withMessageText: InternalRestInterface invalidCartIdErrorDescription . 
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 11/30/2020 23:08:20' prior: 50886941!
test09ShouldNotCheckOutAnAlreadyCheckedOutCart
	
	| interface aCartId |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	interface checkOut: aCartId 
			withCCN: testObjectsFactory validCardId 
			CCED: testObjectsFactory futureExpirationDate 
			CCO: testObjectsFactory validOwner 
			on: testObjectsFactory today.
	
	self should: [ interface checkOut: aCartId 
						withCCN: testObjectsFactory notExpiredCreditCard 
						CCED: testObjectsFactory futureExpirationDate
						CCO: testObjectsFactory validOwner 
						on: testObjectsFactory today ]
		raise: Error
		withMessageText: InternalRestInterface invalidCartIdErrorDescription . 
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 11/30/2020 23:09:15' prior: 50886971!
test09ShouldNotCheckOutAnAlreadyCheckedOutCart
	
	| interface aCartId |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	interface checkOut: aCartId 
			withCCN: testObjectsFactory validCardId 
			CCED: testObjectsFactory futureExpirationDate 
			CCO: testObjectsFactory validOwner 
			on: testObjectsFactory today.
	
	self should: [ interface checkOut: aCartId 
						withCCN: testObjectsFactory validCardId 
						CCED: testObjectsFactory futureExpirationDate
						CCO: testObjectsFactory validOwner 
						on: testObjectsFactory today ]
		raise: Error
		withMessageText: InternalRestInterface invalidCartIdErrorDescription . 
	
	! !

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 23:09:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 23:09:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 23:09:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 23:09:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 23:09:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 23:09:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 23:09:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 11/30/2020 23:09:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 23:09:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 23:09:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 23:09:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 23:09:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:09:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:09:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 23:09:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 23:09:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 23:09:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 11/30/2020 23:09:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 11/30/2020 23:09:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 23:09:17'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 23:09:17'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 11/30/2020 23:11:05' prior: 50872872!
test03NewCartShouldBeEmpty
	
	| interface aCartId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser 
						password: testObjectsFactory validPassword.

	self assert: ( interface listCart: aCartId ) isEmpty .
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 11/30/2020 23:11:13' prior: 50876947!
test04AddingToCartSuccessfullyAddsToOneCart
	
	| interface aCartId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword.
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore withOcurrences: 2.


	self assert: (interface listCart: aCartId ) equals: { testObjectsFactory itemSellByTheStore. 
												 testObjectsFactory itemSellByTheStore. 
												 testObjectsFactory itemSellByTheStore} asBag.
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 11/30/2020 23:11:20' prior: 50887123!
test04AddingToCartSuccessfullyAddsToOneCart
	
	| interface aCartId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword.
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore .
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore 
			withOcurrences: 2.


	self assert: (interface listCart: aCartId ) equals: { testObjectsFactory itemSellByTheStore. 
												 testObjectsFactory itemSellByTheStore. 
												 testObjectsFactory itemSellByTheStore} asBag.
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 11/30/2020 23:11:23' prior: 50887147!
test04AddingToCartSuccessfullyAddsToOneCart
	
	| interface aCartId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword.
	
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore .
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore 
			withOcurrences: 2.


	self assert: (interface listCart: aCartId ) equals: { testObjectsFactory itemSellByTheStore. 
												 testObjectsFactory itemSellByTheStore. 
												 testObjectsFactory itemSellByTheStore} asBag.
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 11/30/2020 23:11:30' prior: 50887171!
test04AddingToCartSuccessfullyAddsToOneCart
	
	| interface aCartId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser 
						password: testObjectsFactory validPassword.
	
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore .
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore 
			withOcurrences: 2.


	self assert: (interface listCart: aCartId ) equals: { testObjectsFactory itemSellByTheStore. 
												 testObjectsFactory itemSellByTheStore. 
												 testObjectsFactory itemSellByTheStore} asBag.
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 11/30/2020 23:11:58' prior: 50877050!
test05AddingToCartSuccessfullyAddsToManyCarts
	
	| interface fortCartId maradonaCartId |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	maradonaCartId := interface createCartForUser: testObjectsFactory validUser 
							password: testObjectsFactory validPassword .
	fortCartId := interface createCartForUser: testObjectsFactory anotherValidUser 
						password: testObjectsFactory anotherValidPassword .
	
	interface addToCart: maradonaCartId product: testObjectsFactory itemSellByTheStore .

	self assert: ( interface listCart: maradonaCartId ) equals: { testObjectsFactory itemSellByTheStore } asBag.
	self assert: ( ( interface listCart: fortCartId ) isEmpty ).

	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 11/30/2020 23:12:03' prior: 50887220!
test05AddingToCartSuccessfullyAddsToManyCarts
	
	| interface fortCartId maradonaCartId |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	maradonaCartId := interface createCartForUser: testObjectsFactory validUser 
							password: testObjectsFactory validPassword .
	fortCartId := interface createCartForUser: testObjectsFactory anotherValidUser 
						password: testObjectsFactory anotherValidPassword .
	
	interface addToCart: maradonaCartId 
			product: testObjectsFactory itemSellByTheStore .

	self assert: ( interface listCart: maradonaCartId ) equals: { testObjectsFactory itemSellByTheStore } asBag.
	self assert: ( ( interface listCart: fortCartId ) isEmpty ).

	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 11/30/2020 23:12:18' prior: 50877158!
test06ListingCartShouldNotListOnInvalidCartId
	
	| interface |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	self should: [ interface listCart: testObjectsFactory invalidCartId ]
		raise: Error - MessageNotUnderstood 
		withMessageText: InternalRestInterface invalidCartIdErrorDescription .

	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 11/30/2020 23:12:25' prior: 50884843!
test07ShouldNotAddToInvalidCartId
	
	| interface |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	self should: [ interface addToCart: testObjectsFactory invalidCartId product: testObjectsFactory itemSellByTheStore ]
		raise: Error - MessageNotUnderstood 
		withMessageText: InternalRestInterface invalidCartIdErrorDescription .

	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 11/30/2020 23:12:47' prior: 50886827!
test10FailedCheckOutShouldNotInvalidateFutureCheckOut
	
	| interface aCartId transactionId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .

	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	[ interface checkOut: aCartId 
			withCCN: testObjectsFactory validCardId 
			CCED: testObjectsFactory pastExpirationDate 
			CCO: testObjectsFactory validOwner 
			on: testObjectsFactory today. ] on: Error do: [:anError | ].

	transactionId := interface checkOut: aCartId withCCN: testObjectsFactory validCardId CCED: testObjectsFactory futureExpirationDate CCO: testObjectsFactory validOwner on: testObjectsFactory today.
	
	self assert: (interface saleFor: transactionId) total equals: testObjectsFactory itemSellByTheStorePrice .
	self assert: (interface saleFor: transactionId) products equals: { testObjectsFactory itemSellByTheStore} asBag .	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 11/30/2020 23:13:04' prior: 50887301!
test10FailedCheckOutShouldNotInvalidateFutureCheckOut
	
	| interface aCartId transactionId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .

	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	[ interface checkOut: aCartId 
			withCCN: testObjectsFactory validCardId 
			CCED: testObjectsFactory pastExpirationDate 
			CCO: testObjectsFactory validOwner 
			on: testObjectsFactory today. ] on: Error do: [:anError | ].

	transactionId := interface checkOut: aCartId 
							withCCN: testObjectsFactory validCardId 
							CCED: testObjectsFactory futureExpirationDate 
							CCO: testObjectsFactory validOwner 
							on: testObjectsFactory today.
	
	self assert: (interface saleFor: transactionId) total equals: testObjectsFactory itemSellByTheStorePrice .
	self assert: (interface saleFor: transactionId) products equals: { testObjectsFactory itemSellByTheStore} asBag .	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 11/30/2020 23:13:26' prior: 50884596!
test17ShouldNotAddWhenCartTimedOut
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore. ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] 
				raise: Error 
				withMessageText: InternalRestInterface invalidCartIdErrorDescription
			]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 11/30/2020 23:14:08' prior: 50884729!
test19ShouldNotCheckOutATimedOutCart
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	clock addToTime: 30*minute.
	
	self should: [ interface checkOut: aCartId 
						withCCN: testObjectsFactory notExpiredCreditCard 
						CCED: testObjectsFactory futureExpirationDate 
						CCO: testObjectsFactory validOwner 
						on: testObjectsFactory today ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] 
				raise: Error 
				withMessageText: InternalRestInterface invalidCartIdErrorDescription
			]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 11/30/2020 23:14:51' prior: 50879004!
test20TimeOutTimeIsResetAfterAnyOperation
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 	
	
	self shouldnt: [ clock addToTime: 29*minute.
				interface listCart: aCartId .
				clock addToTime: 29*minute.
				interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
				clock addToTime: 29*minute.
				[ interface checkOut: aCartId 
						withCCN: testObjectsFactory validCardId 
						CCED: testObjectsFactory pastExpirationDate
						CCO: testObjectsFactory validOwner on: testObjectsFactory today ] on: Error do: [:anError | ].
				clock addToTime: 29*minute.
				interface listCart: aCartId ]
		raise: Error.
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 11/30/2020 23:15:03' prior: 50887439!
test20TimeOutTimeIsResetAfterAnyOperation
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 	
	
	self shouldnt: [ clock addToTime: 29*minute.
				interface listCart: aCartId .
				clock addToTime: 29*minute.
				interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
				clock addToTime: 29*minute.
				[ interface checkOut: aCartId 
						withCCN: testObjectsFactory validCardId 
						CCED: testObjectsFactory pastExpirationDate
						CCO: testObjectsFactory validOwner 
						on: testObjectsFactory today ] 
					on: Error 
					do: [:anError | ].
				clock addToTime: 29*minute.
				interface listCart: aCartId ]
		raise: Error.
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 11/30/2020 23:15:26' prior: 50887474!
test20TimeOutTimeIsResetAfterAnyOperation
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser 
						password: testObjectsFactory validPassword. 	
	
	self shouldnt: [ clock addToTime: 29*minute.
				interface listCart: aCartId .
				clock addToTime: 29*minute.
				interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
				clock addToTime: 29*minute.
				[ interface checkOut: aCartId 
						withCCN: testObjectsFactory validCardId 
						CCED: testObjectsFactory pastExpirationDate
						CCO: testObjectsFactory validOwner 
						on: testObjectsFactory today ] 
					on: Error 
					do: [:anError | ].
				clock addToTime: 29*minute.
				interface listCart: aCartId ]
		raise: Error.
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - credentials' stamp: 'AM 11/30/2020 23:16:04' prior: 50873024!
test01UnknownUserShouldNotCreateCart
	
	| interface |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	self should: [ interface createCartForUser: testObjectsFactory invalidUser password: testObjectsFactory invalidPassword ]
		raise: Error - MessageNotUnderstood
		withMessageText: AuthenticationSystemSimulator invalidUserErrorDescription.
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - credentials' stamp: 'AM 11/30/2020 23:16:09' prior: 50883528!
test02WrongPasswordShouldNotCreateCart
	
	| interface |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	self should: [ interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory invalidPassword ]
		raise: Error
		withMessageText: AuthenticationSystemSimulator invalidPasswordErrorDescription.
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - credentials' stamp: 'AM 11/30/2020 23:16:13' prior: 50873054!
test15InvalidUserShouldNotListPurchases
	
	| interface |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	self should: [ interface listPurchasesOf: testObjectsFactory invalidUser password: testObjectsFactory validPassword ]
		raise: Error
		withMessageText: AuthenticationSystemSimulator invalidUserErrorDescription .
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - credentials' stamp: 'AM 11/30/2020 23:16:17' prior: 50873068!
test16InvalidPasswordShouldNotListPurchases
	
	| interface |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	self should: [ interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory invalidPassword ]
		raise: Error
		withMessageText: AuthenticationSystemSimulator invalidPasswordErrorDescription .
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 11/30/2020 23:16:41' prior: 50885205!
test12ListOnePurchaseSuccessfully
	
	| interface aCartId purchases |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	interface checkOut: aCartId 
			withCCN: testObjectsFactory validCardId 
			CCED: testObjectsFactory futureExpirationDate 
			CCO: testObjectsFactory validOwner 
			on: testObjectsFactory today.
			
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: purchases total equals: testObjectsFactory itemSellByTheStorePrice .
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag.
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 11/30/2020 23:17:02' prior: 50885238!
test13ListMoreThanOnePurchaseSuccessfully
	
	| interface aCartId purchases |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	2 timesRepeat: [ 
		aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
		interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
		interface checkOut: aCartId 
				withCCN: testObjectsFactory validCardId 
				CCED: testObjectsFactory futureExpirationDate 
				CCO: testObjectsFactory validOwner 
				on: testObjectsFactory today 
		].
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice * 2 equals: purchases total.
	self assert: purchases products equals: { testObjectsFactory itemSellByTheStore. testObjectsFactory itemSellByTheStore } asBag.
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 11/30/2020 23:18:52' prior: 50885273!
test14ListPurchasesFromMoreThanOneUser
	
	| interface aCartId purchases |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser 
					password: testObjectsFactory validPassword .
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore .
	interface checkOut: aCartId 
			withCCN: testObjectsFactory validCardId 
			CCED: testObjectsFactory futureExpirationDate 
			CCO: testObjectsFactory validOwner 
			on: testObjectsFactory today.
	
	aCartId := interface createCartForUser: testObjectsFactory anotherValidUser 
					password: testObjectsFactory anotherValidPassword .
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore .
	interface checkOut: aCartId 
			withCCN: testObjectsFactory validCardId 
			CCED: testObjectsFactory futureExpirationDate 
			CCO: testObjectsFactory validOwner 
			on: testObjectsFactory today.
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser 
						password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice equals: purchases total.
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag
	
	! !
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 11/30/2020 23:21:57'!
nextCartId
	
	nextCartId := nextCartId + 1.
	^ nextCartId.! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 23:21:57' prior: 50884021!
createCartForUser: anUser password: aPassword 
	
	| newCartId |
	
	authenticationSystem authenticate: anUser using: aPassword .
	
	newCartId := self nextCartId.
	
	carts at: newCartId put: (InterfaceCartData cart: (Cart acceptingItemsOf: catalog)
											client: anUser
											lastTimeUsed: clock now).
	
	salesBooks at: anUser ifAbsentPut: OrderedCollection new.
	
	^ newCartId. ! !

!methodRemoval: InternalRestInterface #newCartId stamp: 'AM 11/30/2020 23:21:57'!
newCartId
	
	nextCartId := nextCartId + 1.
	^ nextCartId.!
!InternalRestInterface methodsFor: 'initialization' stamp: 'AM 11/30/2020 23:24:33' prior: 50886336!
initializeWith: anAuthenticationSystem catalog: aCatalog through: aMerchantProcessor clock: aClockSimulator 
	
	authenticationSystem := anAuthenticationSystem.
	catalog := aCatalog.
	merchantProcessor := aMerchantProcessor.
	clock := aClockSimulator.
	nextCartId := 0.
	nextTransactionId := 0.
	
	carts := Dictionary new.
	
	salesBooks := Dictionary new.
	sales := Dictionary new.! !
!InternalRestInterface methodsFor: 'initialization' stamp: 'AM 11/30/2020 23:26:28' prior: 50887736!
initializeWith: anAuthenticationSystem catalog: aCatalog through: aMerchantProcessor clock: aClockSimulator 
	
	authenticationSystem := anAuthenticationSystem.
	catalog := aCatalog.
	merchantProcessor := aMerchantProcessor.
	clock := aClockSimulator.
	
	nextCartId := 0.
	nextTransactionId := 0.
	
	carts := Dictionary new.
	
	salesBooks := Dictionary new.
	sales := Dictionary new.! !

!classRenamed: #Purchase as: #PurchaseList stamp: 'AM 11/30/2020 23:29:41'!
Smalltalk renameClassNamed: #Purchase as: #PurchaseList!
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 23:29:42' prior: 50873719!
listPurchasesOf: aClientId password: aPassword 
	 
	| purchase |
	
	authenticationSystem authenticate: aClientId using: aPassword .
	
	purchase := PurchaseList new.
	
	( salesBooks at: aClientId ifAbsent: [ ^ purchase ] ) do: [ :aSale | purchase addSale: aSale ].
	
	^ purchase.
	! !
!InternalRestInterface methodsFor: 'client purchases' stamp: 'AM 11/30/2020 23:31:30' prior: 50887772!
listPurchasesOf: aClientId password: aPassword 
	 
	| purchase |
	
	authenticationSystem authenticate: aClientId using: aPassword .
	
	purchase := PurchaseList new.
	
	(self salesBookForClient: aClientId) 
		do: [ :aSale | purchase addSale: aSale ].
	
	^ purchase.
	! !
!InternalRestInterface methodsFor: 'client purchases' stamp: 'AM 11/30/2020 23:31:43' prior: 50887785!
listPurchasesOf: aClientId password: aPassword 
	 
	| purchase |
	
	authenticationSystem authenticate: aClientId using: aPassword .
	
	purchase := PurchaseList new.
	
	(self salesBookForClient: aClientId) 
		do: [ :aSale | purchase addSale: aSale ].
	
	^ purchase.
	! !

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 23:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 23:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 23:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 23:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 23:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 23:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 11/30/2020 23:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 23:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 23:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 23:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 23:32:15'!
ERROR!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:32:15'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:32:15'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 23:32:15'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 23:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 23:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 11/30/2020 23:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 11/30/2020 23:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 23:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 23:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 23:32:18'!
ERROR!
!InternalRestInterface methodsFor: 'accessing' stamp: 'AM 11/30/2020 23:32:28'!
salesBookForClient: aString 
	self shouldBeImplemented.! !
!InternalRestInterface methodsFor: 'accessing' stamp: 'AM 11/30/2020 23:32:34' prior: 50887887!
salesBookForClient: aClient 
	self shouldBeImplemented.! !
!InternalRestInterface methodsFor: 'accessing' stamp: 'AM 11/30/2020 23:33:01' prior: 50887892!
salesBookForClient: aClient 

	^ salesBooks at: aClient ifAbsent: [ OrderedCollection new]! !
!InternalRestInterface methodsFor: 'accessing' stamp: 'AM 11/30/2020 23:33:08' prior: 50887897!
salesBookForClient: aClient 

	^ salesBooks at: aClient ifAbsent: [ OrderedCollection new ]! !

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 23:33:10'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:33:11'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:33:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 23:33:15'!
PASSED!
!InternalRestInterface methodsFor: 'accessing' stamp: 'AM 11/30/2020 23:33:36'!
salesBookFor: aClient 

	^ salesBooks at: aClient ifAbsent: [ OrderedCollection new ]! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 23:33:36' prior: 50887797!
listPurchasesOf: aClientId password: aPassword 
	 
	| purchase |
	
	authenticationSystem authenticate: aClientId using: aPassword .
	
	purchase := PurchaseList new.
	
	(self salesBookFor: aClientId) 
		do: [ :aSale | purchase addSale: aSale ].
	
	^ purchase.
	! !

!methodRemoval: InternalRestInterface #salesBookForClient: stamp: 'AM 11/30/2020 23:33:37'!
salesBookForClient: aClient 

	^ salesBooks at: aClient ifAbsent: [ OrderedCollection new ]!
!InternalRestInterface methodsFor: 'client purchases' stamp: 'AM 11/30/2020 23:40:27' prior: 50887931!
listPurchasesOf: aClientId password: aPassword 
	
	authenticationSystem authenticate: aClientId using: aPassword .
	
	^ PurchaseList withSalesBook: (self salesBookFor: aClientId).
	! !

!classRenamed: #PurchaseList as: #Purchases stamp: 'AM 11/30/2020 23:42:18'!
Smalltalk renameClassNamed: #PurchaseList as: #Purchases!
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 23:42:19' prior: 50887949!
listPurchasesOf: aClientId password: aPassword 
	
	authenticationSystem authenticate: aClientId using: aPassword .
	
	^ Purchases withSalesBook: (self salesBookFor: aClientId).
	! !

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 23:45:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 23:45:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 23:45:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 23:45:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 23:45:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 23:45:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 11/30/2020 23:45:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 23:45:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 23:45:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 23:45:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 23:45:20'!
ERROR!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:45:20'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:45:20'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 23:45:20'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 23:45:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 23:45:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 11/30/2020 23:45:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 11/30/2020 23:45:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 23:45:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 23:45:20'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 23:45:23'!
ERROR!
!Purchases class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 23:45:33'!
withSalesBook: anOrderedCollection 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeWithSalesBook: anOrderedCollection ! !
!Purchases class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 23:45:57' prior: 50888050!
withSalesBook: aSalesBook

	^self new initializeWithSalesBook: aSalesBook ! !
!Purchases class methodsFor: 'instance creation' stamp: 'AM 11/30/2020 23:46:00' prior: 50888060!
withSalesBook: aSalesBook

	^ self new initializeWithSalesBook: aSalesBook ! !

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 23:46:05'!
ERROR!

!classDefinition: #Purchases category: 'TusLibros' stamp: 'AM 11/30/2020 23:46:15'!
Object subclass: #Purchases
	instanceVariableNames: 'total products salesBook'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Purchases methodsFor: 'initialization' stamp: 'AM 11/30/2020 23:46:15'!
initializeWithSalesBook: aSalesBook 
	self shouldBeImplemented.
	salesBook := aSalesBook.! !
!Purchases methodsFor: 'initialization' stamp: 'AM 11/30/2020 23:47:42' prior: 50888082!
initializeWithSalesBook: aSalesBook 
	
	total  := aSalesBook sum: [ :aSale | aSale total ] ifEmpty: [ 0 ].
	products := (aSalesBook collect: [ :aSale | aSale products ]) flatten.! !

aSalesBook collect: [ :aSale | aSale products ]!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 23:48:07'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:48:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:48:11'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 23:48:13'!
PASSED!

!methodRemoval: Purchases #initialize stamp: 'AM 11/30/2020 23:51:35'!
initialize
		 
	total := 0.
	products := OrderedCollection new.!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 23:51:42'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 23:51:42'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 23:51:42'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 23:51:42'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 23:51:42'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 23:51:42'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 23:51:43'!
PASSED!

Object subclass: #SalesBook
	instanceVariableNames: 'total products'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #SalesBook category: 'TusLibros' stamp: 'AM 11/30/2020 23:52:02'!
Object subclass: #SalesBook
	instanceVariableNames: 'total products'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #SalesBook category: 'TusLibros' stamp: 'AM 11/30/2020 23:52:16'!
Object subclass: #SalesBook
	instanceVariableNames: 'total products sales'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!SalesBook methodsFor: 'nil' stamp: 'AM 11/30/2020 23:52:14'!
add: aSale

	sales add: aSale! !
!SalesBook methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 23:52:51'!
total

	sales sum: [ :aSale | aSale total] ifEmpty: [ 0 ]! !
!SalesBook methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 23:52:55' prior: 50888283!
total

	sales sum: [ :aSale | aSale total] 
		ifEmpty: [ 0 ]! !
!SalesBook methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 23:52:58' prior: 50888288!
total

	sales sum: [ :aSale | aSale total ] 
		ifEmpty: [ 0 ]! !

!classRenamed: #Purchases as: #PurchaseBOok stamp: 'AM 11/30/2020 23:55:07'!
Smalltalk renameClassNamed: #Purchases as: #PurchaseBOok!
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 23:55:09' prior: 50887963!
listPurchasesOf: aClientId password: aPassword 
	
	authenticationSystem authenticate: aClientId using: aPassword .
	
	^ PurchaseBOok withSalesBook: (self salesBookFor: aClientId).
	! !

!classRenamed: #PurchaseBOok as: #PurchaseBook stamp: 'AM 11/30/2020 23:55:17'!
Smalltalk renameClassNamed: #PurchaseBOok as: #PurchaseBook!
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'AM 11/30/2020 23:55:18' prior: 50888303!
listPurchasesOf: aClientId password: aPassword 
	
	authenticationSystem authenticate: aClientId using: aPassword .
	
	^ PurchaseBook withSalesBook: (self salesBookFor: aClientId).
	! !
!StoreTestObjectsFactory methodsFor: 'authentication system' stamp: 'AM 11/30/2020 23:58:31' prior: 50873549!
authenticationSystem
	
	| credentials |
	
	credentials := Dictionary new 
				at: self validUser put: self validPassword;
				at: self anotherValidUser put: self anotherValidPassword.
	
	^ AuthenticationSystemSimulator withCredentials: credentials.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 23:58:34'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 23:58:34'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 23:58:34'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 23:58:34'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 23:58:34'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 23:58:34'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 23:58:34'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 23:58:34'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 23:58:34'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 23:58:34'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 23:58:34'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 23:58:34'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 23:58:34'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 23:58:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 23:58:34'!
ERROR!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 23:58:34'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 23:58:34'!
ERROR!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 23:58:34'!
ERROR!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 23:58:34'!
ERROR!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 23:58:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 11/30/2020 23:58:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 23:58:34'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 23:58:34'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 23:58:34'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 23:58:34'!
ERROR!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:58:34'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:58:34'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 23:58:34'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 23:58:34'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 23:58:34'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 11/30/2020 23:58:34'!
ERROR!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 11/30/2020 23:58:34'!
ERROR!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 23:58:34'!
ERROR!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 23:58:34'!
ERROR!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 23:58:34'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 23:58:34'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 23:58:34'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 23:58:34'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 23:58:34'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 23:58:34'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 23:58:34'!
PASSED!
!StoreTestObjectsFactory methodsFor: 'authentication system' stamp: 'NNH 11/29/2020 22:55:12' prior: 50888327!
authenticationSystem
	
	| credentials |
	
	credentials := Dictionary new.
	credentials add: self validUser -> self validPassword.
	credentials add: self anotherValidUser -> self anotherValidPassword.
	
	^ AuthenticationSystemSimulator withCredentials: credentials.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 11/30/2020 23:59:39'!
PASSED!

----SNAPSHOT----(30 November 2020 23:59:48) CuisUniversity-4384.image priorSource: 17703056!

----QUIT----(30 November 2020 23:59:57) CuisUniversity-4384.image priorSource: 17823599!

----STARTUP---- (2 December 2020 18:16:27) as /home/agustin/Escritorio/Uba/Materias/Compu/ISW1/TusLibros/CuisUniversity-4384.image!

!SalesBook methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 18:17:54'!
products

	^ (sales collect: [ :aSale | aSale products ]) flatten! !
!SalesBook methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 18:19:00' prior: 50888648!
products

	^ (sales collect: [ :aSale | aSale products ]) flatten asBag! !
!InternalRestInterface methodsFor: 'accessing' stamp: 'AM 12/2/2020 18:20:03' prior: 50884375!
clientSalesBookFor: aCartId 
	
	^ salesBooks at: (self clientUsingCart: aCartId)! !
!SalesBook methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 18:21:44'!
last

	^ sales last! !
!InternalRestInterface methodsFor: 'client purchases' stamp: 'AM 12/2/2020 18:24:45' prior: 50888317!
listPurchasesOf: aClientId password: aPassword 
	
	authenticationSystem authenticate: aClientId using: aPassword .
	
	^ self salesBookFor: aClientId ! !

!classRemoval: #PurchaseBook stamp: 'AM 12/2/2020 18:24:57'!
Object subclass: #PurchaseBook
	instanceVariableNames: 'total products salesBook'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 18:25:03'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 18:25:03'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 18:25:03'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 18:25:03'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 18:25:03'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 18:25:03'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 18:25:03'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 18:25:03'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 18:25:03'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 18:25:03'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 18:25:03'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 18:25:03'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 18:25:03'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 18:25:03'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 18:25:03'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 18:25:03'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 18:25:03'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 18:25:03'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 18:25:03'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 18:25:03'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 18:25:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 18:25:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 18:25:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 18:25:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 18:25:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 18:25:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 18:25:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 18:25:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 18:25:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 18:25:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 18:25:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 18:25:04'!
ERROR!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 18:25:04'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 18:25:04'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 18:25:04'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 18:25:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 18:25:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 18:25:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 18:25:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 18:25:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 18:25:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 18:25:08'!
ERROR!
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 12/2/2020 18:25:30' prior: 50887716!
createCartForUser: anUser password: aPassword 
	
	| newCartId |
	
	authenticationSystem authenticate: anUser using: aPassword .
	
	newCartId := self nextCartId.
	
	carts at: newCartId put: (InterfaceCartData cart: (Cart acceptingItemsOf: catalog)
											client: anUser
											lastTimeUsed: clock now).
	
	salesBooks at: anUser ifAbsentPut: SalesBook new.
	
	^ newCartId. ! !

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 18:25:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 18:25:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 18:25:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 18:25:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 18:25:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 18:25:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 18:25:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 18:25:31'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 18:25:31'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 18:25:31'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 18:25:32'!
ERROR!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 18:25:32'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 18:25:32'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 18:25:32'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 18:25:32'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 18:25:32'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 18:25:32'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 18:25:32'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 18:25:32'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 18:25:32'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 18:25:37'!
ERROR!
!SalesBook methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 18:26:09' overrides: 16896425!
initialize

	sales := OrderedCollection new.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 18:26:16'!
ERROR!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 18:26:16'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 18:26:16'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 18:26:16'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 18:26:16'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 18:26:19'!
ERROR!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 18:26:34'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 18:26:35'!
ERROR!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 18:26:35'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 18:26:35'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 18:26:35'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 18:26:35'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 18:26:38'!
ERROR!
!InternalRestInterface methodsFor: 'accessing' stamp: 'AM 12/2/2020 18:27:07' prior: 50887924!
salesBookFor: aClient 

	^ salesBooks at: aClient ifAbsent: [ SalesBook new ]! !

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 18:27:12'!
FAILURE!
!SalesBook methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 18:27:54' prior: 50888293!
total

	^ sales sum: [ :aSale | aSale total ] 
		ifEmpty: [ 0 ]! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 18:27:55'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 18:27:55'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 18:27:55'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 18:27:55'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 18:27:55'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 18:27:55'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 18:27:55'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 18:27:55'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 18:27:55'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 18:27:55'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 18:27:55'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 18:27:56'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 18:27:56'!
PASSED!
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 12/2/2020 18:29:14' prior: 50886434!
checkOut: aCartId withCCN: aCreditCardNumber CCED: anExpirationDate CCO: anOwner on: aDate 
	
	| total creditCard newTransactionId |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	creditCard := CreditCard withNumber: aCreditCardNumber
							expiringOn:  anExpirationDate
							owner: anOwner.

	total := ( Cashier toCheckout: (self cartAt: aCartId) 
		charging: creditCard 
		through: merchantProcessor 
		on: aDate 
		registeringOn: ( self clientSalesBookFor: aCartId ))
		checkOut .
	
	newTransactionId := self nextTransactionId. " Aaca obtenemos un nuevo id"
	
	sales at: newTransactionId put: (self clientSalesBookFor: aCartId) last. "Aca seteamos para ese id la ultima venta"
	
	carts removeKey: aCartId .
	
	^ newTransactionId
! !
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 12/2/2020 18:29:25' prior: 50889381!
checkOut: aCartId withCCN: aCreditCardNumber CCED: anExpirationDate CCO: anOwner on: aDate 
	
	| creditCard newTransactionId |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	creditCard := CreditCard withNumber: aCreditCardNumber
							expiringOn:  anExpirationDate
							owner: anOwner.

	( Cashier toCheckout: (self cartAt: aCartId) 
		charging: creditCard 
		through: merchantProcessor 
		on: aDate 
		registeringOn: ( self clientSalesBookFor: aCartId ))
		checkOut .
	
	newTransactionId := self nextTransactionId. " Aaca obtenemos un nuevo id"
	
	sales at: newTransactionId put: (self clientSalesBookFor: aCartId) last. "Aca seteamos para ese id la ultima venta"
	
	carts removeKey: aCartId .
	
	^ newTransactionId
! !
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 12/2/2020 18:29:33' prior: 50889410!
checkOut: aCartId withCCN: aCreditCardNumber CCED: anExpirationDate CCO: anOwner on: aDate 
	
	| creditCard newTransactionId |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	creditCard := CreditCard withNumber: aCreditCardNumber
							expiringOn:  anExpirationDate
							owner: anOwner.

	( Cashier toCheckout: (self cartAt: aCartId) 
		charging: creditCard 
		through: merchantProcessor 
		on: aDate 
		registeringOn: ( self clientSalesBookFor: aCartId ))
		checkOut .
	
	newTransactionId := self nextTransactionId. " Aaca obtenemos un nuevo id"
	
	sales at: newTransactionId put: (self clientSalesBookFor: aCartId) last. "Aca seteamos para ese id la ultima venta"
	
	carts removeKey: aCartId .
	
	^ newTransactionId
! !
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 12/2/2020 18:32:11' prior: 50889439!
checkOut: aCartId withCCN: aCreditCardNumber CCED: anExpirationDate CCO: anOwner on: aDate 
	
	| creditCard newTransactionId |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	creditCard := CreditCard withNumber: aCreditCardNumber
							expiringOn:  anExpirationDate
							owner: anOwner.

	( Cashier toCheckout: (self cartAt: aCartId) 
		charging: creditCard 
		through: merchantProcessor 
		on: aDate 
		registeringOn: ( self clientSalesBookFor: aCartId ))
		checkOut .
	
	newTransactionId := self nextTransactionId. " Aaca obtenemos un nuevo id"
	
	"sales at: newTransactionId put: (self clientSalesBookFor: aCartId) last. Aca seteamos para ese id la ultima venta"
	
	carts removeKey: aCartId .
	
	^ newTransactionId
! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 18:32:14'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 18:32:14'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 18:32:14'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 18:32:14'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 18:32:14'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 18:32:14'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 18:32:14'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 18:32:14'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 18:32:15'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 18:32:15'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 18:32:15'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 18:32:15'!
PASSED!
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 12/2/2020 18:39:22' prior: 50889468!
checkOut: aCartId withCCN: aCreditCardNumber CCED: anExpirationDate CCO: anOwner on: aDate 
	
	| creditCard newTransactionId |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	creditCard := CreditCard withNumber: aCreditCardNumber
							expiringOn:  anExpirationDate
							owner: anOwner.

	( Cashier toCheckout: (self cartAt: aCartId) 
		charging: creditCard 
		through: merchantProcessor 
		on: aDate 
		registeringOn: ( self clientSalesBookFor: aCartId ))
		checkOut .
	
	newTransactionId := self nextTransactionId. " Aaca obtenemos un nuevo id"
	
	sales at: newTransactionId put: (self clientSalesBookFor: aCartId) last. " Aca seteamos para ese id la ultima venta"
	
	carts removeKey: aCartId .
	
	^ newTransactionId
! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 18:39:23'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 18:39:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 18:39:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 18:39:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 18:39:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 18:39:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 18:39:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 18:39:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 18:39:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 18:39:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 18:39:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 18:39:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 18:39:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 18:39:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 18:39:24'!
PASSED!
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 12/2/2020 18:40:22' prior: 50889639!
checkOut: aCartId withCCN: aCreditCardNumber CCED: anExpirationDate CCO: anOwner on: aDate 
	
	| creditCard newTransactionId |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	creditCard := CreditCard withNumber: aCreditCardNumber
							expiringOn:  anExpirationDate
							owner: anOwner.

	( Cashier toCheckout: (self cartAt: aCartId) charging: creditCard through: merchantProcessor on: aDate registeringOn: ( self clientSalesBookFor: aCartId )) checkOut .
	
	newTransactionId := self nextTransactionId. " Aaca obtenemos un nuevo id"
	
	sales at: newTransactionId put: (self clientSalesBookFor: aCartId) last. " Aca seteamos para ese id la ultima venta"
	
	carts removeKey: aCartId .
	
	^ newTransactionId
! !
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 12/2/2020 18:41:13' prior: 50889811!
checkOut: aCartId withCCN: aCreditCardNumber CCED: anExpirationDate CCO: anOwner on: aDate 
	
	| creditCard newTransactionId |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	creditCard := CreditCard withNumber: aCreditCardNumber
							expiringOn:  anExpirationDate
							owner: anOwner.

	self checkOut: aCartId with: creditCard on: aDate.
	
	newTransactionId := self nextTransactionId. " Aaca obtenemos un nuevo id"
	
	sales at: newTransactionId put: (self clientSalesBookFor: aCartId) last. " Aca seteamos para ese id la ultima venta"
	
	carts removeKey: aCartId .
	
	^ newTransactionId
! !
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 12/2/2020 18:41:18' prior: 50889839!
checkOut: aCartId withCCN: aCreditCardNumber CCED: anExpirationDate CCO: anOwner on: aDate 
	
	| aCreditCard newTransactionId |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	aCreditCard := CreditCard withNumber: aCreditCardNumber
							expiringOn:  anExpirationDate
							owner: anOwner.

	self checkOut: aCartId with: aCreditCard on: aDate.
	
	newTransactionId := self nextTransactionId. " Aaca obtenemos un nuevo id"
	
	sales at: newTransactionId put: (self clientSalesBookFor: aCartId) last. " Aca seteamos para ese id la ultima venta"
	
	carts removeKey: aCartId .
	
	^ newTransactionId
! !
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 12/2/2020 18:43:03'!
checkOut: aCartId with: aCreditCard on: aDate.
	
	Cashier toCheckout: (self cartAt: aCartId) 
			charging:  aCreditCard 
			through:  merchantProcessor 
			on:  aDate
			registeringOn: (self clientSalesBookFor: aCartId)
! !
!InternalRestInterface methodsFor: 'accessing' stamp: 'AM 12/2/2020 18:43:43'!
salesBookOfClientUsing: aCartId 
	
	^ salesBooks at: (self clientUsingCart: aCartId)! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 18:43:43' prior: 50889864!
checkOut: aCartId withCCN: aCreditCardNumber CCED: anExpirationDate CCO: anOwner on: aDate 
	
	| aCreditCard newTransactionId |
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	aCreditCard := CreditCard withNumber: aCreditCardNumber
							expiringOn:  anExpirationDate
							owner: anOwner.

	self checkOut: aCartId with: aCreditCard on: aDate.
	
	newTransactionId := self nextTransactionId. " Aaca obtenemos un nuevo id"
	
	sales at: newTransactionId put: (self salesBookOfClientUsing: aCartId) last. " Aca seteamos para ese id la ultima venta"
	
	carts removeKey: aCartId .
	
	^ newTransactionId
! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 18:43:43' prior: 50889888!
checkOut: aCartId with: aCreditCard on: aDate.
	
	Cashier toCheckout: (self cartAt: aCartId) 
			charging:  aCreditCard 
			through:  merchantProcessor 
			on:  aDate
			registeringOn: (self salesBookOfClientUsing: aCartId)
! !

!methodRemoval: InternalRestInterface #clientSalesBookFor: stamp: 'AM 12/2/2020 18:43:43'!
clientSalesBookFor: aCartId 
	
	^ salesBooks at: (self clientUsingCart: aCartId)!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 18:44:23'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 18:44:23'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 18:44:23'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 18:44:23'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 18:44:23'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 18:44:23'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 18:44:23'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 18:44:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 18:44:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 18:44:28'!
ERROR!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 18:45:35'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 18:45:35'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 18:45:35'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 18:45:35'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 18:45:35'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 18:45:35'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 18:45:35'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 18:45:35'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 18:45:35'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 18:45:35'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 18:45:35'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 18:45:35'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 18:45:35'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 18:45:35'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 18:45:35'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 18:45:35'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 18:45:35'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 18:45:36'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 18:45:36'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 18:45:36'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 18:45:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 18:45:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 18:45:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 18:45:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 18:45:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 18:45:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 18:45:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 18:45:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 18:45:36'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 18:45:36'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 18:45:36'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 18:45:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 18:45:36'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 18:45:36'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 18:45:36'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 18:45:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 18:45:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 18:45:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 18:45:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 18:45:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 18:45:36'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 18:45:39'!
ERROR!
!InternalRestInterface methodsFor: 'accessing' stamp: 'AM 12/2/2020 18:46:22' prior: 50889898!
salesBookOfClientUsing: aCartId 
	
	^ salesBooks at: (self clientUsingCart: aCartId) ifAbsent: [ SalesBook new ]! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 18:46:23'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 18:46:23'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 18:46:23'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 18:46:23'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 18:46:23'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 18:46:23'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 18:46:24'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 18:46:24'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 18:46:24'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 18:46:24'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 18:46:24'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 18:46:24'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 18:46:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 18:46:24'!
PASSED!
!InternalRestInterface methodsFor: 'accessing' stamp: 'AM 12/2/2020 18:46:35' prior: 50890239!
salesBookOfClientUsing: aCartId 
	
	^ salesBooks at: (self clientUsingCart: aCartId)! !
!InternalRestInterface methodsFor: 'accessing' stamp: 'AM 12/2/2020 18:47:07' prior: 50890389!
salesBookOfClientUsing: aCartId 
	
	^ self salesBookFor: (self clientUsingCart: aCartId)! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 18:47:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 18:47:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 18:47:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 18:47:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 18:47:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 18:47:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 18:47:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 18:47:12'!
PASSED!
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 12/2/2020 18:50:28' prior: 50889930!
checkOut: aCartId with: aCreditCard on: aDate.
	
	(Cashier toCheckout: (self cartAt: aCartId) 
			charging:  aCreditCard 
			through:  merchantProcessor 
			on:  aDate
			registeringOn: (self salesBookOfClientUsing: aCartId)) checkOut.
! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 18:50:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 18:50:32'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 18:50:32'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 18:50:32'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 18:50:32'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 18:50:32'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 18:50:32'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 18:50:32'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 18:50:32'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 18:50:32'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 18:50:32'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 18:50:32'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 18:50:32'!
PASSED!
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 12/2/2020 18:54:42' prior: 50889905!
checkOut: aCartId withCCN: aCreditCardNumber CCED: anExpirationDate CCO: anOwner on: aDate 
	
	| aCreditCard newTransactionId |
	
	aCreditCard := CreditCard withNumber: aCreditCardNumber
							expiringOn:  anExpirationDate
							owner: anOwner.

	self checkOut: aCartId with: aCreditCard on: aDate.
	
	newTransactionId := self nextTransactionId. " Aaca obtenemos un nuevo id"
	
	sales at: newTransactionId put: (self salesBookOfClientUsing: aCartId) last. " Aca seteamos para ese id la ultima venta"
	
	carts removeKey: aCartId .
	
	^ newTransactionId
! !
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 12/2/2020 18:55:08' prior: 50890544!
checkOut: aCartId with: aCreditCard on: aDate.

	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	(Cashier toCheckout: (self cartAt: aCartId) 
			charging:  aCreditCard 
			through:  merchantProcessor 
			on:  aDate
			registeringOn: (self salesBookOfClientUsing: aCartId)) checkOut.
! !
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 12/2/2020 18:55:26' prior: 50890698!
checkOut: aCartId withCCN: aCreditCardNumber CCED: anExpirationDate CCO: anOwner on: aDate 
	
	| aCreditCard |
	
	aCreditCard := CreditCard withNumber: aCreditCardNumber
							expiringOn:  anExpirationDate
							owner: anOwner.

	^ self checkOut: aCartId with: aCreditCard on: aDate.
! !
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 12/2/2020 18:56:01' prior: 50890719!
checkOut: aCartId with: aCreditCard on: aDate| newTransactionId |
.

	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	(Cashier toCheckout: (self cartAt: aCartId) 
			charging:  aCreditCard 
			through:  merchantProcessor 
			on:  aDate
			registeringOn: (self salesBookOfClientUsing: aCartId)) checkOut.
	
	newTransactionId := self nextTransactionId. " Aaca obtenemos un nuevo id"
	
	sales at: newTransactionId put: (self salesBookOfClientUsing: aCartId) last. " Aca seteamos para ese id la ultima venta"
	
	carts removeKey: aCartId .
	
	^ newTransactionId
! !
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 12/2/2020 18:56:13' prior: 50890747!
checkOut: aCartId with: aCreditCard on: aDate

	| newTransactionId |

	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	(Cashier toCheckout: (self cartAt: aCartId) 
			charging:  aCreditCard 
			through:  merchantProcessor 
			on:  aDate
			registeringOn: (self salesBookOfClientUsing: aCartId)) checkOut.
	
	newTransactionId := self nextTransactionId. " Aaca obtenemos un nuevo id"
	
	sales at: newTransactionId put: (self salesBookOfClientUsing: aCartId) last. " Aca seteamos para ese id la ultima venta"
	
	carts removeKey: aCartId .
	
	^ newTransactionId
! !
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 12/2/2020 18:56:46' prior: 50890734!
checkOut: aCartId withCCN: aCreditCardNumber CCED: anExpirationDate CCO: anOwner on: aDate 
	
	| aCreditCard |
	
	aCreditCard := CreditCard withNumber: aCreditCardNumber
							expiringOn:  anExpirationDate
							owner: anOwner.

	^ self checkOut: aCartId 
		with: aCreditCard 
		on: aDate.
! !
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 12/2/2020 18:58:25' prior: 50890771!
checkOut: aCartId with: aCreditCard on: aDate

	| newTransactionId |

	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	(Cashier toCheckout: (self cartAt: aCartId) 
			charging:  aCreditCard 
			through:  merchantProcessor 
			on:  aDate
			registeringOn: (self salesBookOfClientUsing: aCartId)) checkOut.
	
	newTransactionId := self nextTransactionId. " Aaca obtenemos un nuevo id"
	
	sales at: newTransactionId put: (self salesBookOfClientUsing: aCartId) last. " Aca seteamos para ese id la ultima venta"
	
	carts removeKey: aCartId .
	
	^ newTransactionId
! !
!InternalRestInterface methodsFor: 'accessing' stamp: 'AM 12/2/2020 18:59:18'!
cartIdentifiedAs: aCartId

	^ (carts at: aCartId) cart. ! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 18:59:18' prior: 50884116!
addToCart: aCartId product: aProduct withOcurrences: aNumberOfOccurrences 
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.

	(self cartIdentifiedAs: aCartId)  add: aNumberOfOccurrences of: aProduct! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 18:59:18' prior: 50890807!
checkOut: aCartId with: aCreditCard on: aDate

	| newTransactionId |

	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	(Cashier toCheckout: (self cartIdentifiedAs: aCartId) 
			charging:  aCreditCard 
			through:  merchantProcessor 
			on:  aDate
			registeringOn: (self salesBookOfClientUsing: aCartId)) checkOut.
	
	newTransactionId := self nextTransactionId. " Aaca obtenemos un nuevo id"
	
	sales at: newTransactionId put: (self salesBookOfClientUsing: aCartId) last. " Aca seteamos para ese id la ultima venta"
	
	carts removeKey: aCartId .
	
	^ newTransactionId
! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 18:59:18' prior: 50884007!
listCart: aCartId 
	
	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	^ (self cartIdentifiedAs: aCartId) listCart asBag.! !

!methodRemoval: InternalRestInterface #cartAt: stamp: 'AM 12/2/2020 18:59:18'!
cartAt: aCartId

	^ (carts at: aCartId) cart. !
!InternalRestInterface methodsFor: 'accessing' stamp: 'AM 12/2/2020 18:59:52'!
clientUsing: aCartId

	^ (carts at: aCartId) client! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 18:59:52' prior: 50890395!
salesBookOfClientUsing: aCartId 
	
	^ self salesBookFor: (self clientUsing: aCartId)! !

!methodRemoval: InternalRestInterface #clientUsingCart: stamp: 'AM 12/2/2020 18:59:52'!
clientUsingCart: aCartId

	^ (carts at: aCartId) client!
!InternalRestInterface methodsFor: 'accessing' stamp: 'AM 12/2/2020 19:00:23'!
salesBookOf: aClient 

	^ salesBooks at: aClient ifAbsent: [ SalesBook new ]! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:00:23' prior: 50890890!
salesBookOfClientUsing: aCartId 
	
	^ self salesBookOf: (self clientUsing: aCartId)! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:00:23' prior: 50888670!
listPurchasesOf: aClientId password: aPassword 
	
	authenticationSystem authenticate: aClientId using: aPassword .
	
	^ self salesBookOf: aClientId ! !

!methodRemoval: InternalRestInterface #salesBookFor: stamp: 'AM 12/2/2020 19:00:24'!
salesBookFor: aClient 

	^ salesBooks at: aClient ifAbsent: [ SalesBook new ]!
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 12/2/2020 19:01:09' prior: 50890848!
checkOut: aCartId with: aCreditCard on: aDate

	| newTransactionId |

	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	(Cashier toCheckout: (self cartIdentifiedAs: aCartId) 
			charging:  aCreditCard 
			through:  merchantProcessor 
			on:  aDate
			registeringOn: (self salesBookOfClientUsing: aCartId)) checkOut.
	
	newTransactionId := self nextTransactionId. " Aaca obtenemos un nuevo id"
	
	"sales at: newTransactionId put: (self salesBookOfClientUsing: aCartId) last. Aca seteamos para ese id la ultima venta"
	
	carts removeKey: aCartId .
	
	^ newTransactionId
! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 19:01:13'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 19:01:13'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 19:01:13'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 19:01:13'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 19:01:13'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 19:01:13'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 19:01:13'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 19:01:13'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 19:01:13'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 19:01:13'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 19:01:13'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 19:01:13'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 19:01:13'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 19:01:14'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 19:01:14'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 19:01:14'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 19:01:14'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 19:01:14'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 19:01:14'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 19:01:14'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 19:01:14'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 19:01:14'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 19:01:14'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 19:01:14'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 19:01:14'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 19:01:14'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 19:01:14'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 19:01:14'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 19:01:14'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 19:01:14'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 19:01:14'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 19:01:14'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:01:14'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:01:14'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 19:01:14'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 19:01:14'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 19:01:14'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 19:01:14'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 19:01:14'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 19:01:14'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 19:01:14'!
PASSED!
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 12/2/2020 19:10:36' prior: 50890926!
checkOut: aCartId with: aCreditCard on: aDate

	

	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	(Cashier toCheckout: (self cartIdentifiedAs: aCartId) 
			charging:  aCreditCard 
			through:  merchantProcessor 
			on:  aDate
			registeringOn: (self salesBookOfClientUsing: aCartId)) checkOut.
			
	carts removeKey: aCartId .
	
	^ self nextTransactionId.! !
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 12/2/2020 19:10:44' prior: 50891093!
checkOut: aCartId with: aCreditCard on: aDate

	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	(Cashier toCheckout: (self cartIdentifiedAs: aCartId) 
			charging:  aCreditCard 
			through:  merchantProcessor 
			on:  aDate
			registeringOn: (self salesBookOfClientUsing: aCartId)) checkOut.
			
	carts removeKey: aCartId .
	
	^ self nextTransactionId.! !
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 12/2/2020 19:11:19'!
removeCartIdentifiedAs: aCartId

	^ carts removeKey: aCartId! !
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 12/2/2020 19:11:19' prior: 50891110!
checkOut: aCartId with: aCreditCard on: aDate

	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	(Cashier toCheckout: (self cartIdentifiedAs: aCartId) 
			charging:  aCreditCard 
			through:  merchantProcessor 
			on:  aDate
			registeringOn: (self salesBookOfClientUsing: aCartId)) checkOut.
			
	self removeCartIdentifiedAs: aCartId .
	
	^ self nextTransactionId.! !
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 12/2/2020 19:14:00'!
creditCard: aCartId cartIdentifiedAs: aDate aCartId: aCreditCard

	^ (Cashier toCheckout: (self cartIdentifiedAs: aCartId) 
			charging:  aCreditCard 
			through:  merchantProcessor 
			on:  aDate
			registeringOn: (self salesBookOfClientUsing: aCartId)) checkOut! !
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 12/2/2020 19:14:01' prior: 50891133!
checkOut: aCartId with: aCreditCard on: aDate

	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	self creditCard: aCartId cartIdentifiedAs: aDate aCartId: aCreditCard.
			
	self removeCartIdentifiedAs: aCartId .
	
	^ self nextTransactionId.! !
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 12/2/2020 19:15:08'!
cashierCheckOut: aCartId with: aDate on: aCreditCard

	^ (Cashier toCheckout: (self cartIdentifiedAs: aCartId) 
			charging:  aCreditCard 
			through:  merchantProcessor 
			on:  aDate
			registeringOn: (self salesBookOfClientUsing: aCartId)) checkOut! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:15:08' prior: 50891162!
checkOut: aCartId with: aCreditCard on: aDate

	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	self cashierCheckOut: aCartId with: aDate on: aCreditCard.
			
	self removeCartIdentifiedAs: aCartId .
	
	^ self nextTransactionId.! !

!methodRemoval: InternalRestInterface #creditCard:cartIdentifiedAs:aCartId: stamp: 'AM 12/2/2020 19:15:08'!
creditCard: aCartId cartIdentifiedAs: aDate aCartId: aCreditCard

	^ (Cashier toCheckout: (self cartIdentifiedAs: aCartId) 
			charging:  aCreditCard 
			through:  merchantProcessor 
			on:  aDate
			registeringOn: (self salesBookOfClientUsing: aCartId)) checkOut!
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 12/2/2020 19:15:40'!
cashierCheckOut: aCartId on: aDate with: aCreditCard

	^ (Cashier toCheckout: (self cartIdentifiedAs: aCartId) 
			charging:  aCreditCard 
			through:  merchantProcessor 
			on:  aDate
			registeringOn: (self salesBookOfClientUsing: aCartId)) checkOut! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:15:40' prior: 50891187!
checkOut: aCartId with: aCreditCard on: aDate

	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	self cashierCheckOut: aCartId on: aDate with: aCreditCard.
			
	self removeCartIdentifiedAs: aCartId .
	
	^ self nextTransactionId.! !

!methodRemoval: InternalRestInterface #cashierCheckOut:with:on: stamp: 'AM 12/2/2020 19:15:40'!
cashierCheckOut: aCartId with: aDate on: aCreditCard

	^ (Cashier toCheckout: (self cartIdentifiedAs: aCartId) 
			charging:  aCreditCard 
			through:  merchantProcessor 
			on:  aDate
			registeringOn: (self salesBookOfClientUsing: aCartId)) checkOut!
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 12/2/2020 19:15:56'!
cashierCheckOut: aCartId with: aCreditCard on: aDate

	^ (Cashier toCheckout: (self cartIdentifiedAs: aCartId) 
			charging:  aCreditCard 
			through:  merchantProcessor 
			on:  aDate
			registeringOn: (self salesBookOfClientUsing: aCartId)) checkOut! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:15:56' prior: 50891224!
checkOut: aCartId with: aCreditCard on: aDate

	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	self cashierCheckOut: aCartId with: aDate on: aCreditCard.
			
	self removeCartIdentifiedAs: aCartId .
	
	^ self nextTransactionId.! !

!methodRemoval: InternalRestInterface #cashierCheckOut:on:with: stamp: 'AM 12/2/2020 19:15:56'!
cashierCheckOut: aCartId on: aDate with: aCreditCard

	^ (Cashier toCheckout: (self cartIdentifiedAs: aCartId) 
			charging:  aCreditCard 
			through:  merchantProcessor 
			on:  aDate
			registeringOn: (self salesBookOfClientUsing: aCartId)) checkOut!
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 12/2/2020 19:16:16' prior: 50891260!
checkOut: aCartId with: aCreditCard on: aDate

	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	self cashierCheckOut: aCartId with: aCreditCard on: aDate.
			
	self removeCartIdentifiedAs: aCartId .
	
	^ self nextTransactionId.! !

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 19:16:48'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 19:16:48'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 19:16:48'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 19:16:48'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 19:16:48'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 19:16:48'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 19:16:48'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 19:16:48'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 19:16:48'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 19:16:48'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 19:16:48'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:16:48'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:16:48'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 19:16:48'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 19:16:48'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 19:16:48'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 19:16:48'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 19:16:48'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 19:16:48'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 19:16:48'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 19:21:33' prior: 50886685!
test08CheckOutSuccessfullyChecksOutOneCart
	
	| interface aCartId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	interface checkOut: aCartId 
			withCCN: testObjectsFactory validCardId 
			CCED: testObjectsFactory futureExpirationDate 
			CCO: testObjectsFactory validOwner 
			on: testObjectsFactory today.
	
	self assert: testObjectsFactory merchantProccessorHasBeenUsed
	
	! !

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 19:21:43'!
ERROR!
!StoreTestObjectsFactory methodsFor: 'testing' stamp: 'AM 12/2/2020 19:21:55'!
merchantProccessorHasBeenUsed
	self shouldBeImplemented.! !

!classDefinition: #StoreTestObjectsFactory category: 'TusLibros' stamp: 'AM 12/2/2020 19:22:16'!
Object subclass: #StoreTestObjectsFactory
	instanceVariableNames: 'today debitFromWasReceived'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreTestObjectsFactory methodsFor: 'testing' stamp: 'AM 12/2/2020 19:22:14' prior: 50891397!
merchantProccessorHasBeenUsed
	
	^ debitFromWasReceived! !

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 19:22:19'!
ERROR!
!StoreTestObjectsFactory methodsFor: 'initialization' stamp: 'AM 12/2/2020 19:23:13' prior: 50873603 overrides: 16896425!
initialize

	today := DateAndTime now.
	debitFromWasReceived := false! !
!StoreTestObjectsFactory methodsFor: 'merchant processor' stamp: 'AM 12/2/2020 19:23:40' prior: 50873634!
debit: anAmount from: aCreditCard

	debitFromWasReceived  := true
! !

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 19:24:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 19:24:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 19:24:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 19:24:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 19:24:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 19:24:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 19:24:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 19:24:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 19:24:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 19:24:00'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 19:24:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:24:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:24:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 19:24:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 19:24:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 19:24:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 19:24:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 19:24:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 19:24:00'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 19:24:00'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 19:25:33' prior: 50887336!
test10FailedCheckOutShouldNotInvalidateFutureCheckOut
	
	| interface aCartId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword .

	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	self should: [ interface checkOut: aCartId 
			withCCN: testObjectsFactory validCardId 
			CCED: testObjectsFactory pastExpirationDate 
			CCO: testObjectsFactory validOwner 
			on: testObjectsFactory today. ]
		raise: Error
		withExceptionDo: [ :anError |
				interface checkOut: aCartId 
							withCCN: testObjectsFactory validCardId 
							CCED: testObjectsFactory futureExpirationDate 
							CCO: testObjectsFactory validOwner 
							on: testObjectsFactory today.
				self assert: testObjectsFactory merchantProccessorHasBeenUsed 
			].
	! !

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 19:25:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 19:25:51'!
FAILURE!
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 12/2/2020 19:27:31' prior: 50891284!
checkOut: aCartId with: aCreditCard on: aDate

	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	self cashierCheckOut: aCartId with: aCreditCard on: aDate.
			
	self removeCartIdentifiedAs: aCartId .
	
	^ self nextTransactionId.! !

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 19:27:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 19:27:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 19:27:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 19:27:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 19:27:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 19:27:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 19:27:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 19:27:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 19:27:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 19:27:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 19:27:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:27:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:27:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 19:27:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 19:27:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 19:27:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 19:27:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 19:27:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 19:27:34'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 19:27:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 19:27:34'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 19:29:03'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 19:29:28'!
FAILURE!
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 19:29:57' prior: 50887402!
test19ShouldNotCheckOutATimedOutCart
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword. 
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	clock addToTime: 30*minute.
	
	self should: [ interface checkOut: aCartId 
						withCCN: testObjectsFactory validCardId 
						CCED: testObjectsFactory futureExpirationDate 
						CCO: testObjectsFactory validOwner 
						on: testObjectsFactory today ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] 
				raise: Error 
				withMessageText: InternalRestInterface invalidCartIdErrorDescription
			]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 19:29:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 19:29:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 19:29:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 19:29:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 19:29:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 19:29:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 19:29:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 19:29:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 19:29:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 19:29:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 19:29:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 19:29:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:29:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:29:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 19:29:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 19:29:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 19:29:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 19:29:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 19:29:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 19:29:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 19:29:59'!
PASSED!
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 12/2/2020 19:30:54' prior: 50886326!
nextTransactionId
	
	^ 0! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 19:36:36'!
test21DifferentCheckoutsShouldCreateDifferentTransactionIds
	
	| interface aCartId clock transactionsId |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface := testObjectsFactory tusLibrosInterface .
					
	transactionsId := OrderedCollection new.
	
	3 timesRepeat: [
		aCartId  := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword.
		interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore.
		transactionsId add: ( interface checkOut:  aCartId
									withCCN:  testObjectsFactory validCardId 
									CCED:  testObjectsFactory futureExpirationDate 
									CCO:  testObjectsFactory validOwner 
									on: testObjectsFactory today).
		].
	
	self assert: transactionsId asSet size equals: 3.
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 19:36:49' prior: 50891764!
test21DifferentCheckoutsShouldCreateDifferentTransactionIds
	
	| interface aCartId transactionsId |
	
	interface := testObjectsFactory tusLibrosInterface .
					
	transactionsId := OrderedCollection new.
	
	3 timesRepeat: [
		aCartId  := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword.
		interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore.
		transactionsId add: ( interface checkOut:  aCartId
									withCCN:  testObjectsFactory validCardId 
									CCED:  testObjectsFactory futureExpirationDate 
									CCO:  testObjectsFactory validOwner 
									on: testObjectsFactory today).
		].
	
	self assert: transactionsId asSet size equals: 3.
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 19:36:58' prior: 50891793!
test21DifferentCheckoutsShouldCreateDifferentTransactionIds
	
	| interface aCartId transactionsIds |
	
	interface := testObjectsFactory tusLibrosInterface .
					
	transactionsIds := OrderedCollection new.
	
	3 timesRepeat: [
		aCartId  := interface createCartForUser: testObjectsFactory validUser password: testObjectsFactory validPassword.
		interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore.
		transactionsIds add: ( interface checkOut:  aCartId
									withCCN:  testObjectsFactory validCardId 
									CCED:  testObjectsFactory futureExpirationDate 
									CCO:  testObjectsFactory validOwner 
									on: testObjectsFactory today).
		].
	
	self assert: transactionsIds asSet size equals: 3.
	! !

!testRun: #InternalRestInterfaceTest #test21DifferentCheckoutsShouldCreateDifferentTransactionIds stamp: 'AM 12/2/2020 19:37:00'!
FAILURE!
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 12/2/2020 19:37:53' prior: 50891760!
nextTransactionId
	
	^ nextTransactionId := 	nextTransactionId + 1.! !

!testRun: #InternalRestInterfaceTest #test21DifferentCheckoutsShouldCreateDifferentTransactionIds stamp: 'AM 12/2/2020 19:38:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 19:38:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 19:38:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 19:38:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 19:38:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 19:38:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 19:38:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 19:38:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 19:38:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 19:38:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 19:38:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 19:38:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:38:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:38:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 19:38:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 19:38:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 19:38:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 19:38:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 19:38:03'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 19:38:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 19:38:04'!
PASSED!

!testRun: #InternalRestInterfaceTest #test21DifferentCheckoutsShouldCreateDifferentTransactionIds stamp: 'AM 12/2/2020 19:38:04'!
PASSED!

!methodRemoval: InternalRestInterface #saleFor: stamp: 'AM 12/2/2020 19:38:26'!
saleFor: aTransactionId 

	^ sales at: aTransactionId!
!InternalRestInterface methodsFor: 'initialization' stamp: 'AM 12/2/2020 19:38:58' prior: 50887752!
initializeWith: anAuthenticationSystem catalog: aCatalog through: aMerchantProcessor clock: aClockSimulator 
	
	authenticationSystem := anAuthenticationSystem.
	catalog := aCatalog.
	merchantProcessor := aMerchantProcessor.
	clock := aClockSimulator.
	
	nextCartId := 0.
	nextTransactionId := 0.
	
	carts := Dictionary new.
	
	salesBooks := Dictionary new.! !
!InternalRestInterface methodsFor: 'initialization' stamp: 'AM 12/2/2020 19:39:10' prior: 50891944!
initializeWith: anAuthenticationSystem catalog: aCatalog through: aMerchantProcessor clock: aClock 
	
	authenticationSystem := anAuthenticationSystem.
	catalog := aCatalog.
	merchantProcessor := aMerchantProcessor.
	clock := aClock.
	
	nextCartId := 0.
	nextTransactionId := 0.
	
	carts := Dictionary new.
	
	salesBooks := Dictionary new.! !
!InternalRestInterface class methodsFor: 'instance creation' stamp: 'AM 12/2/2020 19:39:19' prior: 50874019!
with: anAuthenticationSystem catalog: aCatalog through: aMerchantProcessor clock: aClock 

	^self new initializeWith: anAuthenticationSystem catalog: aCatalog through: aMerchantProcessor clock: aClock ! !
!InternalRestInterface methodsFor: 'assertions' stamp: 'AM 12/2/2020 19:39:39' prior: 50884404!
assertThatCartHasNotTimedOut: aCartId

	(self hasTimedOut: aCartId) ifTrue: [ 
		self removeCartIdentifiedAs: aCartId.
		self error: self class cartHasTimedOutErrorDescription ].! !

!methodRemoval: SalesBook #last stamp: 'AM 12/2/2020 19:41:57'!
last

	^ sales last!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test21DifferentCheckoutsShouldCreateDifferentTransactionIds stamp: 'AM 12/2/2020 19:42:05'!
PASSED!

!methodRemoval: SalesBook #initialize stamp: 'AM 12/2/2020 19:42:16'!
initialize

	sales := OrderedCollection new.!
!SalesBook methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:42:31' overrides: 16896425!
initialize

	sales := OrderedCollection new.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 19:42:37'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 19:42:37'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 19:42:37'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 19:42:37'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 19:42:37'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 19:42:37'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 19:42:37'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 19:42:37'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 19:42:37'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 19:42:37'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 19:42:37'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 19:42:37'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 19:42:37'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 19:42:37'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 19:42:37'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 19:42:37'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 19:42:37'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 19:42:37'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 19:42:37'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 19:42:37'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 19:42:37'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 19:42:37'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 19:42:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 19:42:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 19:42:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 19:42:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 19:42:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 19:42:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 19:42:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 19:42:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 19:42:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 19:42:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:42:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:42:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 19:42:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 19:42:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 19:42:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 19:42:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 19:42:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 19:42:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 19:42:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test21DifferentCheckoutsShouldCreateDifferentTransactionIds stamp: 'AM 12/2/2020 19:42:38'!
PASSED!
!SalesBook methodsFor: 'accesing' stamp: 'AM 12/2/2020 19:45:04' prior: 50888654!
products
	
	^ (sales collect: [ :aSale | aSale products ]) flatten asBag! !

!classDefinition: #SalesBook category: 'TusLibros' stamp: 'AM 12/2/2020 19:45:16'!
Object subclass: #SalesBook
	instanceVariableNames: 'products sales'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #SalesBook category: 'TusLibros' stamp: 'AM 12/2/2020 19:45:17'!
Object subclass: #SalesBook
	instanceVariableNames: 'sales'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!SalesBook methodsFor: 'accesing' stamp: 'AM 12/2/2020 19:45:55' prior: 50892299!
products
	
	| products |
	products := Bag new.
	(sales do: [ :aSale | products add: aSale products ]).
	
	^ products.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:45:59'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:45:59'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 19:45:59'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 19:45:59'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 19:46:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test21DifferentCheckoutsShouldCreateDifferentTransactionIds stamp: 'AM 12/2/2020 19:46:00'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:46:05'!
FAILURE!
!SalesBook methodsFor: 'accesing' stamp: 'AM 12/2/2020 19:46:30' prior: 50892318!
products
	
	| products |
	products := Bag new.
	(sales do: [ :aSale | products union: aSale products ]).
	
	^ products.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 19:46:33'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:46:34'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:46:34'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 19:46:34'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 19:46:34'!
PASSED!

!testRun: #InternalRestInterfaceTest #test21DifferentCheckoutsShouldCreateDifferentTransactionIds stamp: 'AM 12/2/2020 19:46:34'!
PASSED!
!SalesBook methodsFor: 'accesing' stamp: 'AM 12/2/2020 19:46:42' prior: 50892476!
products
	
	| products |
	products := Bag new.
	(sales do: [ :aSale | products addAll: aSale products ]).
	
	^ products.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 19:46:46'!
PASSED!

!testRun: #InternalRestInterfaceTest #test21DifferentCheckoutsShouldCreateDifferentTransactionIds stamp: 'AM 12/2/2020 19:46:46'!
PASSED!
!SalesBook methodsFor: 'accesing' stamp: 'AM 12/2/2020 19:47:00' prior: 50892630!
products
	
	| products |
	
	products := Bag new.
	(sales do: [ :aSale | products addAll: aSale products ]).
	
	^ products.! !
!SalesBook methodsFor: 'accesing' stamp: 'AM 12/2/2020 19:48:21' prior: 50892784!
products
	
	| products |
	
	products := Bag new.
	sales do: [ :aSale | products addAll: aSale products ]
	
	^ products.! !
!SalesBook methodsFor: 'accesing' stamp: 'AM 12/2/2020 19:48:25' prior: 50892791!
products
	
	| products |
	
	products := Bag new.
	
	sales do: [ :aSale | products addAll: aSale products ]
	
	^ products.! !
!SalesBook methodsFor: 'accesing' stamp: 'AM 12/2/2020 19:48:29' prior: 50892798!
products
	
	| products |
	
	products := Bag new.
	
	sales do: [ :aSale | products addAll: aSale products ].
	
	^ products.! !
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 12/2/2020 19:52:28'!
createCartFor: anUser using: aPassword 
	
	| newCartId |
	
	authenticationSystem authenticate: anUser using: aPassword .
	
	newCartId := self nextCartId.
	
	carts at: newCartId put: (InterfaceCartData cart: (Cart acceptingItemsOf: catalog)
											client: anUser
											lastTimeUsed: clock now).
	
	salesBooks at: anUser ifAbsentPut: SalesBook new.
	
	^ newCartId. ! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:52:28' prior: 50891372!
test08CheckOutSuccessfullyChecksOutOneCart
	
	| interface aCartId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	interface checkOut: aCartId 
			withCCN: testObjectsFactory validCardId 
			CCED: testObjectsFactory futureExpirationDate 
			CCO: testObjectsFactory validOwner 
			on: testObjectsFactory today.
	
	self assert: testObjectsFactory merchantProccessorHasBeenUsed
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:52:28' prior: 50887195!
test04AddingToCartSuccessfullyAddsToOneCart
	
	| interface aCartId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartFor: testObjectsFactory validUser 
						using: testObjectsFactory validPassword.
	
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore .
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore 
			withOcurrences: 2.


	self assert: (interface listCart: aCartId ) equals: { testObjectsFactory itemSellByTheStore. 
												 testObjectsFactory itemSellByTheStore. 
												 testObjectsFactory itemSellByTheStore} asBag.
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:52:29' prior: 50887372!
test17ShouldNotAddWhenCartTimedOut
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore. ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] 
				raise: Error 
				withMessageText: InternalRestInterface invalidCartIdErrorDescription
			]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:52:29' prior: 50887605!
test12ListOnePurchaseSuccessfully
	
	| interface aCartId purchases |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	interface checkOut: aCartId 
			withCCN: testObjectsFactory validCardId 
			CCED: testObjectsFactory futureExpirationDate 
			CCO: testObjectsFactory validOwner 
			on: testObjectsFactory today.
			
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: purchases total equals: testObjectsFactory itemSellByTheStorePrice .
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag.
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:52:29' prior: 50884701!
test18ShouldNotListToTimedOutCart
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface listCart: aCartId  ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] raise: Error withMessageText: InternalRestInterface invalidCartIdErrorDescription]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:52:29' prior: 50887561!
test02WrongPasswordShouldNotCreateCart
	
	| interface |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	self should: [ interface createCartFor: testObjectsFactory validUser using: testObjectsFactory invalidPassword ]
		raise: Error
		withMessageText: AuthenticationSystemSimulator invalidPasswordErrorDescription.
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:52:29' prior: 50887246!
test05AddingToCartSuccessfullyAddsToManyCarts
	
	| interface fortCartId maradonaCartId |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	maradonaCartId := interface createCartFor: testObjectsFactory validUser 
							using: testObjectsFactory validPassword .
	fortCartId := interface createCartFor: testObjectsFactory anotherValidUser 
						using: testObjectsFactory anotherValidPassword .
	
	interface addToCart: maradonaCartId 
			product: testObjectsFactory itemSellByTheStore .

	self assert: ( interface listCart: maradonaCartId ) equals: { testObjectsFactory itemSellByTheStore } asBag.
	self assert: ( ( interface listCart: fortCartId ) isEmpty ).

	
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:52:29' prior: 50887001!
test09ShouldNotCheckOutAnAlreadyCheckedOutCart
	
	| interface aCartId |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	interface checkOut: aCartId 
			withCCN: testObjectsFactory validCardId 
			CCED: testObjectsFactory futureExpirationDate 
			CCO: testObjectsFactory validOwner 
			on: testObjectsFactory today.
	
	self should: [ interface checkOut: aCartId 
						withCCN: testObjectsFactory validCardId 
						CCED: testObjectsFactory futureExpirationDate
						CCO: testObjectsFactory validOwner 
						on: testObjectsFactory today ]
		raise: Error
		withMessageText: InternalRestInterface invalidCartIdErrorDescription . 
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:52:29' prior: 50887510!
test20TimeOutTimeIsResetAfterAnyOperation
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartFor: testObjectsFactory validUser 
						using: testObjectsFactory validPassword. 	
	
	self shouldnt: [ clock addToTime: 29*minute.
				interface listCart: aCartId .
				clock addToTime: 29*minute.
				interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
				clock addToTime: 29*minute.
				[ interface checkOut: aCartId 
						withCCN: testObjectsFactory validCardId 
						CCED: testObjectsFactory pastExpirationDate
						CCO: testObjectsFactory validOwner 
						on: testObjectsFactory today ] 
					on: Error 
					do: [:anError | ].
				clock addToTime: 29*minute.
				interface listCart: aCartId ]
		raise: Error.
		
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:52:29' prior: 50887110!
test03NewCartShouldBeEmpty
	
	| interface aCartId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartFor: testObjectsFactory validUser 
						using: testObjectsFactory validPassword.

	self assert: ( interface listCart: aCartId ) isEmpty .
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:52:30' prior: 50891645!
test19ShouldNotCheckOutATimedOutCart
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword. 
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	clock addToTime: 30*minute.
	
	self should: [ interface checkOut: aCartId 
						withCCN: testObjectsFactory validCardId 
						CCED: testObjectsFactory futureExpirationDate 
						CCO: testObjectsFactory validOwner 
						on: testObjectsFactory today ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] 
				raise: Error 
				withMessageText: InternalRestInterface invalidCartIdErrorDescription
			]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:52:30' prior: 50891507!
test10FailedCheckOutShouldNotInvalidateFutureCheckOut
	
	| interface aCartId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .

	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	self should: [ interface checkOut: aCartId 
			withCCN: testObjectsFactory validCardId 
			CCED: testObjectsFactory pastExpirationDate 
			CCO: testObjectsFactory validOwner 
			on: testObjectsFactory today. ]
		raise: Error
		withExceptionDo: [ :anError |
				interface checkOut: aCartId 
							withCCN: testObjectsFactory validCardId 
							CCED: testObjectsFactory futureExpirationDate 
							CCO: testObjectsFactory validOwner 
							on: testObjectsFactory today.
				self assert: testObjectsFactory merchantProccessorHasBeenUsed 
			].
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:52:30' prior: 50887635!
test13ListMoreThanOnePurchaseSuccessfully
	
	| interface aCartId purchases |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	2 timesRepeat: [ 
		aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
		interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
		interface checkOut: aCartId 
				withCCN: testObjectsFactory validCardId 
				CCED: testObjectsFactory futureExpirationDate 
				CCO: testObjectsFactory validOwner 
				on: testObjectsFactory today 
		].
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice * 2 equals: purchases total.
	self assert: purchases products equals: { testObjectsFactory itemSellByTheStore. testObjectsFactory itemSellByTheStore } asBag.
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:52:30' prior: 50887546!
test01UnknownUserShouldNotCreateCart
	
	| interface |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	self should: [ interface createCartFor: testObjectsFactory invalidUser using: testObjectsFactory invalidPassword ]
		raise: Error - MessageNotUnderstood
		withMessageText: AuthenticationSystemSimulator invalidUserErrorDescription.
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:52:30' prior: 50891820!
test21DifferentCheckoutsShouldCreateDifferentTransactionIds
	
	| interface aCartId transactionsIds |
	
	interface := testObjectsFactory tusLibrosInterface .
					
	transactionsIds := OrderedCollection new.
	
	3 timesRepeat: [
		aCartId  := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword.
		interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore.
		transactionsIds add: ( interface checkOut:  aCartId
									withCCN:  testObjectsFactory validCardId 
									CCED:  testObjectsFactory futureExpirationDate 
									CCO:  testObjectsFactory validOwner 
									on: testObjectsFactory today).
		].
	
	self assert: transactionsIds asSet size equals: 3.
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:52:30' prior: 50887667!
test14ListPurchasesFromMoreThanOneUser
	
	| interface aCartId purchases |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartFor: testObjectsFactory validUser 
					using: testObjectsFactory validPassword .
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore .
	interface checkOut: aCartId 
			withCCN: testObjectsFactory validCardId 
			CCED: testObjectsFactory futureExpirationDate 
			CCO: testObjectsFactory validOwner 
			on: testObjectsFactory today.
	
	aCartId := interface createCartFor: testObjectsFactory anotherValidUser 
					using: testObjectsFactory anotherValidPassword .
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore .
	interface checkOut: aCartId 
			withCCN: testObjectsFactory validCardId 
			CCED: testObjectsFactory futureExpirationDate 
			CCO: testObjectsFactory validOwner 
			on: testObjectsFactory today.
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser 
						password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice equals: purchases total.
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag
	
	! !

!methodRemoval: InternalRestInterface #createCartForUser:password: stamp: 'AM 12/2/2020 19:52:30'!
createCartForUser: anUser password: aPassword 
	
	| newCartId |
	
	authenticationSystem authenticate: anUser using: aPassword .
	
	newCartId := self nextCartId.
	
	carts at: newCartId put: (InterfaceCartData cart: (Cart acceptingItemsOf: catalog)
											client: anUser
											lastTimeUsed: clock now).
	
	salesBooks at: anUser ifAbsentPut: SalesBook new.
	
	^ newCartId. !
!InternalRestInterface methodsFor: 'cart management' stamp: 'AM 12/2/2020 19:52:43' prior: 50892812!
createCartFor: aClientId using: aPassword 
	
	| newCartId |
	
	authenticationSystem authenticate: aClientId using: aPassword .
	
	newCartId := self nextCartId.
	
	carts at: newCartId put: (InterfaceCartData cart: (Cart acceptingItemsOf: catalog)
											client: aClientId
											lastTimeUsed: clock now).
	
	salesBooks at: aClientId ifAbsentPut: SalesBook new.
	
	^ newCartId. ! !
!InterfaceCartData class methodsFor: 'instance creation' stamp: 'AM 12/2/2020 19:53:19'!
cart: aCart clientId: anUser lastTimeUsed: aTime 
	
	^self new initializeCart: aCart client: anUser lastTimeUsed: aTime ! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:53:19' prior: 50893278!
createCartFor: aClientId using: aPassword 
	
	| newCartId |
	
	authenticationSystem authenticate: aClientId using: aPassword .
	
	newCartId := self nextCartId.
	
	carts at: newCartId put: (InterfaceCartData cart: (Cart acceptingItemsOf: catalog)
											clientId: aClientId
											lastTimeUsed: clock now).
	
	salesBooks at: aClientId ifAbsentPut: SalesBook new.
	
	^ newCartId. ! !

!methodRemoval: InterfaceCartData class #cart:client:lastTimeUsed: stamp: 'AM 12/2/2020 19:53:19'!
cart: aCart client: anUser lastTimeUsed: aTime 
	
	^self new initializeCart: aCart client: anUser lastTimeUsed: aTime !
!InterfaceCartData methodsFor: 'accessing' stamp: 'AM 12/2/2020 19:54:44'!
clientId
	
	^ client! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:54:44' prior: 50890885!
clientUsing: aCartId

	^ (carts at: aCartId) clientId! !

!methodRemoval: InterfaceCartData #client stamp: 'AM 12/2/2020 19:54:44'!
client
	
	^ client!

!classDefinition: #InterfaceCartData category: 'TusLibros' stamp: 'AM 12/2/2020 19:54:49'!
Object subclass: #InterfaceCartData
	instanceVariableNames: 'clientI cart lastTimeUsed'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InterfaceCartData methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:54:49' prior: 50893323!
clientId
	
	^ clientI! !
!InterfaceCartData methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:54:49' prior: 50884153!
initializeCart: aCart client: anUser lastTimeUsed: aTime 
	
	cart := aCart.
	clientI := anUser.
	lastTimeUsed := aTime.! !

!classDefinition: #InterfaceCartData category: 'TusLibros' stamp: 'AM 12/2/2020 19:54:53'!
Object subclass: #InterfaceCartData
	instanceVariableNames: 'clientId cart lastTimeUsed'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InterfaceCartData methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:54:53' prior: 50893344!
clientId
	
	^ clientId! !
!InterfaceCartData methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:54:53' prior: 50893348!
initializeCart: aCart client: anUser lastTimeUsed: aTime 
	
	cart := aCart.
	clientId := anUser.
	lastTimeUsed := aTime.! !
!InterfaceCartData methodsFor: 'initialization' stamp: 'AM 12/2/2020 19:55:07'!
initializeCart: aCart clientId: anUser lastTimeUsed: aTime 
	
	cart := aCart.
	clientId := anUser.
	lastTimeUsed := aTime.! !
!InterfaceCartData class methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 19:55:07' prior: 50893293!
cart: aCart clientId: anUser lastTimeUsed: aTime 
	
	^self new initializeCart: aCart clientId: anUser lastTimeUsed: aTime ! !

!methodRemoval: InterfaceCartData #initializeCart:client:lastTimeUsed: stamp: 'AM 12/2/2020 19:55:07'!
initializeCart: aCart client: anUser lastTimeUsed: aTime 
	
	cart := aCart.
	clientId := anUser.
	lastTimeUsed := aTime.!
!InterfaceCartData methodsFor: 'initialization' stamp: 'AM 12/2/2020 19:55:12' prior: 50893374!
initializeCart: aCart clientId: aClientId lastTimeUsed: aTime 
	
	cart := aCart.
	clientId := aClientId.
	lastTimeUsed := aTime.! !
!InterfaceCartData class methodsFor: 'instance creation' stamp: 'AM 12/2/2020 19:55:21' prior: 50893382!
cart: aCart clientId: aClientId lastTimeUsed: aTime 
	
	^self new initializeCart: aCart clientId: aClientId lastTimeUsed: aTime ! !
!InternalRestInterface methodsFor: 'accessing - private' stamp: 'AM 12/2/2020 19:56:06' prior: 50890900!
salesBookOf: aClientId 

	^ salesBooks at: aClientId ifAbsent: [ SalesBook new ]! !
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 12/2/2020 19:57:13' prior: 50887710!
nextCartId
	
	^ nextCartId := nextCartId + 1.
	! !
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 12/2/2020 19:58:22' prior: 50893419!
nextCartId
	
	^ Object new
	! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 19:58:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test21DifferentCheckoutsShouldCreateDifferentTransactionIds stamp: 'AM 12/2/2020 19:58:24'!
PASSED!
!InternalRestInterface methodsFor: 'initialization' stamp: 'AM 12/2/2020 19:59:19' prior: 50891959!
initializeWith: anAuthenticationSystem catalog: aCatalog through: aMerchantProcessor clock: aClock 
	
	authenticationSystem := anAuthenticationSystem.
	catalog := aCatalog.
	merchantProcessor := aMerchantProcessor.
	clock := aClock.
	
	carts := Dictionary new.
	
	salesBooks := Dictionary new.! !
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 12/2/2020 19:59:29' prior: 50891851!
nextTransactionId
	
	^ Object new! !

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 19:59:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 19:59:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 19:59:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 19:59:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 19:59:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 19:59:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 19:59:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 19:59:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 19:59:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 19:59:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 19:59:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:59:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 19:59:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 19:59:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 19:59:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 19:59:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 19:59:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 19:59:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 19:59:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 19:59:31'!
PASSED!

!testRun: #InternalRestInterfaceTest #test21DifferentCheckoutsShouldCreateDifferentTransactionIds stamp: 'AM 12/2/2020 19:59:31'!
PASSED!

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 'AM 12/2/2020 19:59:56'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticationSystem catalog carts merchantProcessor salesBooks clock sales nextTransactionId'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 'AM 12/2/2020 19:59:57'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticationSystem catalog carts merchantProcessor salesBooks clock nextTransactionId'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 'AM 12/2/2020 19:59:57'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticationSystem catalog carts merchantProcessor salesBooks clock'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InternalRestInterface methodsFor: 'time out - private' stamp: 'AM 12/2/2020 20:01:04'!
timeOutLimit

	^ 30*minute! !
!InternalRestInterface methodsFor: 'time out - private' stamp: 'AM 12/2/2020 20:01:04' prior: 50879144!
hasTimedOut: aCartId
	
	^ self timeOutLimit <= ((self lastTimeFor: aCartId) distanceTo: clock now).! !
!InternalRestInterface methodsFor: 'time out - private' stamp: 'AM 12/2/2020 20:01:26' prior: 50893703!
timeOutLimit

	^ 30 * minute! !
!InternalRestInterface methodsFor: 'time out - private' stamp: 'AM 12/2/2020 20:02:42'!
timeSinceLastUseOf: aCartId

	^ (self lastTimeFor: aCartId) distanceTo: clock now! !
!InternalRestInterface methodsFor: 'time out - private' stamp: 'AM 12/2/2020 20:02:42' prior: 50893708!
hasTimedOut: aCartId
	
	^ self timeOutLimit <= (self timeSinceLastUseOf: aCartId).! !
!InternalRestInterface methodsFor: 'time out - private' stamp: 'AM 12/2/2020 20:03:02'!
lastTimeOf: aCartId

	^ (carts at: aCartId) lastTimeUsed.! !
!InternalRestInterface methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:03:02' prior: 50893719!
timeSinceLastUseOf: aCartId

	^ (self lastTimeOf: aCartId) distanceTo: clock now! !

!methodRemoval: InternalRestInterface #lastTimeFor: stamp: 'AM 12/2/2020 20:03:03'!
lastTimeFor: aCartId

	^ (carts at: aCartId) lastTimeUsed.!
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 12/2/2020 20:04:41' prior: 50891546!
checkOut: aCartId with: aCreditCard on: aDate

	"self assertThatCartIdIsValid: aCartId."
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	self cashierCheckOut: aCartId with: aCreditCard on: aDate.
			
	self removeCartIdentifiedAs: aCartId .
	
	^ self nextTransactionId.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 20:04:41'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 20:04:41'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 20:04:41'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 20:04:41'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 20:04:42'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test21DifferentCheckoutsShouldCreateDifferentTransactionIds stamp: 'AM 12/2/2020 20:04:42'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 20:04:42'!
FAILURE!
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 12/2/2020 20:05:06' prior: 50893748!
checkOut: aCartId with: aCreditCard on: aDate

	self assertThatCartIdIsValid: aCartId.
	self assertThatCartHasNotTimedOut: aCartId.
	
	self updateLastUseOf: aCartId.
	
	self cashierCheckOut: aCartId with: aCreditCard on: aDate.
			
	self removeCartIdentifiedAs: aCartId .
	
	^ self nextTransactionId.! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 20:06:39'!
test18ShouldNotListATimedOutCart
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface listCart: aCartId  ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] raise: Error withMessageText: InternalRestInterface invalidCartIdErrorDescription]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !

!methodRemoval: InternalRestInterfaceTest #test18ShouldNotListToTimedOutCart stamp: 'AM 12/2/2020 20:06:39'!
test18ShouldNotListToTimedOutCart
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface listCart: aCartId  ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] raise: Error withMessageText: InternalRestInterface invalidCartIdErrorDescription]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	!
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:09:31'!
checkout: aCartId on: interface

	^ interface checkOut:  aCartId
									withCCN:  testObjectsFactory validCardId 
									CCED:  testObjectsFactory futureExpirationDate 
									CCO:  testObjectsFactory validOwner 
									on: testObjectsFactory today! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:09:31' prior: 50893194!
test21DifferentCheckoutsShouldCreateDifferentTransactionIds
	
	| interface aCartId transactionsIds |
	
	interface := testObjectsFactory tusLibrosInterface .
					
	transactionsIds := OrderedCollection new.
	
	3 timesRepeat: [
		aCartId  := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword.
		interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore.
		transactionsIds add: ( self checkout: aCartId on: interface).
		].
	
	self assert: transactionsIds asSet size equals: 3.
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 20:10:16' prior: 50893079!
test19ShouldNotCheckOutATimedOutCart
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword. 
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	clock addToTime: 30*minute.
	
	self should: [ self checkout: aCartId on: interface]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] 
				raise: Error 
				withMessageText: InternalRestInterface invalidCartIdErrorDescription
			]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:10:38' prior: 50893981!
checkout: aCartId on: interface

	^ interface checkOut:  aCartId
			withCCN:  testObjectsFactory validCardId 
			CCED:  testObjectsFactory futureExpirationDate 
			CCO:  testObjectsFactory validOwner 
			on: testObjectsFactory today! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:10:51' prior: 50892828!
test08CheckOutSuccessfullyChecksOutOneCart
	
	| interface aCartId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	self checkout: aCartId on: interface.
	
	self assert: testObjectsFactory merchantProccessorHasBeenUsed
	
	! !

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListATimedOutCart stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 20:10:53'!
PASSED!

!testRun: #InternalRestInterfaceTest #test21DifferentCheckoutsShouldCreateDifferentTransactionIds stamp: 'AM 12/2/2020 20:10:53'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:11:15' prior: 50893000!
test09ShouldNotCheckOutAnAlreadyCheckedOutCart
	
	| interface aCartId |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	self checkout: aCartId on: interface.
	
	self should: [ self checkout: aCartId on: interface ]
		raise: Error
		withMessageText: InternalRestInterface invalidCartIdErrorDescription . 
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:11:27' prior: 50893116!
test10FailedCheckOutShouldNotInvalidateFutureCheckOut
	
	| interface aCartId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .

	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	self should: [ interface checkOut: aCartId 
			withCCN: testObjectsFactory validCardId 
			CCED: testObjectsFactory pastExpirationDate 
			CCO: testObjectsFactory validOwner 
			on: testObjectsFactory today. ]
		raise: Error
		withExceptionDo: [ :anError |
				self checkout: aCartId on: interface.
				self assert: testObjectsFactory merchantProccessorHasBeenUsed 
			].
	! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:12:02'!
validCheckout: aCartId on: interface

	^ interface checkOut:  aCartId
			withCCN:  testObjectsFactory validCardId 
			CCED:  testObjectsFactory futureExpirationDate 
			CCO:  testObjectsFactory validOwner 
			on: testObjectsFactory today! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:12:02' prior: 50893993!
test21DifferentCheckoutsShouldCreateDifferentTransactionIds
	
	| interface aCartId transactionsIds |
	
	interface := testObjectsFactory tusLibrosInterface .
					
	transactionsIds := OrderedCollection new.
	
	3 timesRepeat: [
		aCartId  := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword.
		interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore.
		transactionsIds add: ( self validCheckout: aCartId on: interface).
		].
	
	self assert: transactionsIds asSet size equals: 3.
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:12:02' prior: 50894014!
test19ShouldNotCheckOutATimedOutCart
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword. 
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	clock addToTime: 30*minute.
	
	self should: [ self validCheckout: aCartId on: interface]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] 
				raise: Error 
				withMessageText: InternalRestInterface invalidCartIdErrorDescription
			]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:12:02' prior: 50894056!
test08CheckOutSuccessfullyChecksOutOneCart
	
	| interface aCartId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	self validCheckout: aCartId on: interface.
	
	self assert: testObjectsFactory merchantProccessorHasBeenUsed
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:12:02' prior: 50894224!
test09ShouldNotCheckOutAnAlreadyCheckedOutCart
	
	| interface aCartId |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	self validCheckout: aCartId on: interface.
	
	self should: [ self validCheckout: aCartId on: interface ]
		raise: Error
		withMessageText: InternalRestInterface invalidCartIdErrorDescription . 
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:12:02' prior: 50894244!
test10FailedCheckOutShouldNotInvalidateFutureCheckOut
	
	| interface aCartId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .

	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	self should: [ interface checkOut: aCartId 
			withCCN: testObjectsFactory validCardId 
			CCED: testObjectsFactory pastExpirationDate 
			CCO: testObjectsFactory validOwner 
			on: testObjectsFactory today. ]
		raise: Error
		withExceptionDo: [ :anError |
				self validCheckout: aCartId on: interface.
				self assert: testObjectsFactory merchantProccessorHasBeenUsed 
			].
	! !

!methodRemoval: InternalRestInterfaceTest #checkout:on: stamp: 'AM 12/2/2020 20:12:02'!
checkout: aCartId on: interface

	^ interface checkOut:  aCartId
			withCCN:  testObjectsFactory validCardId 
			CCED:  testObjectsFactory futureExpirationDate 
			CCO:  testObjectsFactory validOwner 
			on: testObjectsFactory today!
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:12:13'!
invalidCheckout: aCartId on: interface

	^ interface checkOut:  aCartId
			withCCN:  testObjectsFactory validCardId 
			CCED:  testObjectsFactory pastExpirationDate 
			CCO:  testObjectsFactory validOwner 
			on: testObjectsFactory today! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:12:29' prior: 50894405!
invalidCheckout: aCartId on: anInterface

	^ anInterface checkOut:  aCartId
			withCCN:  testObjectsFactory validCardId 
			CCED:  testObjectsFactory pastExpirationDate 
			CCO:  testObjectsFactory validOwner 
			on: testObjectsFactory today! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:12:39' prior: 50894269!
validCheckout: aCartId on: anInterface

	^ anInterface checkOut:  aCartId
			withCCN:  testObjectsFactory validCardId 
			CCED:  testObjectsFactory futureExpirationDate 
			CCO:  testObjectsFactory validOwner 
			on: testObjectsFactory today! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:13:03' prior: 50894369!
test10FailedCheckOutShouldNotInvalidateFutureCheckOut
	
	| interface aCartId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .

	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	self should: [ self invalidCheckout: aCartId on: interface ]
		raise: Error
		withExceptionDo: [ :anError |
				self validCheckout: aCartId on: interface.
				self assert: testObjectsFactory merchantProccessorHasBeenUsed 
			].
	! !
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:13:29' prior: 50892904!
test12ListOnePurchaseSuccessfully
	
	| interface aCartId purchases |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	self validCheckout: aCartId on: interface.
			
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: purchases total equals: testObjectsFactory itemSellByTheStorePrice .
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag.
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:13:40' prior: 50893147!
test13ListMoreThanOnePurchaseSuccessfully
	
	| interface aCartId purchases |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	2 timesRepeat: [ 
		aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
		interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
		self validCheckout: aCartId on: interface
		].
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice * 2 equals: purchases total.
	self assert: purchases products equals: { testObjectsFactory itemSellByTheStore. testObjectsFactory itemSellByTheStore } asBag.
	
	! !

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:13:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 20:13:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 20:13:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 20:13:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 20:13:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 20:13:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 20:13:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 20:13:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 20:13:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 20:13:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 20:13:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 20:13:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:13:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:13:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 20:13:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 20:13:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 20:13:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 20:13:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListATimedOutCart stamp: 'AM 12/2/2020 20:13:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 20:13:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 20:13:43'!
PASSED!

!testRun: #InternalRestInterfaceTest #test21DifferentCheckoutsShouldCreateDifferentTransactionIds stamp: 'AM 12/2/2020 20:13:43'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:14:22' prior: 50893221!
test14ListPurchasesFromMoreThanOneUser
	
	| interface aCartId purchases |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartFor: testObjectsFactory validUser 
					using: testObjectsFactory validPassword .
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore .
	self validCheckout: aCartId on: interface.
	
	aCartId := interface createCartFor: testObjectsFactory anotherValidUser 
					using: testObjectsFactory anotherValidPassword .
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore .
	self validCheckout: aCartId on: interface.
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser 
						password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice equals: purchases total.
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:15:31' prior: 50894438!
test10FailedCheckOutShouldNotInvalidateFutureCheckOut
	
	| interface aCartId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	self should: [ self invalidCheckout: aCartId on: interface ]
		raise: Error
		withExceptionDo: [ :anError |
				self validCheckout: aCartId on: interface.
				self assert: testObjectsFactory merchantProccessorHasBeenUsed 
			].
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 20:16:07' prior: 50893030!
test20TimeOutTimeIsResetAfterAnyOperation
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartFor: testObjectsFactory validUser 
						using: testObjectsFactory validPassword. 	
	
	self shouldnt: [ clock addToTime: 29*minute.
				interface listCart: aCartId .
				clock addToTime: 29*minute.
				interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
				clock addToTime: 29*minute.
				[ self invalidCheckout: aCartId on: interface ] 
					on: Error 
					do: [:anError | ].
				clock addToTime: 29*minute.
				interface listCart: aCartId ]
		raise: Error.
		
	! !

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 20:16:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 20:16:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 20:16:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 20:16:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 20:16:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 20:16:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 20:16:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 20:16:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 20:16:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 20:16:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 20:16:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 20:16:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:16:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:16:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 20:16:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 20:16:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 20:16:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 20:16:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListATimedOutCart stamp: 'AM 12/2/2020 20:16:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 20:16:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 20:16:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test21DifferentCheckoutsShouldCreateDifferentTransactionIds stamp: 'AM 12/2/2020 20:16:24'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 20:16:27'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 20:16:27'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 20:16:27'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 20:16:27'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 20:16:27'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 20:16:27'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 20:16:27'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 20:16:27'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 20:16:27'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 20:16:27'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListATimedOutCart stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 20:16:28'!
PASSED!

!testRun: #InternalRestInterfaceTest #test21DifferentCheckoutsShouldCreateDifferentTransactionIds stamp: 'AM 12/2/2020 20:16:28'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'setUp - tearDown' stamp: 'AM 12/2/2020 20:18:33' prior: 50872867 overrides: 16927572!
setUp

	testObjectsFactory := StoreTestObjectsFactory new .
	! !

!classDefinition: #InternalRestInterfaceTest category: 'TusLibros' stamp: 'AM 12/2/2020 20:19:35'!
TestCase subclass: #InternalRestInterfaceTest
	instanceVariableNames: 'testObjectsFactory interface20'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InternalRestInterfaceTest methodsFor: 'setUp - tearDown' stamp: 'AM 12/2/2020 20:19:33' prior: 50894914 overrides: 16927572!
setUp

	testObjectsFactory := StoreTestObjectsFactory new .
	
	interface20 := testObjectsFactory tusLibrosInterface.! !
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 12/2/2020 20:19:52' prior: 50893066!
test03NewCartShouldBeEmpty
	
	| interface2 aCartId |
		
	interface2 := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface2 createCartFor: testObjectsFactory validUser 
						using: testObjectsFactory validPassword.

	self assert: ( interface2 listCart: aCartId ) isEmpty .
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 12/2/2020 20:20:00' prior: 50894937!
test03NewCartShouldBeEmpty
	
	| aCartId |
		
	interface20 := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface20 createCartFor: testObjectsFactory validUser 
						using: testObjectsFactory validPassword.

	self assert: ( interface20 listCart: aCartId ) isEmpty .
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 12/2/2020 20:20:16' prior: 50892850!
test04AddingToCartSuccessfullyAddsToOneCart
	
	| aCartId |
	
	aCartId := interface20 createCartFor: testObjectsFactory validUser 
						using: testObjectsFactory validPassword.
	
	interface20 addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore .
	interface20 addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore 
			withOcurrences: 2.


	self assert: (interface20 listCart: aCartId ) equals: { testObjectsFactory itemSellByTheStore. 
												 testObjectsFactory itemSellByTheStore. 
												 testObjectsFactory itemSellByTheStore} asBag.
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 12/2/2020 20:20:27' prior: 50894950!
test03NewCartShouldBeEmpty
	
	| aCartId |
	
	aCartId := interface20 createCartFor: testObjectsFactory validUser 
						using: testObjectsFactory validPassword.

	self assert: ( interface20 listCart: aCartId ) isEmpty .
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 12/2/2020 20:20:42' prior: 50892975!
test05AddingToCartSuccessfullyAddsToManyCarts
	
	| fortCartId maradonaCartId |
	
	maradonaCartId := interface20 createCartFor: testObjectsFactory validUser 
							using: testObjectsFactory validPassword .
	fortCartId := interface20 createCartFor: testObjectsFactory anotherValidUser 
						using: testObjectsFactory anotherValidPassword .
	
	interface20 addToCart: maradonaCartId 
			product: testObjectsFactory itemSellByTheStore .

	self assert: ( interface20 listCart: maradonaCartId ) equals: { testObjectsFactory itemSellByTheStore } asBag.
	self assert: ( ( interface20 listCart: fortCartId ) isEmpty ).

	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 12/2/2020 20:20:57' prior: 50887272!
test06ListingCartShouldNotListOnInvalidCartId
	
	self should: [ interface20 listCart: testObjectsFactory invalidCartId ]
		raise: Error - MessageNotUnderstood 
		withMessageText: InternalRestInterface invalidCartIdErrorDescription .

	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 12/2/2020 20:21:03' prior: 50887286!
test07ShouldNotAddToInvalidCartId
	
	self should: [ interface20 addToCart: testObjectsFactory invalidCartId product: testObjectsFactory itemSellByTheStore ]
		raise: Error - MessageNotUnderstood 
		withMessageText: InternalRestInterface invalidCartIdErrorDescription .

	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:21:33' prior: 50894416!
invalidCheckout: aCartId on: anInterface

	^ interface20 checkOut:  aCartId
			withCCN:  testObjectsFactory validCardId 
			CCED:  testObjectsFactory pastExpirationDate 
			CCO:  testObjectsFactory validOwner 
			on: testObjectsFactory today! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:21:46'!
invalidCheckout: aCartId 

	^ interface20 checkOut:  aCartId
			withCCN:  testObjectsFactory validCardId 
			CCED:  testObjectsFactory pastExpirationDate 
			CCO:  testObjectsFactory validOwner 
			on: testObjectsFactory today! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:21:46' prior: 50894627!
test10FailedCheckOutShouldNotInvalidateFutureCheckOut
	
	| interface aCartId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	self should: [ self invalidCheckout: aCartId ]
		raise: Error
		withExceptionDo: [ :anError |
				self validCheckout: aCartId on: interface.
				self assert: testObjectsFactory merchantProccessorHasBeenUsed 
			].
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:21:47' prior: 50894649!
test20TimeOutTimeIsResetAfterAnyOperation
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartFor: testObjectsFactory validUser 
						using: testObjectsFactory validPassword. 	
	
	self shouldnt: [ clock addToTime: 29*minute.
				interface listCart: aCartId .
				clock addToTime: 29*minute.
				interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
				clock addToTime: 29*minute.
				[ self invalidCheckout: aCartId ] 
					on: Error 
					do: [:anError | ].
				clock addToTime: 29*minute.
				interface listCart: aCartId ]
		raise: Error.
		
	! !

!methodRemoval: InternalRestInterfaceTest #invalidCheckout:on: stamp: 'AM 12/2/2020 20:21:47'!
invalidCheckout: aCartId on: anInterface

	^ interface20 checkOut:  aCartId
			withCCN:  testObjectsFactory validCardId 
			CCED:  testObjectsFactory pastExpirationDate 
			CCO:  testObjectsFactory validOwner 
			on: testObjectsFactory today!
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:21:52' prior: 50894427!
validCheckout: aCartId on: anInterface

	^ interface20 checkOut:  aCartId
			withCCN:  testObjectsFactory validCardId 
			CCED:  testObjectsFactory futureExpirationDate 
			CCO:  testObjectsFactory validOwner 
			on: testObjectsFactory today! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:22:02'!
validCheckout: aCartId 

	^ interface20 checkOut:  aCartId
			withCCN:  testObjectsFactory validCardId 
			CCED:  testObjectsFactory futureExpirationDate 
			CCO:  testObjectsFactory validOwner 
			on: testObjectsFactory today! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:22:02' prior: 50894485!
test13ListMoreThanOnePurchaseSuccessfully
	
	| interface aCartId purchases |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	2 timesRepeat: [ 
		aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
		interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
		self validCheckout: aCartId ].
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice * 2 equals: purchases total.
	self assert: purchases products equals: { testObjectsFactory itemSellByTheStore. testObjectsFactory itemSellByTheStore } asBag.
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:22:02' prior: 50894280!
test21DifferentCheckoutsShouldCreateDifferentTransactionIds
	
	| interface aCartId transactionsIds |
	
	interface := testObjectsFactory tusLibrosInterface .
					
	transactionsIds := OrderedCollection new.
	
	3 timesRepeat: [
		aCartId  := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword.
		interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore.
		transactionsIds add: ( self validCheckout: aCartId ).
		].
	
	self assert: transactionsIds asSet size equals: 3.
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:22:03' prior: 50894460!
test12ListOnePurchaseSuccessfully
	
	| interface aCartId purchases |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	self validCheckout: aCartId .
			
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: purchases total equals: testObjectsFactory itemSellByTheStorePrice .
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag.
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:22:03' prior: 50895067!
test10FailedCheckOutShouldNotInvalidateFutureCheckOut
	
	| interface aCartId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	self should: [ self invalidCheckout: aCartId ]
		raise: Error
		withExceptionDo: [ :anError |
				self validCheckout: aCartId .
				self assert: testObjectsFactory merchantProccessorHasBeenUsed 
			].
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:22:03' prior: 50894332!
test08CheckOutSuccessfullyChecksOutOneCart
	
	| interface aCartId |
		
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	self validCheckout: aCartId .
	
	self assert: testObjectsFactory merchantProccessorHasBeenUsed
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:22:03' prior: 50894301!
test19ShouldNotCheckOutATimedOutCart
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword. 
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	clock addToTime: 30*minute.
	
	self should: [ self validCheckout: aCartId ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] 
				raise: Error 
				withMessageText: InternalRestInterface invalidCartIdErrorDescription
			]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:22:03' prior: 50894349!
test09ShouldNotCheckOutAnAlreadyCheckedOutCart
	
	| interface aCartId |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	self validCheckout: aCartId .
	
	self should: [ self validCheckout: aCartId ]
		raise: Error
		withMessageText: InternalRestInterface invalidCartIdErrorDescription . 
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:22:03' prior: 50894594!
test14ListPurchasesFromMoreThanOneUser
	
	| interface aCartId purchases |
	
	interface := testObjectsFactory tusLibrosInterface .
	
	aCartId := interface createCartFor: testObjectsFactory validUser 
					using: testObjectsFactory validPassword .
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore .
	self validCheckout: aCartId .
	
	aCartId := interface createCartFor: testObjectsFactory anotherValidUser 
					using: testObjectsFactory anotherValidPassword .
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore .
	self validCheckout: aCartId .
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser 
						password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice equals: purchases total.
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag
	
	! !

!methodRemoval: InternalRestInterfaceTest #validCheckout:on: stamp: 'AM 12/2/2020 20:22:03'!
validCheckout: aCartId on: anInterface

	^ interface20 checkOut:  aCartId
			withCCN:  testObjectsFactory validCardId 
			CCED:  testObjectsFactory futureExpirationDate 
			CCO:  testObjectsFactory validOwner 
			on: testObjectsFactory today!
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:22:18' prior: 50895243!
test08CheckOutSuccessfullyChecksOutOneCart
	
	| aCartId |
	
	aCartId := interface20 createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
	interface20 addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	self validCheckout: aCartId .
	
	self assert: testObjectsFactory merchantProccessorHasBeenUsed
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:22:32' prior: 50895291!
test09ShouldNotCheckOutAnAlreadyCheckedOutCart
	
	| aCartId |
	
	aCartId := interface20 createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
	interface20 addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	self validCheckout: aCartId .
	
	self should: [ self validCheckout: aCartId ]
		raise: Error
		withMessageText: InternalRestInterface invalidCartIdErrorDescription . 
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:22:47' prior: 50895222!
test10FailedCheckOutShouldNotInvalidateFutureCheckOut
	
	| aCartId |
	
	aCartId := interface20 createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
	interface20 addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	self should: [ self invalidCheckout: aCartId ]
		raise: Error
		withExceptionDo: [ :anError |
				self validCheckout: aCartId .
				self assert: testObjectsFactory merchantProccessorHasBeenUsed 
			].
	! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:23:00' prior: 50895177!
test21DifferentCheckoutsShouldCreateDifferentTransactionIds
	
	| aCartId transactionsIds |
					
	transactionsIds := OrderedCollection new.
	
	3 timesRepeat: [
		aCartId  := interface20 createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword.
		interface20 addToCart: aCartId product: testObjectsFactory itemSellByTheStore.
		transactionsIds add: ( self validCheckout: aCartId ).
		].
	
	self assert: transactionsIds asSet size equals: 3.
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 20:23:32' prior: 50892874!
test17ShouldNotAddWhenCartTimedOut
	
	| interface aCartId clock |
		
	clock := ClockSimulator withTime: GregorianDateTime now.
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore. ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] 
				raise: Error 
				withMessageText: InternalRestInterface invalidCartIdErrorDescription
			]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - credentials' stamp: 'AM 12/2/2020 20:23:52' prior: 50893179!
test01UnknownUserShouldNotCreateCart

	self should: [ interface20 createCartFor: testObjectsFactory invalidUser using: testObjectsFactory invalidPassword ]
		raise: Error - MessageNotUnderstood
		withMessageText: AuthenticationSystemSimulator invalidUserErrorDescription.
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - credentials' stamp: 'AM 12/2/2020 20:24:00' prior: 50892961!
test02WrongPasswordShouldNotCreateCart
	
	self should: [ interface20 createCartFor: testObjectsFactory validUser using: testObjectsFactory invalidPassword ]
		raise: Error
		withMessageText: AuthenticationSystemSimulator invalidPasswordErrorDescription.
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - credentials' stamp: 'AM 12/2/2020 20:24:07' prior: 50887576!
test15InvalidUserShouldNotListPurchases

	self should: [ interface20 listPurchasesOf: testObjectsFactory invalidUser password: testObjectsFactory validPassword ]
		raise: Error
		withMessageText: AuthenticationSystemSimulator invalidUserErrorDescription .
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - credentials' stamp: 'AM 12/2/2020 20:24:15' prior: 50887590!
test16InvalidPasswordShouldNotListPurchases
	
	self should: [ interface20 listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory invalidPassword ]
		raise: Error
		withMessageText: AuthenticationSystemSimulator invalidPasswordErrorDescription .
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 20:25:42' prior: 50895423!
test17ShouldNotAddWhenCartTimedOut
	
	| interface aCartId clock |
		
	clock := testObjectsFactory clockSimulator.	
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore. ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] 
				raise: Error 
				withMessageText: InternalRestInterface invalidCartIdErrorDescription
			]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 20:25:54' prior: 50893926!
test18ShouldNotListATimedOutCart
	
	| interface aCartId clock |
		
	clock := testObjectsFactory clockSimulator.	
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface listCart: aCartId  ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] raise: Error withMessageText: InternalRestInterface invalidCartIdErrorDescription]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 20:26:01' prior: 50895260!
test19ShouldNotCheckOutATimedOutCart
	
	| interface aCartId clock |
		
	clock := testObjectsFactory clockSimulator.	
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword. 
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	clock addToTime: 30*minute.
	
	self should: [ self validCheckout: aCartId ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] 
				raise: Error 
				withMessageText: InternalRestInterface invalidCartIdErrorDescription
			]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 20:26:10' prior: 50895088!
test20TimeOutTimeIsResetAfterAnyOperation
	
	| interface aCartId clock |
		
	clock := testObjectsFactory clockSimulator.	
	
	interface :=  InternalRestInterface with: testObjectsFactory authenticationSystem 
								catalog: testObjectsFactory defaultCatalog 
								through: testObjectsFactory 
								clock: clock.
					
	aCartId := interface createCartFor: testObjectsFactory validUser 
						using: testObjectsFactory validPassword. 	
	
	self shouldnt: [ clock addToTime: 29*minute.
				interface listCart: aCartId .
				clock addToTime: 29*minute.
				interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
				clock addToTime: 29*minute.
				[ self invalidCheckout: aCartId ] 
					on: Error 
					do: [:anError | ].
				clock addToTime: 29*minute.
				interface listCart: aCartId ]
		raise: Error.
		
	! !

!classDefinition: #InternalRestInterfaceTest category: 'TusLibros' stamp: 'AM 12/2/2020 20:27:30'!
TestCase subclass: #InternalRestInterfaceTest
	instanceVariableNames: 'testObjectsFactory interface20 clockSimulator'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InternalRestInterfaceTest methodsFor: 'setUp - tearDown' stamp: 'AM 12/2/2020 20:27:28' prior: 50894929 overrides: 16927572!
setUp

	testObjectsFactory := StoreTestObjectsFactory new .
	
	interface20 := testObjectsFactory tusLibrosInterface.
	
	clockSimulator := testObjectsFactory clockSimulator.	
! !
!InternalRestInterfaceTest methodsFor: 'setUp - tearDown' stamp: 'AM 12/2/2020 20:27:59' prior: 50895632 overrides: 16927572!
setUp

	testObjectsFactory := StoreTestObjectsFactory new .
	
	clockSimulator := testObjectsFactory clockSimulator.	
	
	interface20 := testObjectsFactory tusLibrosInterface with: clockSimulator.
! !
!InternalRestInterfaceTest methodsFor: 'setUp - tearDown' stamp: 'AM 12/2/2020 20:28:14' prior: 50895642 overrides: 16927572!
setUp

	testObjectsFactory := StoreTestObjectsFactory new .
	
	clockSimulator := testObjectsFactory clockSimulator.	
	
	interface20 := testObjectsFactory tusLibrosInterfaceWithClock: clockSimulator.
! !
!StoreTestObjectsFactory methodsFor: 'tus libros interface' stamp: 'AM 12/2/2020 20:28:59'!
tusLibrosInterfaceWithClock: aClockSimulator
	
	^ InternalRestInterface with: self authenticationSystem 
					catalog: self defaultCatalog 
					through: self
					clock: aClockSimulator
! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 20:29:01'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 20:29:01'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 20:29:01'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 20:29:01'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 20:29:01'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:29:02'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:29:02'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 20:29:02'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListATimedOutCart stamp: 'AM 12/2/2020 20:29:02'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 20:29:02'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 20:29:02'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test21DifferentCheckoutsShouldCreateDifferentTransactionIds stamp: 'AM 12/2/2020 20:29:02'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:29:23' prior: 50873082!
test11ListZeroPurchasesSuccesfully
	
	| purchases |
	
	purchases := interface20 listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: purchases total equals: 0.
	self assert: purchases products isEmpty.
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:29:36' prior: 50895198!
test12ListOnePurchaseSuccessfully
	
	| aCartId purchases |
	
	aCartId := interface20 createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
	interface20 addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	self validCheckout: aCartId .
			
	purchases := interface20 listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: purchases total equals: testObjectsFactory itemSellByTheStorePrice .
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag.
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:29:52' prior: 50895151!
test13ListMoreThanOnePurchaseSuccessfully
	
	| aCartId purchases |
	
	2 timesRepeat: [ 
		aCartId := interface20 createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
		interface20 addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
		self validCheckout: aCartId ].
	
	purchases := interface20 listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice * 2 equals: purchases total.
	self assert: purchases products equals: { testObjectsFactory itemSellByTheStore. testObjectsFactory itemSellByTheStore } asBag.
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:30:15' prior: 50895310!
test14ListPurchasesFromMoreThanOneUser
	
	| aCartId purchases |
	
	aCartId := interface20 createCartFor: testObjectsFactory validUser 
					using: testObjectsFactory validPassword .
	interface20 addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore .
	self validCheckout: aCartId .
	
	aCartId := interface20 createCartFor: testObjectsFactory anotherValidUser 
					using: testObjectsFactory anotherValidPassword .
	interface20 addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore .
	self validCheckout: aCartId .
	
	purchases := interface20 listPurchasesOf: testObjectsFactory validUser 
						password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice equals: purchases total.
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 20:31:01' prior: 50895503!
test17ShouldNotAddWhenCartTimedOut
	
	| aCartId |
					
	aCartId := interface20 createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword. 
	
	clockSimulator addToTime: 30*minute.
	
	self should: [ interface20 addToCart: aCartId product: testObjectsFactory itemSellByTheStore. ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface20 listCart: aCartId] 
				raise: Error 
				withMessageText: InternalRestInterface invalidCartIdErrorDescription
			]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 20:31:21' prior: 50895533!
test18ShouldNotListATimedOutCart
	
	| interface aCartId clock |
					
	aCartId := interface20 createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword. 
	
	clock addToTime: 30*minute.
	
	self should: [ interface20 listCart: aCartId  ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface20 listCart: aCartId] raise: Error withMessageText: InternalRestInterface invalidCartIdErrorDescription]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 20:31:27' prior: 50895932!
test18ShouldNotListATimedOutCart
	
	| aCartId |
					
	aCartId := interface20 createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword. 
	
	clockSimulator addToTime: 30*minute.
	
	self should: [ interface20 listCart: aCartId  ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface20 listCart: aCartId] raise: Error withMessageText: InternalRestInterface invalidCartIdErrorDescription]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 20:31:51' prior: 50895561!
test19ShouldNotCheckOutATimedOutCart
	
	| aCartId |
					
	aCartId := interface20 createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword. 
	interface20 addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	clockSimulator addToTime: 30*minute.
	
	self should: [ self validCheckout: aCartId ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface20 listCart: aCartId] 
				raise: Error 
				withMessageText: InternalRestInterface invalidCartIdErrorDescription
			]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 20:32:23' prior: 50895592!
test20TimeOutTimeIsResetAfterAnyOperation
	
	| interface aCartId |
					
	aCartId := interface20 createCartFor: testObjectsFactory validUser 
						using: testObjectsFactory validPassword. 	
	
	self shouldnt: [ clockSimulator addToTime: 29*minute.
				interface20 listCart: aCartId .
				clockSimulator addToTime: 29*minute.
				interface20 addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
				clockSimulator addToTime: 29*minute.
				[ self invalidCheckout: aCartId ] 
					on: Error 
					do: [:anError | ].
				clockSimulator addToTime: 29*minute.
				interface20 listCart: aCartId ]
		raise: Error.
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 20:32:31' prior: 50895995!
test20TimeOutTimeIsResetAfterAnyOperation
	
	| aCartId |
					
	aCartId := interface20 createCartFor: testObjectsFactory validUser 
						using: testObjectsFactory validPassword. 	
	
	self shouldnt: [ clockSimulator addToTime: 29*minute.
				interface20 listCart: aCartId .
				clockSimulator addToTime: 29*minute.
				interface20 addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
				clockSimulator addToTime: 29*minute.
				[ self invalidCheckout: aCartId ] 
					on: Error 
					do: [:anError | ].
				clockSimulator addToTime: 29*minute.
				interface20 listCart: aCartId ]
		raise: Error.
		
	! !

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 20:32:39'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 20:32:39'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 20:32:39'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 20:32:39'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 20:32:39'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 20:32:39'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 20:32:39'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 20:32:39'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListATimedOutCart stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!testRun: #InternalRestInterfaceTest #test21DifferentCheckoutsShouldCreateDifferentTransactionIds stamp: 'AM 12/2/2020 20:32:40'!
PASSED!

!classDefinition: #InternalRestInterfaceTest category: 'TusLibros' stamp: 'AM 12/2/2020 20:33:08'!
TestCase subclass: #InternalRestInterfaceTest
	instanceVariableNames: 'testObjectsFactory interface clockSimulator'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:33:09' prior: 50895020!
test06ListingCartShouldNotListOnInvalidCartId
	
	self should: [ interface listCart: testObjectsFactory invalidCartId ]
		raise: Error - MessageNotUnderstood 
		withMessageText: InternalRestInterface invalidCartIdErrorDescription .

	
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:33:09' prior: 50895879!
test14ListPurchasesFromMoreThanOneUser
	
	| aCartId purchases |
	
	aCartId := interface createCartFor: testObjectsFactory validUser 
					using: testObjectsFactory validPassword .
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore .
	self validCheckout: aCartId .
	
	aCartId := interface createCartFor: testObjectsFactory anotherValidUser 
					using: testObjectsFactory anotherValidPassword .
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore .
	self validCheckout: aCartId .
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser 
						password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice equals: purchases total.
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:33:09' prior: 50895385!
test10FailedCheckOutShouldNotInvalidateFutureCheckOut
	
	| aCartId |
	
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	self should: [ self invalidCheckout: aCartId ]
		raise: Error
		withExceptionDo: [ :anError |
				self validCheckout: aCartId .
				self assert: testObjectsFactory merchantProccessorHasBeenUsed 
			].
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:33:09' prior: 50895952!
test18ShouldNotListATimedOutCart
	
	| aCartId |
					
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword. 
	
	clockSimulator addToTime: 30*minute.
	
	self should: [ interface listCart: aCartId  ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] raise: Error withMessageText: InternalRestInterface invalidCartIdErrorDescription]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:33:09' prior: 50895490!
test16InvalidPasswordShouldNotListPurchases
	
	self should: [ interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory invalidPassword ]
		raise: Error
		withMessageText: AuthenticationSystemSimulator invalidPasswordErrorDescription .
		
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:33:09' prior: 50894986!
test03NewCartShouldBeEmpty
	
	| aCartId |
	
	aCartId := interface createCartFor: testObjectsFactory validUser 
						using: testObjectsFactory validPassword.

	self assert: ( interface listCart: aCartId ) isEmpty .
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:33:09' prior: 50895353!
test08CheckOutSuccessfullyChecksOutOneCart
	
	| aCartId |
	
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	self validCheckout: aCartId .
	
	self assert: testObjectsFactory merchantProccessorHasBeenUsed
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:33:09' prior: 50895032!
test07ShouldNotAddToInvalidCartId
	
	self should: [ interface addToCart: testObjectsFactory invalidCartId product: testObjectsFactory itemSellByTheStore ]
		raise: Error - MessageNotUnderstood 
		withMessageText: InternalRestInterface invalidCartIdErrorDescription .

	
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:33:09' prior: 50895653 overrides: 16927572!
setUp

	testObjectsFactory := StoreTestObjectsFactory new .
	
	clockSimulator := testObjectsFactory clockSimulator.	
	
	interface := testObjectsFactory tusLibrosInterfaceWithClock: clockSimulator.
! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:33:10' prior: 50895478!
test15InvalidUserShouldNotListPurchases

	self should: [ interface listPurchasesOf: testObjectsFactory invalidUser password: testObjectsFactory validPassword ]
		raise: Error
		withMessageText: AuthenticationSystemSimulator invalidUserErrorDescription .
		
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:33:10' prior: 50895972!
test19ShouldNotCheckOutATimedOutCart
	
	| aCartId |
					
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword. 
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	clockSimulator addToTime: 30*minute.
	
	self should: [ self validCheckout: aCartId ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] 
				raise: Error 
				withMessageText: InternalRestInterface invalidCartIdErrorDescription
			]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:33:10' prior: 50894997!
test05AddingToCartSuccessfullyAddsToManyCarts
	
	| fortCartId maradonaCartId |
	
	maradonaCartId := interface createCartFor: testObjectsFactory validUser 
							using: testObjectsFactory validPassword .
	fortCartId := interface createCartFor: testObjectsFactory anotherValidUser 
						using: testObjectsFactory anotherValidPassword .
	
	interface addToCart: maradonaCartId 
			product: testObjectsFactory itemSellByTheStore .

	self assert: ( interface listCart: maradonaCartId ) equals: { testObjectsFactory itemSellByTheStore } asBag.
	self assert: ( ( interface listCart: fortCartId ) isEmpty ).

	
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:33:10' prior: 50895368!
test09ShouldNotCheckOutAnAlreadyCheckedOutCart
	
	| aCartId |
	
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	self validCheckout: aCartId .
	
	self should: [ self validCheckout: aCartId ]
		raise: Error
		withMessageText: InternalRestInterface invalidCartIdErrorDescription . 
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:33:10' prior: 50895453!
test01UnknownUserShouldNotCreateCart

	self should: [ interface createCartFor: testObjectsFactory invalidUser using: testObjectsFactory invalidPassword ]
		raise: Error - MessageNotUnderstood
		withMessageText: AuthenticationSystemSimulator invalidUserErrorDescription.
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:33:10' prior: 50895854!
test13ListMoreThanOnePurchaseSuccessfully
	
	| aCartId purchases |
	
	2 timesRepeat: [ 
		aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
		interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
		self validCheckout: aCartId ].
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice * 2 equals: purchases total.
	self assert: purchases products equals: { testObjectsFactory itemSellByTheStore. testObjectsFactory itemSellByTheStore } asBag.
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:33:10' prior: 50895404!
test21DifferentCheckoutsShouldCreateDifferentTransactionIds
	
	| aCartId transactionsIds |
					
	transactionsIds := OrderedCollection new.
	
	3 timesRepeat: [
		aCartId  := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword.
		interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore.
		transactionsIds add: ( self validCheckout: aCartId ).
		].
	
	self assert: transactionsIds asSet size equals: 3.
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:33:10' prior: 50894963!
test04AddingToCartSuccessfullyAddsToOneCart
	
	| aCartId |
	
	aCartId := interface createCartFor: testObjectsFactory validUser 
						using: testObjectsFactory validPassword.
	
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore .
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore 
			withOcurrences: 2.


	self assert: (interface listCart: aCartId ) equals: { testObjectsFactory itemSellByTheStore. 
												 testObjectsFactory itemSellByTheStore. 
												 testObjectsFactory itemSellByTheStore} asBag.
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:33:10' prior: 50895910!
test17ShouldNotAddWhenCartTimedOut
	
	| aCartId |
					
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword. 
	
	clockSimulator addToTime: 30*minute.
	
	self should: [ interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore. ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] 
				raise: Error 
				withMessageText: InternalRestInterface invalidCartIdErrorDescription
			]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:33:10' prior: 50895832!
test12ListOnePurchaseSuccessfully
	
	| aCartId purchases |
	
	aCartId := interface createCartFor: testObjectsFactory validUser using: testObjectsFactory validPassword .
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	self validCheckout: aCartId .
			
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: purchases total equals: testObjectsFactory itemSellByTheStorePrice .
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag.
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:33:10' prior: 50895056!
invalidCheckout: aCartId 

	^ interface checkOut:  aCartId
			withCCN:  testObjectsFactory validCardId 
			CCED:  testObjectsFactory pastExpirationDate 
			CCO:  testObjectsFactory validOwner 
			on: testObjectsFactory today! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:33:11' prior: 50895140!
validCheckout: aCartId 

	^ interface checkOut:  aCartId
			withCCN:  testObjectsFactory validCardId 
			CCED:  testObjectsFactory futureExpirationDate 
			CCO:  testObjectsFactory validOwner 
			on: testObjectsFactory today! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:33:11' prior: 50895820!
test11ListZeroPurchasesSuccesfully
	
	| purchases |
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: purchases total equals: 0.
	self assert: purchases products isEmpty.
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:33:11' prior: 50895466!
test02WrongPasswordShouldNotCreateCart
	
	self should: [ interface createCartFor: testObjectsFactory validUser using: testObjectsFactory invalidPassword ]
		raise: Error
		withMessageText: AuthenticationSystemSimulator invalidPasswordErrorDescription.
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:33:11' prior: 50896019!
test20TimeOutTimeIsResetAfterAnyOperation
	
	| aCartId |
					
	aCartId := interface createCartFor: testObjectsFactory validUser 
						using: testObjectsFactory validPassword. 	
	
	self shouldnt: [ clockSimulator addToTime: 29*minute.
				interface listCart: aCartId .
				clockSimulator addToTime: 29*minute.
				interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
				clockSimulator addToTime: 29*minute.
				[ self invalidCheckout: aCartId ] 
					on: Error 
					do: [:anError | ].
				clockSimulator addToTime: 29*minute.
				interface listCart: aCartId ]
		raise: Error.
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 12/2/2020 20:33:27'!
createValidCart

	^ interface createCartFor: testObjectsFactory validUser 
						using: testObjectsFactory validPassword! !
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 12/2/2020 20:33:27' prior: 50896293!
test03NewCartShouldBeEmpty
	
	| aCartId |
	
	aCartId := self createValidCart.

	self assert: ( interface listCart: aCartId ) isEmpty .
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 12/2/2020 20:33:52' prior: 50896473!
test04AddingToCartSuccessfullyAddsToOneCart
	
	| aCartId |
	
	aCartId := self createValidCart.
	
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore .
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore 
			withOcurrences: 2.


	self assert: (interface listCart: aCartId ) equals: { testObjectsFactory itemSellByTheStore. 
												 testObjectsFactory itemSellByTheStore. 
												 testObjectsFactory itemSellByTheStore} asBag.
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 12/2/2020 20:34:06' prior: 50896377!
test05AddingToCartSuccessfullyAddsToManyCarts
	
	| fortCartId maradonaCartId |
	
	maradonaCartId := self createValidCart.
	fortCartId := interface createCartFor: testObjectsFactory anotherValidUser 
						using: testObjectsFactory anotherValidPassword .
	
	interface addToCart: maradonaCartId 
			product: testObjectsFactory itemSellByTheStore .

	self assert: ( interface listCart: maradonaCartId ) equals: { testObjectsFactory itemSellByTheStore } asBag.
	self assert: ( ( interface listCart: fortCartId ) isEmpty ).

	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:34:21' prior: 50896304!
test08CheckOutSuccessfullyChecksOutOneCart
	
	| aCartId |
	
	aCartId :=self createValidCart.
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	self validCheckout: aCartId .
	
	self assert: testObjectsFactory merchantProccessorHasBeenUsed
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:34:28' prior: 50896400!
test09ShouldNotCheckOutAnAlreadyCheckedOutCart
	
	| aCartId |
	
	aCartId := self createValidCart.
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	self validCheckout: aCartId .
	
	self should: [ self validCheckout: aCartId ]
		raise: Error
		withMessageText: InternalRestInterface invalidCartIdErrorDescription . 
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:34:36' prior: 50896243!
test10FailedCheckOutShouldNotInvalidateFutureCheckOut
	
	| aCartId |
	
	aCartId := self createValidCart.
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	self should: [ self invalidCheckout: aCartId ]
		raise: Error
		withExceptionDo: [ :anError |
				self validCheckout: aCartId .
				self assert: testObjectsFactory merchantProccessorHasBeenUsed 
			].
	! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:34:46' prior: 50896454!
test21DifferentCheckoutsShouldCreateDifferentTransactionIds
	
	| aCartId transactionsIds |
					
	transactionsIds := OrderedCollection new.
	
	3 timesRepeat: [
		aCartId  := self createValidCart.
		interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore.
		transactionsIds add: ( self validCheckout: aCartId ).
		].
	
	self assert: transactionsIds asSet size equals: 3.
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 20:34:57' prior: 50896495!
test17ShouldNotAddWhenCartTimedOut
	
	| aCartId |
					
	aCartId := self createValidCart.
	
	clockSimulator addToTime: 30*minute.
	
	self should: [ interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore. ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] 
				raise: Error 
				withMessageText: InternalRestInterface invalidCartIdErrorDescription
			]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 20:35:03' prior: 50896261!
test18ShouldNotListATimedOutCart
	
	| aCartId |
					
	aCartId := self createValidCart.
	
	clockSimulator addToTime: 30*minute.
	
	self should: [ interface listCart: aCartId  ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] raise: Error withMessageText: InternalRestInterface invalidCartIdErrorDescription]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 20:35:09' prior: 50896354!
test19ShouldNotCheckOutATimedOutCart
	
	| aCartId |
					
	aCartId := self createValidCart.
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
	
	clockSimulator addToTime: 30*minute.
	
	self should: [ self validCheckout: aCartId ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] 
				raise: Error 
				withMessageText: InternalRestInterface invalidCartIdErrorDescription
			]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 20:35:17' prior: 50896585!
test20TimeOutTimeIsResetAfterAnyOperation
	
	| aCartId |
					
	aCartId := self createValidCart.	
	
	self shouldnt: [ clockSimulator addToTime: 29*minute.
				interface listCart: aCartId .
				clockSimulator addToTime: 29*minute.
				interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
				clockSimulator addToTime: 29*minute.
				[ self invalidCheckout: aCartId ] 
					on: Error 
					do: [:anError | ].
				clockSimulator addToTime: 29*minute.
				interface listCart: aCartId ]
		raise: Error.
		
	! !

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 20:35:29'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 20:35:29'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 20:35:29'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 20:35:29'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 20:35:29'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListATimedOutCart stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 20:35:30'!
PASSED!

!testRun: #InternalRestInterfaceTest #test21DifferentCheckoutsShouldCreateDifferentTransactionIds stamp: 'AM 12/2/2020 20:35:30'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:35:48' prior: 50896517!
test12ListOnePurchaseSuccessfully
	
	| aCartId purchases |
	
	aCartId := self createValidCart.
	interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .

	self validCheckout: aCartId .
			
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: purchases total equals: testObjectsFactory itemSellByTheStorePrice .
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag.
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:35:55' prior: 50896430!
test13ListMoreThanOnePurchaseSuccessfully
	
	| aCartId purchases |
	
	2 timesRepeat: [ 
		aCartId := self createValidCart.
		interface addToCart: aCartId product: testObjectsFactory itemSellByTheStore .
		self validCheckout: aCartId ].
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice * 2 equals: purchases total.
	self assert: purchases products equals: { testObjectsFactory itemSellByTheStore. testObjectsFactory itemSellByTheStore } asBag.
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:36:06' prior: 50896213!
test14ListPurchasesFromMoreThanOneUser
	
	| aCartId purchases |
	
	aCartId := self createValidCart.
	
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore .
	self validCheckout: aCartId .
	
	aCartId := interface createCartFor: testObjectsFactory anotherValidUser 
					using: testObjectsFactory anotherValidPassword .
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore .
	self validCheckout: aCartId .
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser 
						password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice equals: purchases total.
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:36:37'!
addValidProductTo: aCartId

	^ interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore! !
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:36:38' prior: 50896996!
test14ListPurchasesFromMoreThanOneUser
	
	| aCartId purchases |
	
	aCartId := self createValidCart.
	
	self addValidProductTo: aCartId .
	self validCheckout: aCartId .
	
	aCartId := interface createCartFor: testObjectsFactory anotherValidUser 
					using: testObjectsFactory anotherValidPassword .
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore .
	self validCheckout: aCartId .
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser 
						password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice equals: purchases total.
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:36:54' prior: 50897031!
test14ListPurchasesFromMoreThanOneUser
	
	| aCartId purchases |
	
	aCartId := self createValidCart.
	
	self addValidProductTo: aCartId .
	self validCheckout: aCartId .
	
	aCartId := interface createCartFor: testObjectsFactory anotherValidUser 
					using: testObjectsFactory anotherValidPassword .
	self addValidProductTo: aCartId .

	self validCheckout: aCartId .
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser 
						password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice equals: purchases total.
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:37:08' prior: 50896974!
test13ListMoreThanOnePurchaseSuccessfully
	
	| aCartId purchases |
	
	2 timesRepeat: [ 
		aCartId := self createValidCart.
		self addValidProductTo: aCartId .
		self validCheckout: aCartId ].
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice * 2 equals: purchases total.
	self assert: purchases products equals: { testObjectsFactory itemSellByTheStore. testObjectsFactory itemSellByTheStore } asBag.
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:37:26' prior: 50896954!
test12ListOnePurchaseSuccessfully
	
	| aCartId purchases |
	
	aCartId := self createValidCart.
	self addValidProductTo: aCartId .
	self validCheckout: aCartId .
			
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: purchases total equals: testObjectsFactory itemSellByTheStorePrice .
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag.
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 20:37:45' prior: 50896724!
test17ShouldNotAddWhenCartTimedOut
	
	| aCartId |
					
	aCartId := self createValidCart.
	
	clockSimulator addToTime: 30*minute.
	
	self should: [ 	self addValidProductTo: aCartId ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] 
				raise: Error 
				withMessageText: InternalRestInterface invalidCartIdErrorDescription
			]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 20:37:59' prior: 50896762!
test19ShouldNotCheckOutATimedOutCart
	
	| aCartId |
					
	aCartId := self createValidCart.
	self addValidProductTo: aCartId .

	
	clockSimulator addToTime: 30*minute.
	
	self should: [ self validCheckout: aCartId ]
		raise: Error
		withExceptionDo: [ :anError | 
			self should: [ interface listCart: aCartId] 
				raise: Error 
				withMessageText: InternalRestInterface invalidCartIdErrorDescription
			]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 20:38:12' prior: 50896783!
test20TimeOutTimeIsResetAfterAnyOperation
	
	| aCartId |
					
	aCartId := self createValidCart.	
	
	self shouldnt: [ clockSimulator addToTime: 29*minute.
				interface listCart: aCartId .
				clockSimulator addToTime: 29*minute.
				self addValidProductTo: aCartId .

				clockSimulator addToTime: 29*minute.
				[ self invalidCheckout: aCartId ] 
					on: Error 
					do: [:anError | ].
				clockSimulator addToTime: 29*minute.
				interface listCart: aCartId ]
		raise: Error.
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 20:38:17' prior: 50897158!
test20TimeOutTimeIsResetAfterAnyOperation
	
	| aCartId |
					
	aCartId := self createValidCart.	
	
	self shouldnt: [ clockSimulator addToTime: 29*minute.
				interface listCart: aCartId .
				clockSimulator addToTime: 29*minute.
				self addValidProductTo: aCartId .
				clockSimulator addToTime: 29*minute.
				[ self invalidCheckout: aCartId ] 
					on: Error 
					do: [:anError | ].
				clockSimulator addToTime: 29*minute.
				interface listCart: aCartId ]
		raise: Error.
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 20:39:36' prior: 50897177!
test20TimeOutTimeIsResetAfterAnyOperation
	
	| aCartId |
					
	aCartId := self createValidCart.	
	
	self shouldnt: [ clockSimulator addToTime: 29*minute.
				interface listCart: aCartId .
				clockSimulator addToTime: 29*minute.
				self addValidProductTo: aCartId .
				clockSimulator addToTime: 29*minute.
				[ self invalidCheckout: aCartId ] 
					on: Error 
					do: [:anError | ].
				clockSimulator addToTime: 29*minute.
				interface listCart: aCartId ]
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:39:49' prior: 50896665!
test08CheckOutSuccessfullyChecksOutOneCart
	
	| aCartId |
	
	aCartId :=self createValidCart.
	self addValidProductTo: aCartId .
	self validCheckout: aCartId .
	
	self assert: testObjectsFactory merchantProccessorHasBeenUsed
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:39:59' prior: 50896677!
test09ShouldNotCheckOutAnAlreadyCheckedOutCart
	
	| aCartId |
	
	aCartId := self createValidCart.
	self addValidProductTo: aCartId .
	self validCheckout: aCartId .
	
	self should: [ self validCheckout: aCartId ]
		raise: Error
		withMessageText: InternalRestInterface invalidCartIdErrorDescription . 
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:40:07' prior: 50896692!
test10FailedCheckOutShouldNotInvalidateFutureCheckOut
	
	| aCartId |
	
	aCartId := self createValidCart.
	self addValidProductTo: aCartId .
	
	self should: [ self invalidCheckout: aCartId ]
		raise: Error
		withExceptionDo: [ :anError |
				self validCheckout: aCartId .
				self assert: testObjectsFactory merchantProccessorHasBeenUsed 
			].
	! !
!InternalRestInterfaceTest methodsFor: 'tests - checkout' stamp: 'AM 12/2/2020 20:40:16' prior: 50896708!
test21DifferentCheckoutsShouldCreateDifferentTransactionIds
	
	| aCartId transactionsIds |
					
	transactionsIds := OrderedCollection new.
	
	3 timesRepeat: [
		aCartId  := self createValidCart.
		self addValidProductTo: aCartId .
		transactionsIds add: ( self validCheckout: aCartId ).
		].
	
	self assert: transactionsIds asSet size equals: 3.
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 12/2/2020 20:40:33' prior: 50896625!
test04AddingToCartSuccessfullyAddsToOneCart
	
	| aCartId |
	
	aCartId := self createValidCart.
	
	self addValidProductTo: aCartId .
	interface addToCart: aCartId 
			product: testObjectsFactory itemSellByTheStore 
			withOcurrences: 2.


	self assert: (interface listCart: aCartId ) equals: { testObjectsFactory itemSellByTheStore. 
												 testObjectsFactory itemSellByTheStore. 
												 testObjectsFactory itemSellByTheStore} asBag.
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 12/2/2020 20:40:52' prior: 50896645!
test05AddingToCartSuccessfullyAddsToManyCarts
	
	| fortCartId maradonaCartId |
	
	maradonaCartId := self createValidCart.
	fortCartId := interface createCartFor: testObjectsFactory anotherValidUser 
						using: testObjectsFactory anotherValidPassword .
	
	self addValidProductTo: maradonaCartId. .

	self assert: ( interface listCart: maradonaCartId ) equals: { testObjectsFactory itemSellByTheStore } asBag.
	self assert: ( ( interface listCart: fortCartId ) isEmpty ).

	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - cart management' stamp: 'AM 12/2/2020 20:41:10' prior: 50896319!
test07ShouldNotAddToInvalidCartId
	
	self should: [ 	self addValidProductTo: testObjectsFactory invalidCartId ]
		raise: Error - MessageNotUnderstood 
		withMessageText: InternalRestInterface invalidCartIdErrorDescription .

	
	
	! !

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 20:41:12'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 20:41:12'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 20:41:12'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 20:41:12'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 20:41:12'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 20:41:12'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 20:41:12'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 20:41:12'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 20:41:12'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 20:41:12'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 20:41:12'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 20:41:12'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 20:41:12'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 20:41:12'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 20:41:12'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 20:41:12'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 20:41:12'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 20:41:12'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 20:41:12'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 20:41:12'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 20:41:12'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 20:41:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 20:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 20:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 20:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 20:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 20:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 20:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 20:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 20:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 20:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 20:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 20:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 20:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 20:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 20:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 20:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListATimedOutCart stamp: 'AM 12/2/2020 20:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 20:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 20:41:13'!
ERROR!

!testRun: #InternalRestInterfaceTest #test21DifferentCheckoutsShouldCreateDifferentTransactionIds stamp: 'AM 12/2/2020 20:41:13'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 20:41:13'!
ERROR!
!InternalRestInterfaceTest methodsFor: 'tests - cart timed out' stamp: 'AM 12/2/2020 20:41:48' prior: 50897196!
test20TimeOutTimeIsResetAfterAnyOperation
	
	| aCartId |
					
	aCartId := self createValidCart.	
	
	self shouldnt: [ clockSimulator addToTime: 29*minute.
				interface listCart: aCartId .
				clockSimulator addToTime: 29*minute.
				self addValidProductTo: aCartId .
				clockSimulator addToTime: 29*minute.
				[ self invalidCheckout: aCartId ] 
					on: Error 
					do: [:anError | ].
				clockSimulator addToTime: 29*minute.
				interface listCart: aCartId ]
		raise: Error
		description: InternalRestInterface cartHasTimedOutErrorDescription.
		
	! !

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 20:41:50'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 20:41:50'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 20:41:50'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 20:41:50'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 20:41:50'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 20:41:50'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 20:41:50'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 20:41:50'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 20:41:50'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 20:41:50'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 20:41:50'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 20:41:50'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:41:50'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:41:50'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 20:41:50'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 20:41:50'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 20:41:50'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 20:41:50'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListATimedOutCart stamp: 'AM 12/2/2020 20:41:50'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 20:41:50'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 20:41:50'!
PASSED!

!testRun: #InternalRestInterfaceTest #test21DifferentCheckoutsShouldCreateDifferentTransactionIds stamp: 'AM 12/2/2020 20:41:50'!
PASSED!
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:43:02' prior: 50897082!
test13ListMoreThanOnePurchaseSuccessfully
	
	| aCartId purchases |
	
	2 timesRepeat: [ 
		aCartId := self createValidCart.
		self addValidProductTo: aCartId .
		self validCheckout: aCartId ].
	
	purchases := interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword .
	
	self assert: testObjectsFactory itemSellByTheStorePrice * 2 equals: purchases total.
	self assert: purchases products equals: { testObjectsFactory itemSellByTheStore. testObjectsFactory itemSellByTheStore } asBag.
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:43:10'!
listPurchasesfValidUser

	^ interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword! !
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:43:10' prior: 50897578!
test13ListMoreThanOnePurchaseSuccessfully
	
	| aCartId purchases |
	
	2 timesRepeat: [ 
		aCartId := self createValidCart.
		self addValidProductTo: aCartId .
		self validCheckout: aCartId ].
	
	purchases := self listPurchasesfValidUser .
	
	self assert: testObjectsFactory itemSellByTheStorePrice * 2 equals: purchases total.
	self assert: purchases products equals: { testObjectsFactory itemSellByTheStore. testObjectsFactory itemSellByTheStore } asBag.
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:43:22'!
listPurchasesfValidClient

	^ interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:43:22' prior: 50897606!
test13ListMoreThanOnePurchaseSuccessfully
	
	| aCartId purchases |
	
	2 timesRepeat: [ 
		aCartId := self createValidCart.
		self addValidProductTo: aCartId .
		self validCheckout: aCartId ].
	
	purchases := self listPurchasesfValidClient .
	
	self assert: testObjectsFactory itemSellByTheStorePrice * 2 equals: purchases total.
	self assert: purchases products equals: { testObjectsFactory itemSellByTheStore. testObjectsFactory itemSellByTheStore } asBag.
	
	! !

!methodRemoval: InternalRestInterfaceTest #listPurchasesfValidUser stamp: 'AM 12/2/2020 20:43:23'!
listPurchasesfValidUser

	^ interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword!
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:43:58'!
listPurchasesOfValidClient

	^ interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:43:58' prior: 50897632!
test13ListMoreThanOnePurchaseSuccessfully
	
	| aCartId purchases |
	
	2 timesRepeat: [ 
		aCartId := self createValidCart.
		self addValidProductTo: aCartId .
		self validCheckout: aCartId ].
	
	purchases := self listPurchasesOfValidClient .
	
	self assert: testObjectsFactory itemSellByTheStorePrice * 2 equals: purchases total.
	self assert: purchases products equals: { testObjectsFactory itemSellByTheStore. testObjectsFactory itemSellByTheStore } asBag.
	
	! !

!methodRemoval: InternalRestInterfaceTest #listPurchasesfValidClient stamp: 'AM 12/2/2020 20:43:58'!
listPurchasesfValidClient

	^ interface listPurchasesOf: testObjectsFactory validUser password: testObjectsFactory validPassword!
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:44:14' prior: 50896561!
test11ListZeroPurchasesSuccesfully
	
	| purchases |
	
	purchases := self listPurchasesOfValidClient.
	
	self assert: purchases total equals: 0.
	self assert: purchases products isEmpty.
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:44:31' prior: 50897103!
test12ListOnePurchaseSuccessfully
	
	| aCartId purchases |
	
	aCartId := self createValidCart.
	self addValidProductTo: aCartId .
	self validCheckout: aCartId .
			
	purchases := self listPurchasesOfValidClient.
	
	self assert: purchases total equals: testObjectsFactory itemSellByTheStorePrice .
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag.
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:44:47' prior: 50897057!
test14ListPurchasesFromMoreThanOneUser
	
	| aCartId purchases |
	
	aCartId := self createValidCart.
	
	self addValidProductTo: aCartId .
	self validCheckout: aCartId .
	
	aCartId := interface createCartFor: testObjectsFactory anotherValidUser 
					using: testObjectsFactory anotherValidPassword .
	self addValidProductTo: aCartId .

	self validCheckout: aCartId .
	
	purchases := self listPurchasesOfValidClient.
	
	self assert: testObjectsFactory itemSellByTheStorePrice equals: purchases total.
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:44:53'!
test14ListPurchasesFromMoreThanOneClient
	
	| aCartId purchases |
	
	aCartId := self createValidCart.
	
	self addValidProductTo: aCartId .
	self validCheckout: aCartId .
	
	aCartId := interface createCartFor: testObjectsFactory anotherValidUser 
					using: testObjectsFactory anotherValidPassword .
	self addValidProductTo: aCartId .

	self validCheckout: aCartId .
	
	purchases := self listPurchasesOfValidClient.
	
	self assert: testObjectsFactory itemSellByTheStorePrice equals: purchases total.
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag
	
	! !

!methodRemoval: InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneUser stamp: 'AM 12/2/2020 20:44:53'!
test14ListPurchasesFromMoreThanOneUser
	
	| aCartId purchases |
	
	aCartId := self createValidCart.
	
	self addValidProductTo: aCartId .
	self validCheckout: aCartId .
	
	aCartId := interface createCartFor: testObjectsFactory anotherValidUser 
					using: testObjectsFactory anotherValidPassword .
	self addValidProductTo: aCartId .

	self validCheckout: aCartId .
	
	purchases := self listPurchasesOfValidClient.
	
	self assert: testObjectsFactory itemSellByTheStorePrice equals: purchases total.
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag
	
	!
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:46:15' prior: 50897739!
test14ListPurchasesFromMoreThanOneClient
	
	| aCartId purchases |
	
	aCartId := self createValidCart.
	
	self addValidProductTo: aCartId .
	self validCheckout: aCartId .
	
	aCartId := interface createCartFor: testObjectsFactory anotherValidUser 
					using: testObjectsFactory anotherValidPassword .
	self addValidProductTo: aCartId .
	self validCheckout: aCartId .
	
	purchases := self listPurchasesOfValidClient.
	
	self assert: testObjectsFactory itemSellByTheStorePrice equals: purchases total.
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag.
	
	purchases := interface listPurchasesOf: testObjectsFactory anotherValidUser password: testObjectsFactory anotherValidPassword.
	
	self assert: purchases isEmpty.
	
	
	
	! !

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneClient stamp: 'AM 12/2/2020 20:46:20'!
ERROR!
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:46:47' prior: 50897784!
test14ListPurchasesFromMoreThanOneClient
	
	| aCartId purchases |
	
	aCartId := self createValidCart.
	
	self addValidProductTo: aCartId .
	self validCheckout: aCartId .
	
	aCartId := interface createCartFor: testObjectsFactory anotherValidUser 
					using: testObjectsFactory anotherValidPassword .
	self addValidProductTo: aCartId .
	self validCheckout: aCartId .
	
	purchases := self listPurchasesOfValidClient.
	
	self assert: testObjectsFactory itemSellByTheStorePrice equals: purchases total.
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag.
	
	purchases := interface listPurchasesOf: testObjectsFactory anotherValidUser password: testObjectsFactory anotherValidPassword.
	
	self assert: purchases total equals: 0.
	self assert: purchases products isEmpty.
	
	
	
	! !

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneClient stamp: 'AM 12/2/2020 20:46:49'!
FAILURE!
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:47:10' prior: 50897816!
test14ListPurchasesFromMoreThanOneClient
	
	| aCartId purchases |
	
	aCartId := self createValidCart.
	
	self addValidProductTo: aCartId .
	self addValidProductTo: aCartId .
	self validCheckout: aCartId .
	
	aCartId := interface createCartFor: testObjectsFactory anotherValidUser 
					using: testObjectsFactory anotherValidPassword .
	self addValidProductTo: aCartId .
	self validCheckout: aCartId .
	
	purchases := self listPurchasesOfValidClient.
	
	self assert: testObjectsFactory itemSellByTheStorePrice equals: purchases total.
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore } asBag.
	
	purchases := interface listPurchasesOf: testObjectsFactory anotherValidUser password: testObjectsFactory anotherValidPassword.
	
	self assert: purchases total equals: 0.
	self assert: purchases products isEmpty.
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:48:53' prior: 50897849!
test14ListPurchasesFromMoreThanOneClient
	
	| aCartId purchases |
	
	aCartId := self createValidCart.
	
	self addValidProductTo: aCartId .
	self addValidProductTo: aCartId .
	self validCheckout: aCartId .
	
	aCartId := interface createCartFor: testObjectsFactory anotherValidUser 
					using: testObjectsFactory anotherValidPassword .
	self addValidProductTo: aCartId .
	self validCheckout: aCartId .
	
	purchases := self listPurchasesOfValidClient.
	
	self assert: testObjectsFactory itemSellByTheStorePrice * 2 equals: purchases total.
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore. testObjectsFactory itemSellByTheStore } asBag.
	
	purchases := interface listPurchasesOf: testObjectsFactory anotherValidUser password: testObjectsFactory anotherValidPassword.
	
	self assert: purchases total equals: testObjectsFactory itemSellByTheStorePrice.
	self assert: purchases products equals: { testObjectsFactory itemSellByTheStore }.
	
	
	
	! !

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneClient stamp: 'AM 12/2/2020 20:48:55'!
FAILURE!
!InternalRestInterfaceTest methodsFor: 'tests - list purchases' stamp: 'AM 12/2/2020 20:49:03' prior: 50897880!
test14ListPurchasesFromMoreThanOneClient
	
	| aCartId purchases |
	
	aCartId := self createValidCart.
	
	self addValidProductTo: aCartId .
	self addValidProductTo: aCartId .
	self validCheckout: aCartId .
	
	aCartId := interface createCartFor: testObjectsFactory anotherValidUser 
					using: testObjectsFactory anotherValidPassword .
	self addValidProductTo: aCartId .
	self validCheckout: aCartId .
	
	purchases := self listPurchasesOfValidClient.
	
	self assert: testObjectsFactory itemSellByTheStorePrice * 2 equals: purchases total.
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore. testObjectsFactory itemSellByTheStore } asBag.
	
	purchases := interface listPurchasesOf: testObjectsFactory anotherValidUser password: testObjectsFactory anotherValidPassword.
	
	self assert: purchases total equals: testObjectsFactory itemSellByTheStorePrice.
	self assert: purchases products equals: { testObjectsFactory itemSellByTheStore } asBag.
	
	
	
	! !

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneClient stamp: 'AM 12/2/2020 20:49:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 20:49:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 20:49:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 20:49:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 20:49:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 20:49:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 20:49:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 20:49:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 20:49:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 20:49:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 20:49:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 20:49:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:49:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:49:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneClient stamp: 'AM 12/2/2020 20:49:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 20:49:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 20:49:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 20:49:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListATimedOutCart stamp: 'AM 12/2/2020 20:49:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 20:49:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 20:49:05'!
PASSED!

!testRun: #InternalRestInterfaceTest #test21DifferentCheckoutsShouldCreateDifferentTransactionIds stamp: 'AM 12/2/2020 20:49:05'!
PASSED!
!StoreTestObjectsFactory methodsFor: 'authentication system' stamp: 'AM 12/2/2020 20:50:32'!
anotherValidClient
	
	^ 'RickyFort'! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:50:32' prior: 50897289!
test05AddingToCartSuccessfullyAddsToManyCarts
	
	| fortCartId maradonaCartId |
	
	maradonaCartId := self createValidCart.
	fortCartId := interface createCartFor: testObjectsFactory anotherValidClient 
						using: testObjectsFactory anotherValidPassword .
	
	self addValidProductTo: maradonaCartId. .

	self assert: ( interface listCart: maradonaCartId ) equals: { testObjectsFactory itemSellByTheStore } asBag.
	self assert: ( ( interface listCart: fortCartId ) isEmpty ).

	
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:50:32' prior: 50897918!
test14ListPurchasesFromMoreThanOneClient
	
	| aCartId purchases |
	
	aCartId := self createValidCart.
	
	self addValidProductTo: aCartId .
	self addValidProductTo: aCartId .
	self validCheckout: aCartId .
	
	aCartId := interface createCartFor: testObjectsFactory anotherValidClient 
					using: testObjectsFactory anotherValidPassword .
	self addValidProductTo: aCartId .
	self validCheckout: aCartId .
	
	purchases := self listPurchasesOfValidClient.
	
	self assert: testObjectsFactory itemSellByTheStorePrice * 2 equals: purchases total.
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore. testObjectsFactory itemSellByTheStore } asBag.
	
	purchases := interface listPurchasesOf: testObjectsFactory anotherValidClient password: testObjectsFactory anotherValidPassword.
	
	self assert: purchases total equals: testObjectsFactory itemSellByTheStorePrice.
	self assert: purchases products equals: { testObjectsFactory itemSellByTheStore } asBag.
	
	
	
	! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:50:32' prior: 50888483!
authenticationSystem
	
	| credentials |
	
	credentials := Dictionary new.
	credentials add: self validUser -> self validPassword.
	credentials add: self anotherValidClient -> self anotherValidPassword.
	
	^ AuthenticationSystemSimulator withCredentials: credentials.! !

!methodRemoval: StoreTestObjectsFactory #anotherValidUser stamp: 'AM 12/2/2020 20:50:32'!
anotherValidUser
	
	^ 'RickyFort'!
!StoreTestObjectsFactory methodsFor: 'authentication system' stamp: 'AM 12/2/2020 20:50:42'!
anotherValidClientId
	
	^ 'RickyFort'! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:50:42' prior: 50898059!
test14ListPurchasesFromMoreThanOneClient
	
	| aCartId purchases |
	
	aCartId := self createValidCart.
	
	self addValidProductTo: aCartId .
	self addValidProductTo: aCartId .
	self validCheckout: aCartId .
	
	aCartId := interface createCartFor: testObjectsFactory anotherValidClientId 
					using: testObjectsFactory anotherValidPassword .
	self addValidProductTo: aCartId .
	self validCheckout: aCartId .
	
	purchases := self listPurchasesOfValidClient.
	
	self assert: testObjectsFactory itemSellByTheStorePrice * 2 equals: purchases total.
	self assert: purchases products equals: {testObjectsFactory itemSellByTheStore. testObjectsFactory itemSellByTheStore } asBag.
	
	purchases := interface listPurchasesOf: testObjectsFactory anotherValidClientId password: testObjectsFactory anotherValidPassword.
	
	self assert: purchases total equals: testObjectsFactory itemSellByTheStorePrice.
	self assert: purchases products equals: { testObjectsFactory itemSellByTheStore } asBag.
	
	
	
	! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:50:42' prior: 50898094!
authenticationSystem
	
	| credentials |
	
	credentials := Dictionary new.
	credentials add: self validUser -> self validPassword.
	credentials add: self anotherValidClientId -> self anotherValidPassword.
	
	^ AuthenticationSystemSimulator withCredentials: credentials.! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:50:42' prior: 50898040!
test05AddingToCartSuccessfullyAddsToManyCarts
	
	| fortCartId maradonaCartId |
	
	maradonaCartId := self createValidCart.
	fortCartId := interface createCartFor: testObjectsFactory anotherValidClientId 
						using: testObjectsFactory anotherValidPassword .
	
	self addValidProductTo: maradonaCartId. .

	self assert: ( interface listCart: maradonaCartId ) equals: { testObjectsFactory itemSellByTheStore } asBag.
	self assert: ( ( interface listCart: fortCartId ) isEmpty ).

	
	
	! !

!methodRemoval: StoreTestObjectsFactory #anotherValidClient stamp: 'AM 12/2/2020 20:50:42'!
anotherValidClient
	
	^ 'RickyFort'!
!StoreTestObjectsFactory methodsFor: 'authentication system' stamp: 'AM 12/2/2020 20:50:53'!
invalidClientId
	
	^ 'CristianU' ! !

!methodRemoval: StoreTestObjectsFactory #invalidUser stamp: 'AM 12/2/2020 20:50:53'!
invalidUser
	
	^ 'CristianU' !
!StoreTestObjectsFactory methodsFor: 'authentication system' stamp: 'AM 12/2/2020 20:51:05'!
validClientId
	
	^ 'Maradona' ! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:51:05' prior: 50898150!
authenticationSystem
	
	| credentials |
	
	credentials := Dictionary new.
	credentials add: self validClientId -> self validPassword.
	credentials add: self anotherValidClientId -> self anotherValidPassword.
	
	^ AuthenticationSystemSimulator withCredentials: credentials.! !

!methodRemoval: StoreTestObjectsFactory #validUser stamp: 'AM 12/2/2020 20:51:05'!
validUser
	
	^ 'Maradona' !
!StoreTestObjectsFactory methodsFor: 'tus libros interface' stamp: 'AM 12/2/2020 20:51:42'!
defaultTusLibrosInterface
	
	^ InternalRestInterface with: self authenticationSystem 
					catalog: self defaultCatalog 
					through: self
					clock: self clockSimulator.
! !

!methodRemoval: StoreTestObjectsFactory #tusLibrosInterface stamp: 'AM 12/2/2020 20:51:42'!
tusLibrosInterface
	
	^ InternalRestInterface with: self authenticationSystem 
					catalog: self defaultCatalog 
					through: self
					clock: self clockSimulator.
!

!methodRemoval: StoreTestObjectsFactory #defaultTusLibrosInterface stamp: 'AM 12/2/2020 20:51:47'!
defaultTusLibrosInterface
	
	^ InternalRestInterface with: self authenticationSystem 
					catalog: self defaultCatalog 
					through: self
					clock: self clockSimulator.
!
!StoreTestObjectsFactory methodsFor: 'authentication system' stamp: 'AM 12/2/2020 20:52:20'!
defaultAuthenticationSystem
	
	| credentials |
	
	credentials := Dictionary new.
	credentials add: self validClientId -> self validPassword.
	credentials add: self anotherValidClientId -> self anotherValidPassword.
	
	^ AuthenticationSystemSimulator withCredentials: credentials.! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:52:20' prior: 50895663!
tusLibrosInterfaceWithClock: aClockSimulator
	
	^ InternalRestInterface with: self defaultAuthenticationSystem 
					catalog: self defaultCatalog 
					through: self
					clock: aClockSimulator
! !

!methodRemoval: StoreTestObjectsFactory #authenticationSystem stamp: 'AM 12/2/2020 20:52:21'!
authenticationSystem
	
	| credentials |
	
	credentials := Dictionary new.
	credentials add: self validClientId -> self validPassword.
	credentials add: self anotherValidClientId -> self anotherValidPassword.
	
	^ AuthenticationSystemSimulator withCredentials: credentials.!
!StoreTestObjectsFactory methodsFor: 'authentication system' stamp: 'AM 12/2/2020 20:52:35' prior: 50898239!
defaultAuthenticationSystem
	
	| credentials |
	
	credentials := Dictionary new.
	credentials at: self validClientId put: self validPassword.
	credentials at: self anotherValidClientId put: self anotherValidPassword.
	
	^ AuthenticationSystemSimulator withCredentials: credentials.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 20:52:37'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 20:52:37'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 20:52:37'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 20:52:37'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 20:52:37'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 20:52:37'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 20:52:37'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 20:52:37'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 20:52:37'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 20:52:37'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 20:52:37'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 20:52:37'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 20:52:37'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 20:52:37'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 20:52:37'!
ERROR!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 20:52:37'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 20:52:37'!
ERROR!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 20:52:37'!
ERROR!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 20:52:37'!
ERROR!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 20:52:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 20:52:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 20:52:38'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 20:52:38'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 20:52:38'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 20:52:38'!
ERROR!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:52:38'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:52:38'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneClient stamp: 'AM 12/2/2020 20:52:38'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 20:52:38'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 20:52:38'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 20:52:38'!
ERROR!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListATimedOutCart stamp: 'AM 12/2/2020 20:52:38'!
ERROR!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 20:52:38'!
ERROR!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 20:52:38'!
ERROR!

!testRun: #InternalRestInterfaceTest #test21DifferentCheckoutsShouldCreateDifferentTransactionIds stamp: 'AM 12/2/2020 20:52:38'!
ERROR!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 20:52:38'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 20:52:38'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 20:52:38'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 20:52:38'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 20:52:38'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 20:52:38'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 20:52:38'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 20:52:41'!
ERROR!
!StoreTestObjectsFactory methodsFor: 'authentication system' stamp: 'AM 12/2/2020 20:52:56'!
invalidUser
	
	^ 'CristianU' ! !

!methodRemoval: StoreTestObjectsFactory #invalidClientId stamp: 'AM 12/2/2020 20:52:56'!
invalidClientId
	
	^ 'CristianU' !
!StoreTestObjectsFactory methodsFor: 'authentication system' stamp: 'AM 12/2/2020 20:53:06'!
invalidClientId
	
	^ 'CristianU' ! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:53:07' prior: 50896342!
test15InvalidUserShouldNotListPurchases

	self should: [ interface listPurchasesOf: testObjectsFactory invalidClientId password: testObjectsFactory validPassword ]
		raise: Error
		withMessageText: AuthenticationSystemSimulator invalidUserErrorDescription .
		
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:53:07' prior: 50896417!
test01UnknownUserShouldNotCreateCart

	self should: [ interface createCartFor: testObjectsFactory invalidClientId using: testObjectsFactory invalidPassword ]
		raise: Error - MessageNotUnderstood
		withMessageText: AuthenticationSystemSimulator invalidUserErrorDescription.
	
	
	
	! !

!methodRemoval: StoreTestObjectsFactory #invalidUser stamp: 'AM 12/2/2020 20:53:07'!
invalidUser
	
	^ 'CristianU' !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 20:53:12'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 20:53:12'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 20:53:12'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 20:53:12'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 20:53:12'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 20:53:12'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 20:53:12'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 20:53:12'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 20:53:12'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 20:53:12'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 20:53:12'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 20:53:12'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 20:53:12'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 20:53:12'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 20:53:12'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 20:53:12'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 20:53:12'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 20:53:12'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 20:53:12'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 20:53:12'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 20:53:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 20:53:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 20:53:12'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 20:53:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 20:53:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 20:53:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 20:53:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 20:53:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 20:53:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 20:53:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 20:53:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 20:53:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:53:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:53:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneClient stamp: 'AM 12/2/2020 20:53:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 20:53:12'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 20:53:12'!
FAILURE!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 20:53:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListATimedOutCart stamp: 'AM 12/2/2020 20:53:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 20:53:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 20:53:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test21DifferentCheckoutsShouldCreateDifferentTransactionIds stamp: 'AM 12/2/2020 20:53:12'!
ERROR!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 20:53:16'!
ERROR!
!StoreTestObjectsFactory methodsFor: 'authentication system' stamp: 'AM 12/2/2020 20:53:33'!
validUser
	
	^ 'Maradona' ! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:53:33' prior: 50898274!
defaultAuthenticationSystem
	
	| credentials |
	
	credentials := Dictionary new.
	credentials at: self validUser put: self validPassword.
	credentials at: self anotherValidClientId put: self anotherValidPassword.
	
	^ AuthenticationSystemSimulator withCredentials: credentials.! !

!methodRemoval: StoreTestObjectsFactory #validClientId stamp: 'AM 12/2/2020 20:53:34'!
validClientId
	
	^ 'Maradona' !
!StoreTestObjectsFactory methodsFor: 'authentication system' stamp: 'AM 12/2/2020 20:53:45'!
validClientId
	
	^ 'Maradona' ! !
!StoreTestObjectsFactory methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:53:45' prior: 50898633!
defaultAuthenticationSystem
	
	| credentials |
	
	credentials := Dictionary new.
	credentials at: self validClientId put: self validPassword.
	credentials at: self anotherValidClientId put: self anotherValidPassword.
	
	^ AuthenticationSystemSimulator withCredentials: credentials.! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:53:45' prior: 50896281!
test16InvalidPasswordShouldNotListPurchases
	
	self should: [ interface listPurchasesOf: testObjectsFactory validClientId password: testObjectsFactory invalidPassword ]
		raise: Error
		withMessageText: AuthenticationSystemSimulator invalidPasswordErrorDescription .
		
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:53:45' prior: 50897657!
listPurchasesOfValidClient

	^ interface listPurchasesOf: testObjectsFactory validClientId password: testObjectsFactory validPassword! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:53:45' prior: 50896573!
test02WrongPasswordShouldNotCreateCart
	
	self should: [ interface createCartFor: testObjectsFactory validClientId using: testObjectsFactory invalidPassword ]
		raise: Error
		withMessageText: AuthenticationSystemSimulator invalidPasswordErrorDescription.
	
	
	
	! !
!InternalRestInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AM 12/2/2020 20:53:45' prior: 50896608!
createValidCart

	^ interface createCartFor: testObjectsFactory validClientId 
						using: testObjectsFactory validPassword! !

!methodRemoval: StoreTestObjectsFactory #validUser stamp: 'AM 12/2/2020 20:53:45'!
validUser
	
	^ 'Maradona' !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneClient stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListATimedOutCart stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

!testRun: #InternalRestInterfaceTest #test21DifferentCheckoutsShouldCreateDifferentTransactionIds stamp: 'AM 12/2/2020 20:53:49'!
PASSED!

----SNAPSHOT----(2 December 2020 20:54:28) CuisUniversity-4384.image priorSource: 17823693!

----QUIT----(2 December 2020 20:54:34) CuisUniversity-4384.image priorSource: 18150582!

----STARTUP---- (3 December 2020 14:29:51) as /home/agustin/Escritorio/Uba/Materias/Compu/ISW1/TusLibros/CuisUniversity-4384.image!


!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 'AM 12/3/2020 14:30:33'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticationSystem catalog carts merchantProcessor salesBooks clock nextCartId'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 12/3/2020 14:30:32' prior: 50893425!
nextCartId
	
	^ nextCartId := nextCartId + 1
	! !

!classDefinition: #InternalRestInterface category: 'TusLibros' stamp: 'AM 12/3/2020 14:30:51'!
Object subclass: #InternalRestInterface
	instanceVariableNames: 'authenticationSystem catalog carts merchantProcessor salesBooks clock nextCartId nextTransactionId'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!InternalRestInterface methodsFor: 'cart management - private' stamp: 'AM 12/3/2020 14:30:50' prior: 50893590!
nextTransactionId
	
	^ nextTransactionId := nextTransactionId + 1! !
!InternalRestInterface methodsFor: 'initialization' stamp: 'AM 12/3/2020 14:31:10' prior: 50893577!
initializeWith: anAuthenticationSystem catalog: aCatalog through: aMerchantProcessor clock: aClock 
	
	authenticationSystem := anAuthenticationSystem.
	catalog := aCatalog.
	merchantProcessor := aMerchantProcessor.
	clock := aClock.
	
	nextTransactionId := 0.
	nextCartId := 0.
	
	carts := Dictionary new.
	
	salesBooks := Dictionary new.! !
!CreditCard class methodsFor: 'instance creation' stamp: 'AM 12/3/2020 14:37:42'!
assertThatCreditCardNumberIsValid: aNumber
	
	((aNumber between: 10^15 and: 10^16-1) and: [aNumber isInteger] )ifFalse: [ self error: self invalidCardNumberErrorDescription ].! !
!CreditCard class methodsFor: 'instance creation' stamp: 'AM 12/3/2020 14:37:55' prior: 50885974!
withNumber: aNumber expiringOn: aMonthOfYear owner: aName  
	
	self assertThatCreditCardNumberIsValid: aNumber.
	( aMonthOfYear isKindOf: GregorianMonthOfYear ) ifFalse: [ self error: self invalidExpirationDateErrorDescription ] .
	aName withoutTrailingBlanks isEmpty ifTrue: [ self error: self invalidOwnerNameErrorDescription ] .
	
	
	^ self new initializeWithNumber: aNumber expiringOn: aMonthOfYear owner: aName ! !
!CreditCard class methodsFor: 'instance creation' stamp: 'AM 12/3/2020 14:38:34'!
assertThatExpirationDateIsValid: aDate

	( aDate isKindOf: GregorianMonthOfYear ) ifFalse: [ self error: self invalidExpirationDateErrorDescription ] .! !
!CreditCard class methodsFor: 'instance creation' stamp: 'AM 12/3/2020 14:38:54' prior: 50898922!
withNumber: aNumber expiringOn: aMonthOfYear owner: aName  
	
	self assertThatCreditCardNumberIsValid: aNumber.
	self assertThatExpirationDateIsValid: aMonthOfYear.
	aName withoutTrailingBlanks isEmpty ifTrue: [ self error: self invalidOwnerNameErrorDescription ] .
	
	
	^ self new initializeWithNumber: aNumber expiringOn: aMonthOfYear owner: aName ! !
!CreditCard class methodsFor: 'instance creation' stamp: 'AM 12/3/2020 14:39:10'!
assertThatNameIsValid: aName

	^ aName withoutTrailingBlanks isEmpty ifTrue: [ self error: self invalidOwnerNameErrorDescription ]! !
!CreditCard class methodsFor: 'instance creation' stamp: 'AM 12/3/2020 14:39:11' prior: 50898946!
withNumber: aNumber expiringOn: aMonthOfYear owner: aName  
	
	self assertThatCreditCardNumberIsValid: aNumber.
	self assertThatExpirationDateIsValid: aMonthOfYear.
	self assertThatNameIsValid: aName .
	
	
	^ self new initializeWithNumber: aNumber expiringOn: aMonthOfYear owner: aName ! !
!CreditCard class methodsFor: 'instance creation' stamp: 'AM 12/3/2020 14:39:14' prior: 50898968!
withNumber: aNumber expiringOn: aMonthOfYear owner: aName  
	
	self assertThatCreditCardNumberIsValid: aNumber.
	self assertThatExpirationDateIsValid: aMonthOfYear.
	self assertThatNameIsValid: aName .
	
	^ self new initializeWithNumber: aNumber expiringOn: aMonthOfYear owner: aName ! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #CreditCardTest #test01CardNumberShouldNotHaveLessThan16Digits stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #CreditCardTest #test02CardNumberShouldNotHaveMoreThan16Digits stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #CreditCardTest #test03CardNumberShouldBeAnInteger stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #CreditCardTest #test04CardExpirationDateShouldBeAMonthOfAnYear stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #CreditCardTest #test05OwnerNameShouldNotBeEmpty stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #CreditCardTest #test06OwnerNameShouldNotBeBlank stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #CreditCardTest #test07ValidCardPropertiesAreCorrect stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test01UnknownUserShouldNotCreateCart stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test02WrongPasswordShouldNotCreateCart stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test03NewCartShouldBeEmpty stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test04AddingToCartSuccessfullyAddsToOneCart stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test05AddingToCartSuccessfullyAddsToManyCarts stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test06ListingCartShouldNotListOnInvalidCartId stamp: 'AM 12/3/2020 14:40:08'!
PASSED!

!testRun: #InternalRestInterfaceTest #test07ShouldNotAddToInvalidCartId stamp: 'AM 12/3/2020 14:40:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test08CheckOutSuccessfullyChecksOutOneCart stamp: 'AM 12/3/2020 14:40:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test09ShouldNotCheckOutAnAlreadyCheckedOutCart stamp: 'AM 12/3/2020 14:40:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test10FailedCheckOutShouldNotInvalidateFutureCheckOut stamp: 'AM 12/3/2020 14:40:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test11ListZeroPurchasesSuccesfully stamp: 'AM 12/3/2020 14:40:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test12ListOnePurchaseSuccessfully stamp: 'AM 12/3/2020 14:40:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test13ListMoreThanOnePurchaseSuccessfully stamp: 'AM 12/3/2020 14:40:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test14ListPurchasesFromMoreThanOneClient stamp: 'AM 12/3/2020 14:40:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test15InvalidUserShouldNotListPurchases stamp: 'AM 12/3/2020 14:40:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test16InvalidPasswordShouldNotListPurchases stamp: 'AM 12/3/2020 14:40:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test17ShouldNotAddWhenCartTimedOut stamp: 'AM 12/3/2020 14:40:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test18ShouldNotListATimedOutCart stamp: 'AM 12/3/2020 14:40:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test19ShouldNotCheckOutATimedOutCart stamp: 'AM 12/3/2020 14:40:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test20TimeOutTimeIsResetAfterAnyOperation stamp: 'AM 12/3/2020 14:40:09'!
PASSED!

!testRun: #InternalRestInterfaceTest #test21DifferentCheckoutsShouldCreateDifferentTransactionIds stamp: 'AM 12/3/2020 14:40:09'!
PASSED!